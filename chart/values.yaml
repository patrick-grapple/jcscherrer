# Default values for myapp.

dblocal:
  enabled: true
externalsecrets:
  enabled: true
customersync:
  enabled: true
bexio:
  enabled: true
env:
  - name: SVELTE_APP_USERNAME
    # value: admin
    valueFrom:
      secretKeyRef:
        name: jcs-admin-secret
        key: SVELTE_APP_USERNAME
  - name: SVELTE_APP_PASSWORD
    # value: password
    valueFrom:
      secretKeyRef:
        name: jcs-admin-secret
        key: SVELTE_APP_PASSWORD
# configuration for grapple ApplicationSet (gras)
gras-deploy:
  enabled: false
gras:
  enabled: true
  gras: {}
  # ssl: false
  grapi:
    beimagetag: "0.2.9"
    automigrate: false
    autorestartgruim: true
    autoscaling:
      minReplicas: 3
    discoveredrepos: true
    ingress: true
    ssl: true
    sslissuer: letsencrypt-grapple-demo
    extraSecrets:
      - jcs-conn-credential
      - jcs-bexio
    # externalsecrets:
    #   - name: "jcs-bexio"
    #     spec:
    #       refreshInterval: "1h"
    #       secretStoreRef:
    #         name: aws-secret-store-jcs
    #         kind: ClusterSecretStore
    #       target:
    #         name: jcs-bexio
    #         creationPolicy: Owner
    #         deletionPolicy: Retain
    #       dataFrom:
    #         - extract:
    #             key: grapple/jcscherrer/bexio
    initContainers:
      - name: wait-for-db
        spec:
          name: wait-for-db
          image: grpl/jcscherrer-data:data
          command:
            - bash
            - -c
            - |
              sleep 5;
              while ! mysql -h $(host) -P $(port) -u $(username) -p$(password) -e "show databases;" 2>/dev/null; do
                echo -n .;
                sleep 2;
              done;
              if mysql -h $(host) -P $(port) -u $(username) -p$(password) -e "USE jcscherrer; SET @tablename := (select table_name from information_schema.tables where table_type = 'BASE TABLE' and table_schema = 'jcscherrer' limit 1); set @qry1:= concat('select * from ',@tablename,' limit 1'); prepare stmt from @qry1 ; execute stmt ;" ; then
                echo "database already exists..."
              else
                echo "wait for database"
                while ! mysql -h $(host) -P $(port) -u $(username) -p$(password) -e "USE jcscherrer; SET @tablename := (select table_name from information_schema.tables where table_type = 'BASE TABLE' and table_schema = 'jcscherrer' limit 1); set @qry1:= concat('select * from ',@tablename,' limit 1'); prepare stmt from @qry1 ; execute stmt ;"; do
                  echo -n .;
                  sleep 2;
                done;
              fi
      - name: update-db-202501
        spec:
          name: update-db-202501
          image: mysql
          command:
            - bash
            - -c
            - |
              sleep 5;
              while ! mysql -h $(host) -P $(port) -u $(username) -p$(password) -e "show databases;" 2>/dev/null; do
                echo -n .;
                sleep 2;
              done;
              echo "db available now..."
              if ! mysql -h ${host} -P ${port} -u ${username} -p${password} -e "use jcscherrer; SHOW COLUMNS FROM Rapport LIKE 'kundeIds'; " | grep -i kunde; then
                echo "run the upgrade..."
                mysql -h ${host} -P ${port} -u ${username} -p${password} -e 'use jcscherrer; ALTER TABLE `Rapport` ADD COLUMN `kundeIds` varchar(255) NULL AFTER `kundeId`; SET SQL_SAFE_UPDATES = 0; UPDATE Rapport AS a INNER JOIN Rapport AS b ON a.kundeId = b.kundeId SET a.kundeIds = concat("[",b.kundeId,"]"); SET SQL_SAFE_UPDATES = 1; ALTER TABLE `Rapport` DROP COLUMN `kundeId`; ALTER TABLE `ArchivedRapport` ADD COLUMN `kundeIds` varchar(255) NULL AFTER `kundeId`; SET SQL_SAFE_UPDATES = 0; UPDATE ArchivedRapport AS a INNER JOIN ArchivedRapport AS b ON a.kundeId = b.kundeId SET a.kundeIds = concat("[",b.kundeId,"]"); SET SQL_SAFE_UPDATES = 1; ALTER TABLE `ArchivedRapport` DROP COLUMN `kundeId`;'
              else
                echo "update-db-202501 already patched"
              fi
      - name: jcscherrer
        spec:
          mysql:
            database: jcscherrer
            host: $(host)
            name: jcscherrer
            password: $(password)
            port: $(port)
            url: ""
            user: $(username)
    discoveries:
      - name: jcscherrer
        spec:
          all: true
          dataSource: jcscherrer
          disableCamelCase: false
          schema: jcscherrer
    relations:
      - name: trainer
        spec:
          destinationModel: Trainer
          foreignKeyName: trainerId
          registerInclusionResolver: true
          relationName: trainer
          relationType: belongsTo
          sourceModel: Rapport
      - name: platz
        spec:
          destinationModel: Platz
          foreignKeyName: platzId
          registerInclusionResolver: true
          relationName: platz
          relationType: belongsTo
          sourceModel: Rapport
      - name: kunde
        content: '{"sourceModel": "Rapport","destinationModel": "Kunde","relationType": "referencesMany","keyFrom": "kundeIds","keyTo": "id","registerInclusionResolver": true}'
        # spec:
        #   relationName: kunde
        #   destinationModel: Kunde
        #   sourceModel: Rapport
        #   relationType: referencesMany
        #   keyFrom: kundeIds
        #   keyTo: id
        #   registerInclusionResolver: true
      - name: gruppe
        spec:
          destinationModel: Gruppe
          foreignKeyName: gruppeId
          registerInclusionResolver: true
          relationName: gruppe
          relationType: belongsTo
          sourceModel: Rapport
      - name: invoice
        spec:
          destinationModel: Invoices
          foreignKeyName: rapportId
          registerInclusionResolver: true
          relationName: invoice
          relationType: hasMany
          sourceModel: Rapport
      - name: trainerarchived
        spec:
          destinationModel: Trainer
          foreignKeyName: trainerId
          registerInclusionResolver: true
          relationName: trainerarchived
          relationType: belongsTo
          sourceModel: ArchivedRapport
      - name: platzarchived
        spec:
          destinationModel: Platz
          foreignKeyName: platzId
          registerInclusionResolver: true
          relationName: platzarchived
          relationType: belongsTo
          sourceModel: ArchivedRapport
      - name: kundearchived
        content: '{"sourceModel": "ArchivedRapport","destinationModel": "Kunde","relationType": "referencesMany","keyFrom": "kundeIds","keyTo": "id","registerInclusionResolver": true}'
        # spec:
        #   relationName: kundearchived
        #   destinationModel: Kunde
        #   sourceModel: ArchivedRapport
        #   relationType: referencesMany
        #   keyFrom: kundeIds
        #   keyTo: id
        #   registerInclusionResolver: true
      - name: gruppearchived
        spec:
          destinationModel: Gruppe
          foreignKeyName: gruppeId
          registerInclusionResolver: true
          relationName: gruppearchived
          relationType: belongsTo
          sourceModel: ArchivedRapport
      - name: invoicearchived
        spec:
          destinationModel: Invoices
          foreignKeyName: rapportId
          registerInclusionResolver: true
          relationName: invoicearchived
          relationType: hasMany
          sourceModel: ArchivedRapport
      - name: SummerRateBefore
        spec:
          destinationModel: Product
          foreignKeyName: SummerRateBeforeId
          registerInclusionResolver: true
          relationName: SummerRateBefore
          relationType: belongsTo
          sourceModel: Trainer
      # sadly multiple belongsTo relations still not fixed (waiting on PR to be merged):
      # https://wolke7.atlassian.net/browse/LB4I-52
      # also involves:
      # git mv grapi/postpatches/addAdditionalRelationsToTrainer.sh grapi/postpatches/addAdditionalRelationsToTrainer.disabled
      # git mv grapi/prerelationpatches/addAdditionalRelationsToTrainer.sh grapi/prerelationpatches/addAdditionalRelationsToTrainer.disabled
      # - name: SummerRateAfter
      #   spec:
      #     destinationModel: Product
      #     foreignKeyName: SummerRateAfterId
      #     registerInclusionResolver: true
      #     relationName: SummerRateAfter
      #     relationType: belongsTo
      #     sourceModel: Trainer
      # - name: WinterRateBefore
      #   spec:
      #     destinationModel: Product
      #     foreignKeyName: WinterRateBeforeId
      #     registerInclusionResolver: true
      #     relationName: WinterRateBefore
      #     relationType: belongsTo
      #     sourceModel: Trainer
      # - name: WinterRateAfter
      #   spec:
      #     destinationModel: Product
      #     foreignKeyName: WinterRateAfterId
      #     registerInclusionResolver: true
      #     relationName: WinterRateAfter
      #     relationType: belongsTo
      #     sourceModel: Trainer
      - name: KUNDE
        content: '{"relationName": "KUNDE", "customReferenceKeys":true, "sourceModel": "Kunde","customSourceModelKey":"bexioId","destinationModel":"Kunde","customTargetModelKey":"bexioId","throughModel":"KundeThrough","relationType":"hasManyThrough","sourceKeyOnThrough":"contactId","targetKeyOnThrough":"contactSubId","registerInclusionResolver":true}'
        # spec doesn't work as customReferences (on source and target) are not yet implemented in grapi
        # spec:
        #   relationName: KUNDE
        #   sourceModel: Kunde
        #   destinationModel: "Kunde"
        #   throughModel: "KundeThrough"
        #   relationType: hasManyThrough
        #   sourceKeyOnThrough: "contactId"
        #   targetKeyOnThrough: "contactSubId"
        #   # # customReferences (on source and target) are not yet implemented in grapi
        #   # customReferenceKeys: "true"
        #   # customSourceModelKey: "bexioId"
        #   # customTargetModelKey: "bexioId"
        #   # # sourceModelPrimaryKey: "bexioId"
        #   # # destinationModelPrimaryKey: "bexioId"
        #   registerInclusionResolver: true
      - name: rapport
        spec:
          destinationModel: Rapport
          foreignKeyName: relatedRapportId
          registerInclusionResolver: true
          relationName: rapport
          relationType: belongsTo
          sourceModel: Invoices
    fuzzysearch:
      - name: kunde
        content: 'jcs:{"fuzzy":true,"centralFuzzy":false,"datasource":"jcscherrer","appName":"Grpl","include":"kunde","subPath":""}'
        # spec:
        #   fuzzy: true
        #   centralFuzzy: false
        #   datasource: "jcscherrer"
        #   appName: "Grpl"
        #   # include: "kundes"
    restcruds:
      - name: "jcscherrer"
        spec:
          datasource: "jcscherrer"
    controllers:
      - name: bexio
        content: Ly8gQHRzLW5vY2hlY2sKLy8gVW5jb21tZW50IHRoZXNlIGltcG9ydHMgdG8gYmVnaW4gdXNpbmcgdGhlc2UgY29vbCBmZWF0dXJlcyEKCmltcG9ydCB7IGluamVjdCB9IGZyb20gIkBsb29wYmFjay9jb3JlIjsKaW1wb3J0IHsgcmVwb3NpdG9yeSB9IGZyb20gIkBsb29wYmFjay9yZXBvc2l0b3J5IjsKCmltcG9ydCBkYXlqcyBmcm9tICJkYXlqcyI7CgppbXBvcnQgewogIEh0dHBFcnJvcnMsCiAgcG9zdCwKICBnZXQsCiAgUmVxdWVzdCwKICByZXF1ZXN0Qm9keSwKICBSZXN0QmluZGluZ3MsCiAgcGFyYW0sCn0gZnJvbSAiQGxvb3BiYWNrL3Jlc3QiOwoKY29uc3QgaHR0cHMgPSByZXF1aXJlKCJodHRwcyIpOwoKY29uc3QgYmV4aW9Ub2tlbiA9IHByb2Nlc3MuZW52WyJCRVhJT19UT0tFTiJdIHx8ICIiOwpjb25zdCBiZXhpb1Byb2ZpbGUgPSBwcm9jZXNzLmVudlsiQkVYSU9fUFJPRklMRSJdIHx8ICJkZWZhdWx0IjsKY29uc3QgYmV4aW9VcmwgPSBwcm9jZXNzLmVudlsiQkVYSU9fQVBJX1VSTCJdIHx8ICJodHRwczovL2FwaS5iZXhpby5jb20vMi4wIjsKY29uc3QgYmV4aW9TcGVjID0gewogIHJlc3BvbnNlczogewogICAgIjIwMCI6IHsKICAgICAgZGVzY3JpcHRpb246ICJiZXhpbyBwcm9maWxlIGFuZCBhcGkgdXJsIiwKICAgICAgY29udGVudDogewogICAgICAgICJhcHBsaWNhdGlvbi9qc29uIjogewogICAgICAgICAgc2NoZW1hOiB7IHR5cGU6ICJvYmplY3QiIH0sCiAgICAgICAgfSwKICAgICAgfSwKICAgIH0sCiAgfSwKfTsKYXN5bmMgZnVuY3Rpb24gcG9zdFJlcXVlc3QodXJsLCBkYXRhKSB7CiAgY29uc3QgZGF0YVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwoKICBjb25zdCBvcHRpb25zID0gewogICAgbWV0aG9kOiAiUE9TVCIsCiAgICBoZWFkZXJzOiB7CiAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsCiAgICAgIEFjY2VwdDogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7YmV4aW9Ub2tlbn1gLAogICAgfSwKICAgIHRpbWVvdXQ6IDAsIC8vIGluIG1zCiAgfTsKCiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IHJlcSA9IGh0dHBzLnJlcXVlc3QodXJsLCBvcHRpb25zLCAocmVzKSA9PiB7CiAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSA8IDIwMCB8fCByZXMuc3RhdHVzQ29kZSA+IDI5OSkgewogICAgICAgIHJldHVybiByZWplY3QoeyBzdGF0dXNDb2RlOiByZXMuc3RhdHVzQ29kZSwgbWVzc2FnZTogImVycm9yIiB9KTsKICAgICAgfQoKICAgICAgY29uc3QgYm9keSA9IFtdOwogICAgICByZXMub24oImRhdGEiLCAoY2h1bmspID0+IGJvZHkucHVzaChjaHVuaykpOwogICAgICByZXMub24oImVuZCIsICgpID0+IHsKICAgICAgICBjb25zdCByZXNTdHJpbmcgPSBCdWZmZXIuY29uY2F0KGJvZHkpLnRvU3RyaW5nKCk7CiAgICAgICAgcmVzb2x2ZShyZXNTdHJpbmcpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHJlcS5vbigiZXJyb3IiLCAoZXJyKSA9PiB7CiAgICAgIHJlamVjdChlcnIpOwogICAgfSk7CgogICAgcmVxLm9uKCJ0aW1lb3V0IiwgKCkgPT4gewogICAgICByZXEuZGVzdHJveSgpOwogICAgICByZWplY3QobmV3IEVycm9yKCJSZXF1ZXN0IHRpbWUgb3V0IikpOwogICAgfSk7CgogICAgcmVxLndyaXRlKGRhdGFTdHJpbmcpOwogICAgcmVxLmVuZCgpOwogIH0pOwp9Cgphc3luYyBmdW5jdGlvbiBkZWxldGVSZXF1ZXN0KHVybCkgewogIGNvbnN0IG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICJERUxFVEUiLAogICAgaGVhZGVyczogewogICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICBBY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2JleGlvVG9rZW59YCwKICAgIH0sCiAgICB0aW1lb3V0OiAwLCAvLyBpbiBtcwogIH07CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IHJlcSA9IGh0dHBzLnJlcXVlc3QodXJsLCBvcHRpb25zLCAocmVzKSA9PiB7CiAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSA8IDIwMCB8fCByZXMuc3RhdHVzQ29kZSA+IDI5OSkgewogICAgICAgIHJldHVybiByZWplY3QoeyBzdGF0dXNDb2RlOiByZXMuc3RhdHVzQ29kZSwgbWVzc2FnZTogImVycm9yIiB9KTsKICAgICAgfQoKICAgICAgY29uc3QgYm9keSA9IFtdOwogICAgICByZXMub24oImRhdGEiLCAoY2h1bmspID0+IGJvZHkucHVzaChjaHVuaykpOwogICAgICByZXMub24oImVuZCIsICgpID0+IHsKICAgICAgICBjb25zdCByZXNTdHJpbmcgPSBCdWZmZXIuY29uY2F0KGJvZHkpLnRvU3RyaW5nKCk7CiAgICAgICAgcmVzb2x2ZShyZXNTdHJpbmcpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHJlcS5vbigiZXJyb3IiLCAoZXJyKSA9PiB7CiAgICAgIHJlamVjdChlcnIpOwogICAgfSk7CgogICAgcmVxLm9uKCJ0aW1lb3V0IiwgKCkgPT4gewogICAgICByZXEuZGVzdHJveSgpOwogICAgICByZWplY3QobmV3IEVycm9yKCJSZXF1ZXN0IHRpbWUgb3V0IikpOwogICAgfSk7CgogICAgcmVxLndyaXRlKCIiKTsKICAgIHJlcS5lbmQoKTsKICB9KTsKfQoKZXhwb3J0IGNsYXNzIEJleGlvQ29udHJvbGxlciB7CiAgY29uc3RydWN0b3IoCiAgICBAaW5qZWN0KFJlc3RCaW5kaW5ncy5IdHRwLlJFUVVFU1QpIHByaXZhdGUgcmVxOiBSZXF1ZXN0LAogICAgQHJlcG9zaXRvcnkuZ2V0dGVyKCJJbnZvaWNlR2VuZXJhdGlvbkNvbmZpZ1JlcG9zaXRvcnkiKQogICAgcHJvdGVjdGVkIEludm9pY2VHZW5lcmF0aW9uQ29uZmlnOiAoKSA9PiBQcm9taXNlPGFueT4sCiAgICBAcmVwb3NpdG9yeS5nZXR0ZXIoIlJhcHBvcnRSZXBvc2l0b3J5IikKICAgIHByb3RlY3RlZCBSYXBwb3J0OiAoKSA9PiBQcm9taXNlPGFueT4sCiAgICBAcmVwb3NpdG9yeS5nZXR0ZXIoIlByb2R1Y3RSZXBvc2l0b3J5IikKICAgIHByb3RlY3RlZCBQcm9kdWN0OiAoKSA9PiBQcm9taXNlPGFueT4KICApIHsgfQoKICAvLyBNYXAgdG8gYHBvc3QgL2NyZWF0ZS1iZXhpby1pbnZvaWNlYAogIEBwb3N0KCIvY3JlYXRlLWJleGlvLWludm9pY2UiKQogIC8vIEByZXNwb25zZSgyMDAsIFBJTkdfUkVTUE9OU0UpCiAgYXN5bmMgY3JlYXRlQmV4aW9JbnZvaWNlKAogICAgQHJlcXVlc3RCb2R5KCkgQmV4aW9Cb2R5OiBhbnksCiAgICBAcGFyYW0uaGVhZGVyLnN0cmluZygiY29udGVudC10eXBlIikgY29udGVudFR5cGU6IHN0cmluZwogICk6IFByb21pc2U8b2JqZWN0PiB7CiAgICBjb25zb2xlLmxvZygiUmVxdWVzdCBjYWxsZWQgYXQ6IiwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTsKICAgIGNvbnNvbGUubG9nKCJpbiByZXF1ZXN0Iik7CiAgICBjb25zb2xlLmxvZyh7IGNvbnRlbnRUeXBlIH0pOwogICAgY29uc29sZS5sb2coeyBCZXhpb0JvZHkgfSk7CgogICAgdHlwZSBLdW5kZVR5cGUgPSB7CiAgICAgIGJleGlvSWQ6IHN0cmluZzsKICAgICAgZ2VidXJ0c3RhZzogc3RyaW5nIHwgbnVsbDsKICAgICAgaWQ6IG51bWJlcjsKICAgICAgbGFuZDogc3RyaW5nOwogICAgICBtYWlsOiBzdHJpbmc7CiAgICAgIG1haWwyOiBzdHJpbmc7CiAgICAgIG5hbWU6IHN0cmluZzsKICAgICAgbm90aXplbjogc3RyaW5nOwogICAgICBvcnQ6IHN0cmluZzsKICAgICAgcGhvbmU6IHN0cmluZzsKICAgICAgcGhvbmUyOiBzdHJpbmc7CiAgICAgIHBob25lTW9iaWxlOiBzdHJpbmc7CiAgICAgIHBsejogc3RyaW5nOwogICAgICBzdHJhc3NlOiBzdHJpbmc7CiAgICAgIHZvcm5hbWU6IHN0cmluZzsKICAgIH07CgogICAgdHlwZSBHcnVwcGVUeXBlID0gewogICAgICBpZDogbnVtYmVyOwogICAgICBncnVwcGVudHlwOiBzdHJpbmc7CiAgICAgIGdydXBwZW5uYW1lOiBzdHJpbmc7CiAgICB9OwogICAgdHlwZSBQbGF0elR5cGUgPSB7CiAgICAgIGlkOiBudW1iZXI7CiAgICAgIHRlbm5pc2NvdXJ0OiAiQ2x1YiIgfCAiTm9ybWFsIiB8ICJNaW5pLUNvdXJ0IiB8ICJQb2x5IjsKICAgIH07CgogICAgdHlwZSBUcmFpbmVyVHlwZSA9IHsKICAgICAgU3VtbWVyUmF0ZUJlZm9yZUlkOiBudW1iZXI7CiAgICAgIGFrdGl2OiBib29sZWFuOwogICAgICBlbWFpbDogc3RyaW5nOwogICAgICBpZDogbnVtYmVyOwogICAgICBuYW1lOiBzdHJpbmc7CiAgICAgIG5vdGl6ZW46IHN0cmluZzsKICAgICAgc3VtbWVyUmF0ZUFmdGVySWQ6IG51bWJlcjsKICAgICAgY2x1YlJhdGVJZDogbnVtYmVyOwogICAgICB0b2tlbjogc3RyaW5nOwogICAgICB2b3JuYW1lOiBzdHJpbmc7CiAgICAgIHdpbnRlclJhdGVBZnRlcklkOiBudW1iZXI7CiAgICAgIHdpbnRlclJhdGVCZWZvcmVJZDogbnVtYmVyOwogICAgICBTdW1tZXJSYXRlQWZ0ZXI6IHsKICAgICAgICBhcnRpY2xlZ3JvdXBpZDogc3RyaW5nOwogICAgICAgIGJleGlvSWQ6IHN0cmluZzsKICAgICAgICBpZDogbnVtYmVyOwogICAgICAgIGludGVybmNvZGU6IHN0cmluZzsKICAgICAgICBpbnRlcm5kZXNjcmlwdGlvbjogc3RyaW5nOwogICAgICAgIGludGVybm5hbWU6IHN0cmluZzsKICAgICAgICBzYWxlcHJpY2U6IG51bWJlcjsKICAgICAgICB0YXhpZDogc3RyaW5nOwogICAgICB9OwogICAgICBTdW1tZXJSYXRlQmVmb3JlOiB7CiAgICAgICAgYXJ0aWNsZWdyb3VwaWQ6IHN0cmluZzsKICAgICAgICBiZXhpb0lkOiBzdHJpbmc7CiAgICAgICAgaWQ6IG51bWJlcjsKICAgICAgICBpbnRlcm5jb2RlOiBzdHJpbmc7CiAgICAgICAgaW50ZXJuZGVzY3JpcHRpb246IHN0cmluZzsKICAgICAgICBpbnRlcm5uYW1lOiBzdHJpbmc7CiAgICAgICAgc2FsZXByaWNlOiBudW1iZXI7CiAgICAgICAgdGF4aWQ6IHN0cmluZzsKICAgICAgfTsKICAgICAgV2ludGVyUmF0ZUFmdGVyOiB7CiAgICAgICAgYXJ0aWNsZWdyb3VwaWQ6IHN0cmluZzsKICAgICAgICBiZXhpb0lkOiBzdHJpbmc7CiAgICAgICAgaWQ6IG51bWJlcjsKICAgICAgICBpbnRlcm5jb2RlOiBzdHJpbmc7CiAgICAgICAgaW50ZXJuZGVzY3JpcHRpb246IHN0cmluZzsKICAgICAgICBpbnRlcm5uYW1lOiBzdHJpbmc7CiAgICAgICAgc2FsZXByaWNlOiBudW1iZXI7CiAgICAgICAgdGF4aWQ6IHN0cmluZzsKICAgICAgfTsKICAgICAgV2ludGVyUmF0ZUJlZm9yZTogewogICAgICAgIGFydGljbGVncm91cGlkOiBzdHJpbmc7CiAgICAgICAgYmV4aW9JZDogc3RyaW5nOwogICAgICAgIGlkOiBudW1iZXI7CiAgICAgICAgaW50ZXJuY29kZTogc3RyaW5nOwogICAgICAgIGludGVybmRlc2NyaXB0aW9uOiBzdHJpbmc7CiAgICAgICAgaW50ZXJubmFtZTogc3RyaW5nOwogICAgICAgIHNhbGVwcmljZTogbnVtYmVyOwogICAgICAgIHRheGlkOiBzdHJpbmc7CiAgICAgIH07CiAgICAgIENsdWJSYXRlOiB7CiAgICAgICAgYXJ0aWNsZWdyb3VwaWQ6IHN0cmluZzsKICAgICAgICBiZXhpb0lkOiBzdHJpbmc7CiAgICAgICAgaWQ6IG51bWJlcjsKICAgICAgICBpbnRlcm5jb2RlOiBzdHJpbmc7CiAgICAgICAgaW50ZXJuZGVzY3JpcHRpb246IHN0cmluZzsKICAgICAgICBpbnRlcm5uYW1lOiBzdHJpbmc7CiAgICAgICAgc2FsZXByaWNlOiBudW1iZXI7CiAgICAgICAgdGF4aWQ6IHN0cmluZzsKICAgICAgfTsKICAgIH07CgogICAgdHlwZSBSYXBwb3J0VHlwZSA9IHsKICAgICAgYXJjaGl2ZWQ6IGJvb2xlYW47CiAgICAgIGRhdHVtOiBzdHJpbmc7CiAgICAgIGdydXBwZTogR3J1cHBlVHlwZTsKICAgICAgZ3J1cHBlSWQ6IG51bWJlcjsKICAgICAgaW52b2ljZWRJbjogc3RyaW5nIHwgbnVsbDsKICAgICAga3VuZGU6IEt1bmRlVHlwZTsKICAgICAga3VuZGVJZDogbnVtYmVyOwogICAgICBuYWNoaG9sdGVybWluOiBzdHJpbmcgfCBudWxsOwogICAgICBub3RpemVuOiBzdHJpbmc7CiAgICAgIHBsYXR6OiBQbGF0elR5cGU7CiAgICAgIHBsYXR6SWQ6IG51bWJlcjsKICAgICAgcHJvYmV0cmFpbmluZzogYm9vbGVhbjsKICAgICAgc3RhcnR6ZWl0OiBzdHJpbmcgfCBEYXRlOwogICAgICB0cmFpbmVyOiBUcmFpbmVyVHlwZTsKICAgICAgdHJhaW5lcklkOiBudW1iZXI7CiAgICAgIHRyYWluaW5nVHlwZTogc3RyaW5nOwogICAgICB0cmFpbmluZ3NkYXVlcjogc3RyaW5nOwogICAgfTsKCiAgICBjb25zdCBncm91cEludm9pY2VzQnlUcmFpbmVyID0gKAogICAgICBpbnZvaWNlczogUmFwcG9ydFR5cGVbXQogICAgKTogeyBbdHJhaW5lck5hbWU6IHN0cmluZ106IFJhcHBvcnRUeXBlW10gfSA9PiB7CiAgICAgIC8vIGdyb3VwIHRoZSBhcnJheSBvZiBpbnZvaWNlcyBieSB0cmFpbmVyIGFuZCByZXR1cm4gaXQKICAgICAgY29uc3QgZ3JvdXBlZEludm9pY2VzOiB7IFt0cmFpbmVyTmFtZTogc3RyaW5nXTogUmFwcG9ydFR5cGVbXSB9ID0ge307CgogICAgICBmb3IgKGNvbnN0IGludm9pY2Ugb2YgaW52b2ljZXMpIHsKICAgICAgICBjb25zdCB0cmFpbmVyTmFtZSA9IGludm9pY2UudHJhaW5lci5uYW1lOwogICAgICAgIGlmIChncm91cGVkSW52b2ljZXNbdHJhaW5lck5hbWVdKSB7CiAgICAgICAgICBncm91cGVkSW52b2ljZXNbdHJhaW5lck5hbWVdLnB1c2goaW52b2ljZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGdyb3VwZWRJbnZvaWNlc1t0cmFpbmVyTmFtZV0gPSBbaW52b2ljZV07CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBncm91cGVkSW52b2ljZXM7CiAgICB9OwoKICAgIGNvbnN0IGdyb3VwVHJhaW5lclJhcHBvcnRzQnlUaW1lID0gYXN5bmMgKAogICAgICBpbnZvaWNlczogUmFwcG9ydFR5cGVbXQogICAgKTogeyBbcHJvZHVjdFR5cGU6IHN0cmluZ106IFJhcHBvcnRUeXBlW10gfSA9PiB7CiAgICAgIGNvbnN0IGludm9pY2VHZW5lcmF0aW9uQ29uZmlnID0gYXdhaXQgdGhpcy5JbnZvaWNlR2VuZXJhdGlvbkNvbmZpZygpOwoKICAgICAgbGV0IHNlYXNvbiA9IChhd2FpdCBpbnZvaWNlR2VuZXJhdGlvbkNvbmZpZy5maW5kQnlJZCgxKSkuY29uZmlnVmFsdWU7CiAgICAgIGxldCB0aW1lID0gKGF3YWl0IGludm9pY2VHZW5lcmF0aW9uQ29uZmlnLmZpbmRCeUlkKDIpKS5jb25maWdWYWx1ZSB8fCAxNzsKCiAgICAgIGNvbnNvbGUubG9nKHsgc2Vhc29uIH0pOwoKICAgICAgbGV0IGlzU3VtbWVyID0gc2Vhc29uID09PSAic3VtbWVyIiA/IHRydWUgOiBmYWxzZTsKICAgICAgbGV0IERheUVuZEhvdXIgPSBkYXlqcygpLmhvdXIodGltZSkubWludXRlKDApLnNlY29uZCgwKTsKCiAgICAgIGxldCBncm91cGVkSW52b2ljZXM6IHsgW3Byb2R1Y3RUeXBlOiBzdHJpbmddOiBSYXBwb3J0VHlwZVtdIH0gPSB7CiAgICAgICAgU3VtbWVyUmF0ZUFmdGVyOiBbXSwKICAgICAgICBTdW1tZXJSYXRlQmVmb3JlOiBbXSwKICAgICAgICBXaW50ZXJSYXRlQWZ0ZXI6IFtdLAogICAgICAgIFdpbnRlclJhdGVCZWZvcmU6IFtdLAogICAgICAgIENsdWJSYXRlOiBbXSwKICAgICAgfTsKCiAgICAgIC8vIEdyb3VwIHJhcHBvcnRzIGJ5IHRyYWluaW5nIHNlc3Npb24gdG8gZGV0ZXJtaW5lIGdyb3VwIHNpemUKICAgICAgY29uc3QgcmFwcG9ydHNCeVNlc3Npb246IHsgW2tleTogc3RyaW5nXTogUmFwcG9ydFR5cGVbXSB9ID0ge307CiAgICAgIGludm9pY2VzLmZvckVhY2gocmFwcG9ydCA9PiB7CiAgICAgICAgY29uc3Qgc2Vzc2lvbktleSA9IGAke3JhcHBvcnQuZGF0dW19LSR7cmFwcG9ydC5zdGFydHplaXR9LSR7cmFwcG9ydC50cmFpbmVySWR9YDsKICAgICAgICBpZiAoIXJhcHBvcnRzQnlTZXNzaW9uW3Nlc3Npb25LZXldKSB7CiAgICAgICAgICByYXBwb3J0c0J5U2Vzc2lvbltzZXNzaW9uS2V5XSA9IFtdOwogICAgICAgIH0KICAgICAgICByYXBwb3J0c0J5U2Vzc2lvbltzZXNzaW9uS2V5XS5wdXNoKHJhcHBvcnQpOwogICAgICB9KTsKCiAgICAgIGludm9pY2VzLm1hcCgocmFwcG9ydCkgPT4gewogICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIHRyYWluaW5nIHR5cGVzIGFuZCBncm91cCB0cmFpbmluZ3MKICAgICAgICBpZiAocmFwcG9ydC50cmFpbmluZ1R5cGUgPT09ICJncnVwcGUiIHx8CiAgICAgICAgICByYXBwb3J0LnRyYWluaW5nVHlwZSA9PT0gIm1hbm5zY2hhZnQiIHx8CiAgICAgICAgICByYXBwb3J0LnRyYWluaW5nVHlwZSA9PT0gIm1hbm5zY2hhZnRfcGxhdHoiIHx8CiAgICAgICAgICByYXBwb3J0LnRyYWluaW5nVHlwZSA9PT0gImF1ZnNjaGxhZyIpIHsKCiAgICAgICAgICBjb25zdCBzZXNzaW9uS2V5ID0gYCR7cmFwcG9ydC5kYXR1bX0tJHtyYXBwb3J0LnN0YXJ0emVpdH0tJHtyYXBwb3J0LnRyYWluZXJJZH1gOwogICAgICAgICAgY29uc3QgZ3JvdXBTaXplID0gcmFwcG9ydHNCeVNlc3Npb25bc2Vzc2lvbktleV0ubGVuZ3RoOwogICAgICAgICAgY29uc3QgaXNGaXhwbGF0eiA9IHJhcHBvcnQucGxhdHpJZCA9PT0gMjsKCiAgICAgICAgICAvLyBHZXQgdGhlIGFwcHJvcHJpYXRlIHByb2R1Y3QgY29kZQogICAgICAgICAgY29uc3QgcHJvZHVjdENvZGUgPSBnZXRHcm91cFByb2R1Y3RDb2RlKHJhcHBvcnQudHJhaW5pbmdUeXBlLCBncm91cFNpemUsIHJhcHBvcnQua3VuZGUsIGlzRml4cGxhdHosIGlzU3VtbWVyKTsKCiAgICAgICAgICAvLyBBZGQgdG8gYSBuZXcgZ3JvdXAgZm9yIHRoaXMgcHJvZHVjdCBjb2RlIGlmIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgICAgIGlmICghZ3JvdXBlZEludm9pY2VzW3Byb2R1Y3RDb2RlXSkgewogICAgICAgICAgICBncm91cGVkSW52b2ljZXNbcHJvZHVjdENvZGVdID0gW107CiAgICAgICAgICB9CiAgICAgICAgICBncm91cGVkSW52b2ljZXNbcHJvZHVjdENvZGVdLnB1c2gocmFwcG9ydCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBIYW5kbGUgcmVndWxhciBwcml2YXRlIGxlc3NvbnMgYXMgYmVmb3JlCiAgICAgICAgaWYgKHJhcHBvcnQucGxhdHpJZCA9PT0gMikgewogICAgICAgICAgZ3JvdXBlZEludm9pY2VzLkNsdWJSYXRlLnB1c2gocmFwcG9ydCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyByYXBwb3J0LnN0YXJ0emVpdCBpcyBpbiBmb3JtYXQgMTM6MDA6MDAKICAgICAgICBsZXQgcmFwcG9ydFRpbWVTdGFydCA9IGRheWpzKCkKICAgICAgICAgIC5ob3VyKHJhcHBvcnQuc3RhcnR6ZWl0LnNwbGl0KCI6IilbMF0pCiAgICAgICAgICAubWludXRlKHJhcHBvcnQuc3RhcnR6ZWl0LnNwbGl0KCI6IilbMV0pCiAgICAgICAgICAuc2Vjb25kKHJhcHBvcnQuc3RhcnR6ZWl0LnNwbGl0KCI6IilbMl0pOwoKICAgICAgICBsZXQgcmFwcG9ydFRpbWVFbmQgPSBkYXlqcygpCiAgICAgICAgICAuaG91cihyYXBwb3J0LnN0YXJ0emVpdC5zcGxpdCgiOiIpWzBdKQogICAgICAgICAgLm1pbnV0ZShyYXBwb3J0LnN0YXJ0emVpdC5zcGxpdCgiOiIpWzFdKQogICAgICAgICAgLnNlY29uZChyYXBwb3J0LnN0YXJ0emVpdC5zcGxpdCgiOiIpWzJdKQogICAgICAgICAgLmFkZChyZXR1cm5UcmFpbmluZ0R1cmF0aW9uSW5Ib3VycyhyYXBwb3J0LnRyYWluaW5nc2RhdWVyKSwgImhvdXIiKTsKCiAgICAgICAgY29uc29sZS5sb2coeyByYXBwb3J0VGltZVN0YXJ0LCByYXBwb3J0VGltZUVuZCwgcmFwcG9ydCB9KTsKCiAgICAgICAgLy8gaWYgcmFwcG9ydFRpbWVTdGFydCBpcyBiZWZvcmUgdGltZSBhbmQgcmFwcG9ydFRpbWVFbmQgaXMgYWZ0ZXIgdGltZSB0aGVuIGl0IGlzIGEgc3BsaXQgaW52b2ljZQogICAgICAgIGlmICgKICAgICAgICAgIHJhcHBvcnRUaW1lU3RhcnQuaXNCZWZvcmUoRGF5RW5kSG91ciwgIm1pbnV0ZSIpICYmCiAgICAgICAgICByYXBwb3J0VGltZUVuZC5pc0FmdGVyKERheUVuZEhvdXIsICJtaW51dGUiKQogICAgICAgICkgewogICAgICAgICAgLy8gc3BsaXQgdGhlIGludm9pY2UgaW50byB0d28KICAgICAgICAgIGxldCByYXBwb3J0MSA9IHsgLi4ucmFwcG9ydCB9OwogICAgICAgICAgbGV0IHJhcHBvcnQyID0geyAuLi5yYXBwb3J0IH07CgogICAgICAgICAgbGV0IGR1cmF0aW9uMSA9IE1hdGguY2VpbCgKICAgICAgICAgICAgRGF5RW5kSG91ci5kaWZmKHJhcHBvcnRUaW1lU3RhcnQsICJtaW51dGUiKQogICAgICAgICAgKTsKICAgICAgICAgIGxldCBkdXJhdGlvbjIgPSBNYXRoLmNlaWwocmFwcG9ydFRpbWVFbmQuZGlmZihEYXlFbmRIb3VyLCAibWludXRlIikpOwoKICAgICAgICAgIC8vIGFwcHJveGltYXRlIGl0IHRvIHRoZSBuZWFyZXN0IDMwIG1pbnV0ZXMgZXhjZXB0IGlmIGl0IGlzIGxlc3MgdGhhbiA0NSBtaW51dGVzIGJ1dCBtb3JlIHRoYW4gMzAgbWludXRlcyB0aGVuIHNldCBpdCB0byA0NSBtaW51dGVzCiAgICAgICAgICBpZiAoZHVyYXRpb24xIDwgNDUgJiYgZHVyYXRpb24xID4gMzApIGR1cmF0aW9uMSA9IDQ1OwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGR1cmF0aW9uMSA9IE1hdGguY2VpbChkdXJhdGlvbjEgLyAzMCkgKiAzMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChkdXJhdGlvbjIgPCA0NSAmJiBkdXJhdGlvbjIgPiAzMCkgZHVyYXRpb24yID0gNDU7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZHVyYXRpb24yID0gTWF0aC5jZWlsKGR1cmF0aW9uMiAvIDMwKSAqIDMwOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnNvbGUubG9nKHsgZHVyYXRpb24xLCBkdXJhdGlvbjIgfSk7CgogICAgICAgICAgZHVyYXRpb24xID0gYCR7TWF0aC5mbG9vcihkdXJhdGlvbjEgLyA2MCl9OiR7ZHVyYXRpb24xICUgNjB9YDsKICAgICAgICAgIGR1cmF0aW9uMiA9IGAke01hdGguZmxvb3IoZHVyYXRpb24yIC8gNjApfToke2R1cmF0aW9uMiAlIDYwfWA7CgogICAgICAgICAgY29uc29sZS5sb2coewogICAgICAgICAgICBkdXJhdGlvbjEsCiAgICAgICAgICAgIGR1cmF0aW9uMiwKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJhcHBvcnQxLnRyYWluaW5nc2RhdWVyID0gZHVyYXRpb24xOwogICAgICAgICAgcmFwcG9ydDIudHJhaW5pbmdzZGF1ZXIgPSBkdXJhdGlvbjI7CgogICAgICAgICAgaWYgKGlzU3VtbWVyKSB7CiAgICAgICAgICAgIC8vIGlmIHRoZSByYXBwb3J0cyBzdGFydHplaXQgaXMgYmVmb3JlIDE3OjAwIHRoZW4gaXQgaXMgYSBTdW1tZXJSYXRlQmVmb3JlCiAgICAgICAgICAgIGdyb3VwZWRJbnZvaWNlcy5TdW1tZXJSYXRlQmVmb3JlLnB1c2gocmFwcG9ydDEpOwogICAgICAgICAgICBncm91cGVkSW52b2ljZXMuU3VtbWVyUmF0ZUFmdGVyLnB1c2gocmFwcG9ydDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVCZWZvcmUucHVzaChyYXBwb3J0MSk7CiAgICAgICAgICAgIGdyb3VwZWRJbnZvaWNlcy5XaW50ZXJSYXRlQWZ0ZXIucHVzaChyYXBwb3J0Mik7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNTdW1tZXIpIHsKICAgICAgICAgIC8vIGlmIHRoZSByYXBwb3J0cyBzdGFydHplaXQgaXMgYmVmb3JlIDE3OjAwIHRoZW4gaXQgaXMgYSBTdW1tZXJSYXRlQmVmb3JlCiAgICAgICAgICBpZiAocmFwcG9ydFRpbWVTdGFydC5pc0JlZm9yZShEYXlFbmRIb3VyLCAiaG91ciIpKSB7CiAgICAgICAgICAgIGdyb3VwZWRJbnZvaWNlcy5TdW1tZXJSYXRlQmVmb3JlLnB1c2gocmFwcG9ydCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBncm91cGVkSW52b2ljZXMuU3VtbWVyUmF0ZUFmdGVyLnB1c2gocmFwcG9ydCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChyYXBwb3J0VGltZVN0YXJ0LmlzQmVmb3JlKERheUVuZEhvdXIsICJob3VyIikpIHsKICAgICAgICAgICAgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVCZWZvcmUucHVzaChyYXBwb3J0KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGdyb3VwZWRJbnZvaWNlcy5XaW50ZXJSYXRlQWZ0ZXIucHVzaChyYXBwb3J0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgZm9yIChsZXQga2V5IGluIGdyb3VwZWRJbnZvaWNlcykgewogICAgICAgIGlmIChncm91cGVkSW52b2ljZXNba2V5XS5sZW5ndGggPT09IDApIHsKICAgICAgICAgIGRlbGV0ZSBncm91cGVkSW52b2ljZXNba2V5XTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIGlmIHRoZSBwcm9kdWN0SWQgaXMgdGhlIHNhbWUgdGhlbiBtZXJnZSBvbmUgaW50byB0aGUgb3RoZXIKICAgICAgaWYgKAogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uU3VtbWVyUmF0ZUJlZm9yZSAmJgogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uU3VtbWVyUmF0ZUFmdGVyICYmCiAgICAgICAgZ3JvdXBlZEludm9pY2VzPy5TdW1tZXJSYXRlQmVmb3JlPy5bMF0udHJhaW5lci5TdW1tZXJSYXRlQmVmb3JlLmlkID09PQogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uU3VtbWVyUmF0ZUFmdGVyPy5bMF0udHJhaW5lci5TdW1tZXJSYXRlQWZ0ZXIuaWQKICAgICAgKSB7CiAgICAgICAgZ3JvdXBlZEludm9pY2VzLlN1bW1lclJhdGVCZWZvcmUgPQogICAgICAgICAgZ3JvdXBlZEludm9pY2VzLlN1bW1lclJhdGVCZWZvcmU/LmNvbmNhdCgKICAgICAgICAgICAgZ3JvdXBlZEludm9pY2VzLlN1bW1lclJhdGVBZnRlcgogICAgICAgICAgKTsKICAgICAgICBkZWxldGUgZ3JvdXBlZEludm9pY2VzLlN1bW1lclJhdGVBZnRlcjsKICAgICAgfQoKICAgICAgaWYgKAogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uV2ludGVyUmF0ZUJlZm9yZSAmJgogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uV2ludGVyUmF0ZUFmdGVyICYmCiAgICAgICAgZ3JvdXBlZEludm9pY2VzPy5XaW50ZXJSYXRlQmVmb3JlPy5bMF0udHJhaW5lci5XaW50ZXJSYXRlQmVmb3JlLmlkID09PQogICAgICAgIGdyb3VwZWRJbnZvaWNlcz8uV2ludGVyUmF0ZUFmdGVyPy5bMF0udHJhaW5lci5XaW50ZXJSYXRlQWZ0ZXIuaWQKICAgICAgKSB7CiAgICAgICAgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVCZWZvcmUgPQogICAgICAgICAgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVCZWZvcmU/LmNvbmNhdCgKICAgICAgICAgICAgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVBZnRlcgogICAgICAgICAgKTsKICAgICAgICBkZWxldGUgZ3JvdXBlZEludm9pY2VzLldpbnRlclJhdGVBZnRlcjsKICAgICAgfQoKICAgICAgY29uc29sZS5sb2coeyBncm91cGVkSW52b2ljZXMgfSk7CiAgICAgIHJldHVybiBncm91cGVkSW52b2ljZXM7CiAgICB9OwoKICAgIGNvbnN0IHVwZGF0ZVJhcHBvcnRXaXRoSW52b2ljZUlkID0gYXN5bmMgKHJhcHBvcnRJZCwgaW52b2ljZWRJbikgPT4gewogICAgICBjb25zdCByYXBwb3J0ID0gYXdhaXQgdGhpcy5SYXBwb3J0KCk7CgogICAgICBhd2FpdCByYXBwb3J0LnVwZGF0ZUJ5SWQocmFwcG9ydElkLCB7CiAgICAgICAgaW52b2ljZWRJbiwKICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IHJldHVyblRyYWluaW5nRHVyYXRpb25JbkhvdXJzID0gKGR1cmF0aW9uKSA9PiB7CiAgICAgIC8vIHRoZSBkdXJhdGlvbiBpcyBpbiBmb3JtYXQgMDA6MzA6MDAgYW5kIHdlIHdhbnQgdG8gcmV0dXJuIDAuNQogICAgICBsZXQgaG91cnMgPSBkdXJhdGlvbi5zcGxpdCgiOiIpWzBdOwogICAgICBsZXQgbWludXRlcyA9IGR1cmF0aW9uLnNwbGl0KCI6IilbMV07CgogICAgICByZXR1cm4gcGFyc2VJbnQoaG91cnMpICsgcGFyc2VJbnQobWludXRlcykgLyA2MDsKICAgIH07CgogICAgY29uc3QgaXNBZHVsdCA9IChrdW5kZTogS3VuZGVUeXBlKSA9PiB7CiAgICAgIGlmICgha3VuZGUuZ2VidXJ0c3RhZykgcmV0dXJuIHRydWU7CiAgICAgIGNvbnN0IGFnZSA9IGRheWpzKCkuZGlmZihkYXlqcyhrdW5kZS5nZWJ1cnRzdGFnKSwgJ3llYXInKTsKICAgICAgcmV0dXJuIGFnZSA+PSAxODsKICAgIH07CgogICAgY29uc3QgZ2V0UHJvZHVjdEluZm8gPSBhc3luYyAocHJvZHVjdENvZGU6IHN0cmluZykgPT4gewogICAgICBjb25zdCBQcm9kdWN0ID0gYXdhaXQgdGhpcy5Qcm9kdWN0KCk7CiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRPbmUoewogICAgICAgIHdoZXJlOiB7CiAgICAgICAgICBiZXhpb0lkOiBwcm9kdWN0Q29kZQogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoIXByb2R1Y3QpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb2R1Y3Qgd2l0aCBjb2RlICR7cHJvZHVjdENvZGV9IG5vdCBmb3VuZGApOwogICAgICB9CgogICAgICByZXR1cm4gcHJvZHVjdDsKICAgIH07CgogICAgY29uc3QgZ2V0R3JvdXBQcm9kdWN0Q29kZSA9ICh0cmFpbmluZ1R5cGU6IHN0cmluZywgZ3JvdXBTaXplOiBudW1iZXIsIGt1bmRlOiBLdW5kZVR5cGUsIGlzRml4cGxhdHo6IGJvb2xlYW4sIGlzU3VtbWVyOiBib29sZWFuKSA9PiB7CiAgICAgIC8vIEhhbmRsZSBmaXhwbGF0eiBjYXNlIGZpcnN0CiAgICAgIGlmIChpc0ZpeHBsYXR6KSB7CiAgICAgICAgc3dpdGNoIChncm91cFNpemUpIHsKICAgICAgICAgIGNhc2UgMjogcmV0dXJuICIyMDYwIjsKICAgICAgICAgIGNhc2UgMzogcmV0dXJuICIyMDcwIjsKICAgICAgICAgIGNhc2UgNDogcmV0dXJuICIyMDgwIjsKICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiAiMjA4MCI7IC8vIERlZmF1bHQgdG8gZ3JvdXAgb2YgNCBmb3IgbGFyZ2VyIGdyb3VwcwogICAgICAgIH0KICAgICAgfQoKCiAgICAgIGlmICh0cmFpbmluZ1R5cGUgPT09ICJtYW5uc2NoYWZ0IikgewogICAgICAgIHJldHVybiAiMjA5MCI7IC8vIE1hbm5zY2hhZnRzdHJhaW5pbmcgb2huZSBQbGF0em1pZXRlCiAgICAgIH0KICAgICAgaWYgKHRyYWluaW5nVHlwZSA9PT0gIm1hbm5zY2hhZnRfcGxhdHoiKSB7CiAgICAgICAgcmV0dXJuICIyMDk1IjsgLy8gTWFubnNjaGFmdHN0cmFpbmluZyBpbmtsLiBQbGF0em1pZXRlCiAgICAgIH0KICAgICAgaWYgKHRyYWluaW5nVHlwZSA9PT0gImF1ZnNjaGxhZyIpIHsKICAgICAgICByZXR1cm4gZ3JvdXBTaXplID49IDUgPyAiNDUxMCIgOiAiNDUwMCI7CiAgICAgIH0KCiAgICAgIC8vIEhhbmRsZSBUcmVmZiB0cmFpbmluZyB0eXBlcwogICAgICBpZiAodHJhaW5pbmdUeXBlID09PSAiZml0bmVzc190ZW5uaXMiKSB7CiAgICAgICAgcmV0dXJuICI1MDEwIjsKICAgICAgfQogICAgICBpZiAodHJhaW5pbmdUeXBlID09PSAibW9ybmluZ190cmVmZiIpIHsKICAgICAgICByZXR1cm4gIjUwMjAiOwogICAgICB9CiAgICAgIGlmICh0cmFpbmluZ1R5cGUgPT09ICJhZnRlcl93b3JrIikgewogICAgICAgIHJldHVybiAiNTA0MCI7CiAgICAgIH0KICAgICAgaWYgKHRyYWluaW5nVHlwZSA9PT0gIm1pdHRhZ3NfdHJlZmYiKSB7CiAgICAgICAgcmV0dXJuICI1MDUwIjsKICAgICAgfQoKICAgICAgLy8gSGFuZGxlIHJlZ3VsYXIgZ3JvdXAgdHJhaW5pbmdzCiAgICAgIGNvbnN0IGlzQWR1bHRQYXJ0aWNpcGFudCA9IGlzQWR1bHQoa3VuZGUpOwoKICAgICAgaWYgKGlzU3VtbWVyKSB7CiAgICAgICAgaWYgKGlzQWR1bHRQYXJ0aWNpcGFudCkgewogICAgICAgICAgc3dpdGNoIChncm91cFNpemUpIHsKICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gIjI1MjAiOwogICAgICAgICAgICBjYXNlIDM6IHJldHVybiAiMjUzMCI7CiAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuICIyNTQwIjsKICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICIyNTUwIjsgLy8gNSBvciA2CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN3aXRjaCAoZ3JvdXBTaXplKSB7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuICIzNTIwIjsKICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gIjM1MzAiOwogICAgICAgICAgICBjYXNlIDQ6IHJldHVybiAiMzU0MCI7CiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiAiMzU0MCI7IC8vIERlZmF1bHQgdG8gZ3JvdXAgb2YgNCBmb3IgbGFyZ2VyIGdyb3VwcwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaXNBZHVsdFBhcnRpY2lwYW50KSB7CiAgICAgICAgICBzd2l0Y2ggKGdyb3VwU2l6ZSkgewogICAgICAgICAgICBjYXNlIDI6IHJldHVybiAiMjAyMCI7CiAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuICIyMDMwIjsKICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gIjIwNDAiOwogICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gIjIwNTAiOyAvLyA1IG9yIDYKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3dpdGNoIChncm91cFNpemUpIHsKICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gIjMwMjAiOwogICAgICAgICAgICBjYXNlIDM6IHJldHVybiAiMzAzMCI7CiAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuICIzMDQwIjsKICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICIzMDQwIjsgLy8gRGVmYXVsdCB0byBncm91cCBvZiA0IGZvciBsYXJnZXIgZ3JvdXBzCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IGZvcm1hdER1cmF0aW9uID0gKGR1cmF0aW9uKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKHsgZHVyYXRpb24gfSk7CiAgICAgIGxldCBob3VycyA9IGR1cmF0aW9uLnNwbGl0KCI6IilbMF07CiAgICAgIGxldCBtaW51dGVzID0gZHVyYXRpb24uc3BsaXQoIjoiKVsxXTsKCiAgICAgIC8vIGNoYW5nZSB0byBtaW51dGVzCiAgICAgIG1pbnV0ZXMgPSBwYXJzZUludChob3VycykgKiA2MCArIHBhcnNlSW50KG1pbnV0ZXMpOwoKICAgICAgaWYgKG1pbnV0ZXMgPCA0NSkgewogICAgICAgIG1pbnV0ZXMgPSAzMDsKICAgICAgfSBlbHNlIGlmIChtaW51dGVzIDwgNjApIHsKICAgICAgICBtaW51dGVzID0gNDU7CiAgICAgIH0gZWxzZSBpZiAobWludXRlcyA8IDc1KSB7CiAgICAgICAgbWludXRlcyA9IDYwOwogICAgICB9IGVsc2UgaWYgKG1pbnV0ZXMgPCAxMDUpIHsKICAgICAgICBtaW51dGVzID0gOTA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWludXRlcyA9IDEyMDsKICAgICAgfQogICAgICByZXR1cm4gbWludXRlcyArICIgbWluIjsKICAgIH07CgogICAgLy8gUmVwbHkgd2l0aCBhIGdyZWV0aW5nLCB0aGUgY3VycmVudCB0aW1lLCB0aGUgdXJsLCBhbmQgcmVxdWVzdCBoZWFkZXJzCiAgICBjb25zdCB7IGludm9pY2VUaXRsZURhdGUsIGdyb3VwLCBtaW5EYXRlLCBtYXhEYXRlIH0gPSBCZXhpb0JvZHkgYXMgewogICAgICBpbnZvaWNlVGl0bGVEYXRlOiBzdHJpbmc7CiAgICAgIG1pbkRhdGU6IHN0cmluZzsKICAgICAgbWF4RGF0ZTogc3RyaW5nOwogICAgICBncm91cDogewogICAgICAgIGt1bmRlOiBLdW5kZVR5cGU7CiAgICAgICAgcmFwcG9ydHM6IFJhcHBvcnRUeXBlW107CiAgICAgIH07CiAgICB9OwoKICAgIC8vIGxldCByYXBwb3J0c0dyb3VwZWRCeVRyYWluZXIgPSBncm91cEludm9pY2VzQnlUcmFpbmVyKGdyb3VwLnJhcHBvcnRzKTsKICAgIGxldCBjaGlsZHJlblJhcHBvcnRzID0ge307CiAgICBsZXQgcGFyZW50UmFwcG9ydHMgPSBbXTsKCiAgICBmb3IgKGxldCByYXBwb3J0IG9mIGdyb3VwLnJhcHBvcnRzKSB7CiAgICAgIGlmIChyYXBwb3J0Lmt1bmRlSWQgPT09IGdyb3VwLmt1bmRlLmlkKSB7CiAgICAgICAgcGFyZW50UmFwcG9ydHMucHVzaChyYXBwb3J0KTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGNoaWxkcmVuUmFwcG9ydHNbYCR7cmFwcG9ydC5rdW5kZS52b3JuYW1lfSAke3JhcHBvcnQua3VuZGUubmFtZX1gXSkgewogICAgICAgIGNoaWxkcmVuUmFwcG9ydHNbYCR7cmFwcG9ydC5rdW5kZS52b3JuYW1lfSAke3JhcHBvcnQua3VuZGUubmFtZX1gXS5wdXNoKAogICAgICAgICAgcmFwcG9ydAogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2hpbGRyZW5SYXBwb3J0c1tgJHtyYXBwb3J0Lmt1bmRlLnZvcm5hbWV9ICR7cmFwcG9ydC5rdW5kZS5uYW1lfWBdID0gWwogICAgICAgICAgcmFwcG9ydCwKICAgICAgICBdOwogICAgICB9CiAgICB9CgogICAgbGV0IHBvc2l0aW9ucyA9IFtdOwoKICAgIGlmIChwYXJlbnRSYXBwb3J0cy5sZW5ndGggPiAwKSB7CiAgICAgIGxldCBwYXJlbnROYW1lID0gZ3JvdXAua3VuZGUudm9ybmFtZSArICIgIiArIGdyb3VwLmt1bmRlLm5hbWU7CiAgICAgIHBvc2l0aW9ucy5wdXNoKHsKICAgICAgICB0ZXh0OiBgJHtwYXJlbnROYW1lfSA8YnIvPiBgLAogICAgICAgIHR5cGU6ICJLYlBvc2l0aW9uVGV4dCIsCiAgICAgIH0pOwogICAgICBsZXQgcmFwcG9ydHNHcm91cGVkQnlUcmFpbmVyID0gZ3JvdXBJbnZvaWNlc0J5VHJhaW5lcihwYXJlbnRSYXBwb3J0cyk7CgogICAgICBmb3IgKGxldCB0cmFpbmVyIGluIHJhcHBvcnRzR3JvdXBlZEJ5VHJhaW5lcikgewogICAgICAgIGxldCByYXBwb3J0c0dyb3VwZWRCeVRpbWUgPSBhd2FpdCBncm91cFRyYWluZXJSYXBwb3J0c0J5VGltZSgKICAgICAgICAgIHJhcHBvcnRzR3JvdXBlZEJ5VHJhaW5lclt0cmFpbmVyXQogICAgICAgICk7CgogICAgICAgIGxldCB0cmFpbmVyTmFtZSA9IHJhcHBvcnRzR3JvdXBlZEJ5VHJhaW5lclt0cmFpbmVyXVswXS50cmFpbmVyLm5hbWU7CgogICAgICAgIGZvciAobGV0IHByb2R1Y3RUeXBlIGluIHJhcHBvcnRzR3JvdXBlZEJ5VGltZSkgewogICAgICAgICAgbGV0IHByb2R1Y3Q7CiAgICAgICAgICBpZiAocHJvZHVjdFR5cGUubWF0Y2goL15cZHs0fSQvKSkgewogICAgICAgICAgICAvLyBJZiBwcm9kdWN0VHlwZSBpcyBhIDQtZGlnaXQgY29kZSwgaXQncyBvbmUgb2Ygb3VyIHNwZWNpYWwgcHJvZHVjdCBjb2RlcwogICAgICAgICAgICBwcm9kdWN0ID0gYXdhaXQgZ2V0UHJvZHVjdEluZm8ocHJvZHVjdFR5cGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHVzZSB0aGUgZXhpc3RpbmcgdHJhaW5lciByYXRlIGxvZ2ljCiAgICAgICAgICAgIHByb2R1Y3QgPSByYXBwb3J0c0dyb3VwZWRCeVRpbWVbcHJvZHVjdFR5cGVdWzBdLnRyYWluZXJbcHJvZHVjdFR5cGVdOwogICAgICAgICAgfQoKICAgICAgICAgIGxldCBwb3NpdGlvblRleHQgPSBgJHtwcm9kdWN0LmludGVybm5hbWV9IDxici8+YDsKCiAgICAgICAgICBsZXQgYW1vdW50ID0gMDsKICAgICAgICAgIHJhcHBvcnRzR3JvdXBlZEJ5VGltZVtwcm9kdWN0VHlwZV0KICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IChkYXlqcyhhLmRhdHVtKS5pc0FmdGVyKGRheWpzKGIuZGF0dW0pKSA/IDEgOiAtMSkpCiAgICAgICAgICAgIC5mb3JFYWNoKChyYXBwb3J0LCBpKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGkgPT09IHJhcHBvcnRzR3JvdXBlZEJ5VGltZVtwcm9kdWN0VHlwZV0ubGVuZ3RoIC0gMSkKICAgICAgICAgICAgICAgIHBvc2l0aW9uVGV4dCArPSBgJHtkYXlqcyhyYXBwb3J0LmRhdHVtKS5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICJERC5NTS5ZWVlZIgogICAgICAgICAgICAgICAgKX0gJHt0cmFpbmVyTmFtZX0gJHtmb3JtYXREdXJhdGlvbihyYXBwb3J0LnRyYWluaW5nc2RhdWVyKX1gOwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHBvc2l0aW9uVGV4dCArPSBgJHtkYXlqcyhyYXBwb3J0LmRhdHVtKS5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICJERC5NTS5ZWVlZIgogICAgICAgICAgICAgICAgKX0gJHt0cmFpbmVyTmFtZX0gJHtmb3JtYXREdXJhdGlvbigKICAgICAgICAgICAgICAgICAgcmFwcG9ydC50cmFpbmluZ3NkYXVlcgogICAgICAgICAgICAgICAgKX08YnIvPiBgOwoKICAgICAgICAgICAgICBhbW91bnQgKz0gcmV0dXJuVHJhaW5pbmdEdXJhdGlvbkluSG91cnMocmFwcG9ydC50cmFpbmluZ3NkYXVlcik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgcG9zaXRpb25zLnB1c2goewogICAgICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICAgICAgdGF4X2lkOiBwcm9kdWN0LnRheGlkLAogICAgICAgICAgICB0ZXh0OiBwb3NpdGlvblRleHQsCiAgICAgICAgICAgIHVuaXRfcHJpY2U6IHByb2R1Y3Quc2FsZXByaWNlLAogICAgICAgICAgICBhcnRpY2xlX2lkOiBwcm9kdWN0LmJleGlvSWQsCiAgICAgICAgICAgIHR5cGU6ICJLYlBvc2l0aW9uQXJ0aWNsZSIsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGxldCBrdW5kZU5hbWUgb2YgT2JqZWN0LmtleXMoY2hpbGRyZW5SYXBwb3J0cykpIHsKICAgICAgbGV0IHJhcHBvcnRzID0gY2hpbGRyZW5SYXBwb3J0c1trdW5kZU5hbWVdOwoKICAgICAgcG9zaXRpb25zLnB1c2goewogICAgICAgIHRleHQ6IGAke2t1bmRlTmFtZX0gPGJyLz4gYCwKICAgICAgICB0eXBlOiAiS2JQb3NpdGlvblRleHQiLAogICAgICB9KTsKICAgICAgbGV0IHJhcHBvcnRzR3JvdXBlZEJ5VHJhaW5lciA9IGdyb3VwSW52b2ljZXNCeVRyYWluZXIocmFwcG9ydHMpOwoKICAgICAgZm9yIChsZXQgdHJhaW5lciBpbiByYXBwb3J0c0dyb3VwZWRCeVRyYWluZXIpIHsKICAgICAgICBsZXQgcmFwcG9ydHNHcm91cGVkQnlUaW1lID0gYXdhaXQgZ3JvdXBUcmFpbmVyUmFwcG9ydHNCeVRpbWUoCiAgICAgICAgICByYXBwb3J0c0dyb3VwZWRCeVRyYWluZXJbdHJhaW5lcl0KICAgICAgICApOwoKICAgICAgICBsZXQgdHJhaW5lck5hbWUgPSByYXBwb3J0c0dyb3VwZWRCeVRyYWluZXJbdHJhaW5lcl1bMF0udHJhaW5lci5uYW1lOwoKICAgICAgICBmb3IgKGxldCBwcm9kdWN0VHlwZSBpbiByYXBwb3J0c0dyb3VwZWRCeVRpbWUpIHsKICAgICAgICAgIGxldCBwcm9kdWN0OwogICAgICAgICAgaWYgKHByb2R1Y3RUeXBlLm1hdGNoKC9eXGR7NH0kLykpIHsKICAgICAgICAgICAgLy8gSWYgcHJvZHVjdFR5cGUgaXMgYSA0LWRpZ2l0IGNvZGUsIGl0J3Mgb25lIG9mIG91ciBzcGVjaWFsIHByb2R1Y3QgY29kZXMKICAgICAgICAgICAgcHJvZHVjdCA9IGF3YWl0IGdldFByb2R1Y3RJbmZvKHByb2R1Y3RUeXBlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIE90aGVyd2lzZSB1c2UgdGhlIGV4aXN0aW5nIHRyYWluZXIgcmF0ZSBsb2dpYwogICAgICAgICAgICBwcm9kdWN0ID0gcmFwcG9ydHNHcm91cGVkQnlUaW1lW3Byb2R1Y3RUeXBlXVswXS50cmFpbmVyW3Byb2R1Y3RUeXBlXTsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcG9zaXRpb25UZXh0ID0gYCR7cHJvZHVjdC5pbnRlcm5uYW1lfSA8YnIvPmA7CgogICAgICAgICAgbGV0IGFtb3VudCA9IDA7CiAgICAgICAgICByYXBwb3J0c0dyb3VwZWRCeVRpbWVbcHJvZHVjdFR5cGVdCiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiAoZGF5anMoYS5kYXR1bSkuaXNBZnRlcihkYXlqcyhiLmRhdHVtKSkgPyAxIDogLTEpKQogICAgICAgICAgICAuZm9yRWFjaCgocmFwcG9ydCwgaSkgPT4gewogICAgICAgICAgICAgIGlmIChpID09PSByYXBwb3J0c0dyb3VwZWRCeVRpbWVbcHJvZHVjdFR5cGVdLmxlbmd0aCAtIDEpCiAgICAgICAgICAgICAgICBwb3NpdGlvblRleHQgKz0gYCR7ZGF5anMocmFwcG9ydC5kYXR1bSkuZm9ybWF0KAogICAgICAgICAgICAgICAgICAiREQuTU0uWVlZWSIKICAgICAgICAgICAgICAgICl9ICR7dHJhaW5lck5hbWV9ICR7Zm9ybWF0RHVyYXRpb24ocmFwcG9ydC50cmFpbmluZ3NkYXVlcil9YDsKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwb3NpdGlvblRleHQgKz0gYCR7ZGF5anMocmFwcG9ydC5kYXR1bSkuZm9ybWF0KAogICAgICAgICAgICAgICAgICAiREQuTU0uWVlZWSIKICAgICAgICAgICAgICAgICl9ICR7dHJhaW5lck5hbWV9ICR7Zm9ybWF0RHVyYXRpb24oCiAgICAgICAgICAgICAgICAgIHJhcHBvcnQudHJhaW5pbmdzZGF1ZXIKICAgICAgICAgICAgICAgICl9PGJyLz4gYDsKCiAgICAgICAgICAgICAgYW1vdW50ICs9IHJldHVyblRyYWluaW5nRHVyYXRpb25JbkhvdXJzKHJhcHBvcnQudHJhaW5pbmdzZGF1ZXIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIHBvc2l0aW9ucy5wdXNoKHsKICAgICAgICAgICAgYW1vdW50OiBhbW91bnQsCiAgICAgICAgICAgIHRheF9pZDogcHJvZHVjdC50YXhpZCwKICAgICAgICAgICAgdGV4dDogcG9zaXRpb25UZXh0LAogICAgICAgICAgICB1bml0X3ByaWNlOiBwcm9kdWN0LnNhbGVwcmljZSwKICAgICAgICAgICAgYXJ0aWNsZV9pZDogcHJvZHVjdC5iZXhpb0lkLAogICAgICAgICAgICB0eXBlOiAiS2JQb3NpdGlvbkFydGljbGUiLAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY29uc29sZS5sb2coeyBwb3NpdGlvbnMgfSk7CiAgICBjb25zdCByZXFCb2R5ID0gewogICAgICAvLyB0aXRsZTogYCR7aW52b2ljZVRpdGxlRGF0ZX0tJHtncm91cC5rdW5kZS52b3JuYW1lfSAke2dyb3VwLmt1bmRlLm5hbWV9YCwKICAgICAgdGl0bGU6IGAke2ludm9pY2VUaXRsZURhdGV9YCwKICAgICAgY29udGFjdF9pZDogYmV4aW9Qcm9maWxlID09PSAibm9wIiA/IDIgOiBncm91cC5rdW5kZS5iZXhpb0lkLAogICAgICB1c2VyX2lkOiBiZXhpb1Byb2ZpbGUgPT09ICJub3AiID8gMSA6IDksCiAgICAgIGJhbmtfYWNjb3VudF9pZDogNywKICAgICAgaGVhZGVyOgogICAgICAgICJTZWhyIGdlZWhydGUgRGFtZW4gdW5kIEhlcnJlbjxiciAvPjxiciAvPldpciBlcmxhdWJlbiB1bnMsIElobmVuIHdpZSBmb2xndCBpbiBSZWNobnVuZyB6dSBzdGVsbGVuOiIsCiAgICAgIGZvb3RlcjoKICAgICAgICAiUFJJVkFUTEVLVElPTkVOOjxiciAvPkJlaSBWZXJoaW5kZXJ1bmcgYml0dGVuIHdpciB1bSBlaW5lIHNjaHJpZnRsaWNoZSBBYnNhZ2UgcGVyIE1haWwgKGtlaW5lIFNNUyEpIG1pbmRlc3RlbnMgMjRoIGltIHZvcmF1cyBhbjogc2Nob29sQGpjc2NoZXJyZXIuY29tLiBXaXJkIGRpZXMgbmljaHQgYmVyJnV1bWw7Y2tzaWNodGlndCwgd2lyZCBkZXIgZ2VidWNodGUgVGVubmlzdW50ZXJyaWNodCBpbiBSZWNobnVuZyBnZXN0ZWxsdC4gPGJyIC8+PGJyIC8+PGJyIC8+RnJldW5kbGljaGUgR3ImdXVtbDtzc2UiLAogICAgICBtd3N0X3R5cGU6IDIsCiAgICAgIG13c3RfaXNfbmV0OiB0cnVlLAogICAgICBzaG93X3Bvc2l0aW9uX3RheGVzOiBmYWxzZSwKICAgICAgaXNfdmFsaWRfZnJvbTogZGF5anMoKS5mb3JtYXQoIllZWVktTU0tREQiKSwKICAgICAgaXNfdmFsaWRfdG86IGRheWpzKCkuZW5kT2YoIm1vbnRoIikuZm9ybWF0KCJZWVlZLU1NLUREIiksCiAgICAgIHBvc2l0aW9ucywKICAgIH07CiAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXFCb2R5LCBudWxsLCAyKSk7CgogICAgY29uc3Qgc2VhcmNoSW52b2ljZSA9IGFzeW5jICh0aXRsZTogc3RyaW5nKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgc2VhcmNoVXJsID0gYCR7YmV4aW9Vcmx9L2tiX2ludm9pY2Uvc2VhcmNoYDsKICAgICAgICBjb25zdCBzZWFyY2hCb2R5ID0gWwogICAgICAgICAgewogICAgICAgICAgICBmaWVsZDogInRpdGxlIiwKICAgICAgICAgICAgdmFsdWU6IHRpdGxlLAogICAgICAgICAgICBjcml0ZXJpYTogIj0iLAogICAgICAgICAgfSwKICAgICAgICBdOwogICAgICAgIGxldCByZXMgPSBhd2FpdCBwb3N0UmVxdWVzdChzZWFyY2hVcmwsIHNlYXJjaEJvZHkpOwogICAgICAgIHJlcyA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICByZXR1cm4gcmVzLmxlbmd0aCA+IDAgPyByZXNbMF0gOiBudWxsOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHNlYXJjaGluZyBmb3IgaW52b2ljZToiLCBlKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfTsKCiAgICB0cnkgewogICAgICBsZXQgcmVzID0gYXdhaXQgcG9zdFJlcXVlc3QoYCR7YmV4aW9Vcmx9L2tiX2ludm9pY2VgLCByZXFCb2R5KTsKICAgICAgcmVzID0gSlNPTi5wYXJzZShyZXMpOwoKICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoCiAgICAgICAgZ3JvdXAucmFwcG9ydHMubWFwKGFzeW5jIChyYXBwb3J0KSA9PiB7CiAgICAgICAgICBhd2FpdCB1cGRhdGVSYXBwb3J0V2l0aEludm9pY2VJZCgKICAgICAgICAgICAgcmFwcG9ydC5pZCwKICAgICAgICAgICAgYCR7cmVzLmRvY3VtZW50X25yfSAtICR7cmVzLmlkfWAKICAgICAgICAgICk7CiAgICAgICAgfSkKICAgICAgKTsKCiAgICAgIGNvbnNvbGUubG9nKHsgcmVzIH0pOwogICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXMsIHJlcWJvZHk6IHJlcUJvZHkgfSBhcyBhbnk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGlmIChlLnN0YXR1c0NvZGUgPT09IDQyOSkgewogICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciBpcyA0MjkiKTsKICAgICAgICBjb25zdCBleGlzdGluZ0ludm9pY2UgPSBhd2FpdCBzZWFyY2hJbnZvaWNlKHJlcUJvZHkudGl0bGUpOwogICAgICAgIGlmIChleGlzdGluZ0ludm9pY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJJbnZvaWNlIGFscmVhZHkgZXhpc3RzOiIsIGV4aXN0aW5nSW52b2ljZSk7CiAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCgKICAgICAgICAgICAgZ3JvdXAucmFwcG9ydHMubWFwKGFzeW5jIChyYXBwb3J0KSA9PiB7CiAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlUmFwcG9ydFdpdGhJbnZvaWNlSWQoCiAgICAgICAgICAgICAgICByYXBwb3J0LmlkLAogICAgICAgICAgICAgICAgYCR7ZXhpc3RpbmdJbnZvaWNlLmRvY3VtZW50X25yfSAtICR7ZXhpc3RpbmdJbnZvaWNlLmlkfWAKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9KQogICAgICAgICAgKTsKICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGV4aXN0aW5nSW52b2ljZSwgcmVxYm9keTogcmVxQm9keSB9IGFzIGFueTsKICAgICAgICB9CgogICAgICAgIC8vIHJldHJ5IGV2ZXJ5IDMgc2Vjb25kcyB1bnRpbCBpdCB3b3JrcwogICAgICAgIGNvbnN0IGludGVydmFsSWQgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zb2xlLmxvZygidHJ5aW5nIG9uZSBtb3JlIHRpbWUiKTsKCiAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBwb3N0UmVxdWVzdChgJHtiZXhpb1VybH0va2JfaW52b2ljZWAsIHJlcUJvZHkpOwoKICAgICAgICAgICAgcmVzID0gSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh7IHJlcyB9KTsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsKCiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKAogICAgICAgICAgICAgIGdyb3VwLnJhcHBvcnRzLm1hcChhc3luYyAocmFwcG9ydCkgPT4gewogICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlUmFwcG9ydFdpdGhJbnZvaWNlSWQoCiAgICAgICAgICAgICAgICAgIHJhcHBvcnQuaWQsCiAgICAgICAgICAgICAgICAgIGAke3Jlcy5kb2N1bWVudF9ucn0gLSAke3Jlcy5pZH1gCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlcywgcmVxYm9keTogcmVxQm9keSB9IGFzIGFueTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coImVycm9yIGlzIDQyOSBpbiByZXRyeSIpOwogICAgICAgICAgICBpZiAoZS5zdGF0dXNDb2RlICE9PSA0MjkpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShlLCBudWxsLCAyKSk7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsKICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGUsIHJlcWJvZHk6IHJlcUJvZHkgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIDMwMDApOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGUsIG51bGwsIDIpKTsKICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGUsIHJlcWJvZHk6IHJlcUJvZHkgfTsKICAgICAgfQogICAgfQogIH0KCiAgLy8gTWFwIHRvIGBwb3N0IC9kZWxldGUtYmV4aW8taW52b2ljZWAKICBAcG9zdCgiL2RlbGV0ZS1iZXhpby1pbnZvaWNlIikKICAvLyBAcmVzcG9uc2UoMjAwLCBQSU5HX1JFU1BPTlNFKQogIGFzeW5jIGRlbGV0ZUJleGlvSW52b2ljZShAcmVxdWVzdEJvZHkoKSBCZXhpb0JvZHk6IGFueSk6IFByb21pc2U8b2JqZWN0PiB7CiAgICBjb25zb2xlLmxvZygiaW4gcmVxdWVzdCIpOwogICAgY29uc29sZS5sb2coeyBCZXhpb0JvZHkgfSk7CiAgICAvLyBSZXBseSB3aXRoIGEgZ3JlZXRpbmcsIHRoZSBjdXJyZW50IHRpbWUsIHRoZSB1cmwsIGFuZCByZXF1ZXN0IGhlYWRlcnMKICAgIGNvbnN0IHsgaW52b2ljZUlkIH0gPSBCZXhpb0JvZHk7CgogICAgdHJ5IHsKICAgICAgbGV0IHJlcyA9IGF3YWl0IGRlbGV0ZVJlcXVlc3QoYCR7YmV4aW9Vcmx9L2tiX2ludm9pY2UvJHtpbnZvaWNlSWR9YCk7CiAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgIHJldHVybiByZXM7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGlmIChlLnN0YXR1c0NvZGUgPT09IDQyOSkgewogICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciBpcyA0MjkiKTsKICAgICAgICAvLyByZXRyeSBldmVyeSAzIHNlY29uZHMgdW50aWwgaXQgd29ya3MKICAgICAgICBjb25zdCBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc29sZS5sb2coInRyeWluZyBvbmUgbW9yZSB0aW1lIik7CgogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgZGVsZXRlUmVxdWVzdCgKICAgICAgICAgICAgICBgJHtiZXhpb1VybH0va2JfaW52b2ljZS8ke2ludm9pY2VJZH1gCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXMgPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHsgcmVzIH0pOwogICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsSWQpOwoKICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coImVycm9yIGlzIDQyOSBpbiByZXRyeSIpOwogICAgICAgICAgICBpZiAoZS5zdGF0dXNDb2RlICE9PSA0MjkpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShlLCBudWxsLCAyKSk7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsKICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGUgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIDMwMDApOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGUsIG51bGwsIDIpKTsKICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGUgfTsKICAgICAgfQogICAgfQogIH0KCiAgQGdldCgiL2JleGlvLWluZm8iLCBiZXhpb1NwZWMpCiAgYXN5bmMgZ2V0QmV4aW9JbmZvKCk6IFByb21pc2U8b2JqZWN0PiB7CiAgICB0cnkgewogICAgICBjb25zdCBiZXhpb1Byb2ZpbGUgPSBwcm9jZXNzLmVudlsiQkVYSU9fUFJPRklMRSJdIHx8ICJkZWZhdWx0IjsKICAgICAgY29uc3QgYmV4aW9BcGlVcmwgPSBwcm9jZXNzLmVudlsiQkVYSU9fQVBJX1VSTCJdIHx8ICJkZWZhdWx0IjsKICAgICAgcmV0dXJuIHsKICAgICAgICBiZXhpb1Byb2ZpbGUsCiAgICAgICAgYmV4aW9BcGlVcmwsCiAgICAgIH07CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB0aHJvdyBuZXcgSHR0cEVycm9yc1tlLnN0YXR1c0NvZGVdKCIiKTsKICAgIH0KICB9Cn0K
      - name: ping2
        content: aW1wb3J0IHtpbmplY3R9IGZyb20gJ0Bsb29wYmFjay9jb3JlJzsKaW1wb3J0IHsKICBSZXF1ZXN0LAogIFJlc3RCaW5kaW5ncywKICBnZXQsCiAgcmVzcG9uc2UsCiAgUmVzcG9uc2VPYmplY3QsCn0gZnJvbSAnQGxvb3BiYWNrL3Jlc3QnOwoKLyoqCiAqIE9wZW5BUEkgcmVzcG9uc2UgZm9yIHBpbmcyKCkKICovCmNvbnN0IFBJTkcyX1JFU1BPTlNFOiBSZXNwb25zZU9iamVjdCA9IHsKICBkZXNjcmlwdGlvbjogJ1BpbmcyIFJlc3BvbnNlJywKICBjb250ZW50OiB7CiAgICAnYXBwbGljYXRpb24vanNvbic6IHsKICAgICAgc2NoZW1hOiB7CiAgICAgICAgdHlwZTogJ29iamVjdCcsCiAgICAgICAgdGl0bGU6ICdQaW5nMlJlc3BvbnNlJywKICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICBncmVldGluZzoge3R5cGU6ICdzdHJpbmcnfSwKICAgICAgICAgIGRhdGU6IHt0eXBlOiAnc3RyaW5nJ30sCiAgICAgICAgICB1cmw6IHt0eXBlOiAnc3RyaW5nJ30sCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIHR5cGU6ICdvYmplY3QnLAogICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6IHt0eXBlOiAnc3RyaW5nJ30sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiB0cnVlLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICB9LAogICAgfSwKICB9LAp9OwoKLyoqCiAqIEEgc2ltcGxlIGNvbnRyb2xsZXIgdG8gYm91bmNlIGJhY2sgaHR0cCByZXF1ZXN0cwogKi8KZXhwb3J0IGNsYXNzIFBpbmcyQ29udHJvbGxlciB7CiAgY29uc3RydWN0b3IoQGluamVjdChSZXN0QmluZGluZ3MuSHR0cC5SRVFVRVNUKSBwcml2YXRlIHJlcTogUmVxdWVzdCkge30KCiAgLy8gTWFwIHRvIGBHRVQgL3BpbmcyYAogIEBnZXQoJy9waW5nMicpCiAgQHJlc3BvbnNlKDIwMCwgUElORzJfUkVTUE9OU0UpCiAgcGluZzIoKTogb2JqZWN0IHsKICAgIC8vIFJlcGx5IHdpdGggYSBncmVldGluZywgdGhlIGN1cnJlbnQgdGltZSwgdGhlIHVybCwgYW5kIHJlcXVlc3QgaGVhZGVycwogICAgcmV0dXJuIHsKICAgICAgZ3JlZXRpbmc6ICdIZWxsbyBmcm9tIGdyYXBwbGUnLAogICAgICBkYXRlOiBuZXcgRGF0ZSgpLAogICAgICB1cmw6IHRoaXMucmVxLnVybCwKICAgICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5yZXEuaGVhZGVycyksCiAgICB9OwogIH0KfQo=
    prerelationpatches:
      - name: install
        content: ZWNobyAiaW5zdGFsbGluZyBkZXBlbmRlbmNpZXMiCm5wbSBpIGRheWpzCg==
      - name: addAdditionalRelationsToTrainer
        content: IyEvYmluL2Jhc2gKCmVjaG8gImVuYWJsaW5nIGhhc01hbnlUaHJvdWdoIHdpdGggc2FtZSB0YWJsZSAmIG5vLXBrIHJlZmVyZW5jZS4uLiIKCiMgdXBkYXRlIHRyYWluZXIgbW9kZWwgdG8gYWRkIHJlbGF0aW9ucwoKYWRkVHlwZXNBdD0iJChncmVwIC1uICd0eXBlOiBSZWxhdGlvblR5cGUuaGFzTWFueTsnIG5vZGVfbW9kdWxlcy9AbG9vcGJhY2svcmVwb3NpdG9yeS9kaXN0L3JlbGF0aW9ucy9yZWxhdGlvbi50eXBlcy5kLnRzIHwgY3V0IC1kIDogLWYgMSkiCmFkZFR5cGVzQXQ9JCgoYWRkVHlwZXNBdCsxKSkKc2VkIC1pICIkYWRkVHlwZXNBdCBpIGN1c3RvbVJlZmVyZW5jZUtleVRvPzogc3RyaW5nOyBcbiBjdXN0b21SZWZlcmVuY2VLZXlGcm9tPzogc3RyaW5nOyIgbm9kZV9tb2R1bGVzL0Bsb29wYmFjay9yZXBvc2l0b3J5L2Rpc3QvcmVsYXRpb25zL3JlbGF0aW9uLnR5cGVzLmQudHMKCnNlZCAtaSAicyNjb25zdCB0YXJnZXRQcmltYXJ5S2V5ID0gcmVsYXRpb25NZXRhLmtleVRvOyNjb25zdCB0YXJnZXRQcmltYXJ5S2V5ID0gcmVsYXRpb25NZXRhLmN1c3RvbVJlZmVyZW5jZUtleVRvIHx8IHJlbGF0aW9uTWV0YS5rZXlUbzsjZyIgbm9kZV9tb2R1bGVzL0Bsb29wYmFjay9yZXBvc2l0b3J5L2Rpc3QvcmVsYXRpb25zL2hhcy1tYW55L2hhcy1tYW55LXRocm91Z2guaGVscGVycy5qcwpzZWQgLWkgInMjY29uc3QgdGFyZ2V0SWQgPSByZWxhdGlvbk1ldGEua2V5VG87I2NvbnN0IHRhcmdldElkID0gcmVsYXRpb25NZXRhLmN1c3RvbVJlZmVyZW5jZUtleVRvIHx8IHJlbGF0aW9uTWV0YS5rZXlUbzsjZyIgbm9kZV9tb2R1bGVzL0Bsb29wYmFjay9yZXBvc2l0b3J5L2Rpc3QvcmVsYXRpb25zL2hhcy1tYW55L2hhcy1tYW55LXRocm91Z2guaGVscGVycy5qcwoKCmFkZElmQ29uZGl0aW9uQXQ9IiQoZ3JlcCAtbiAnY29uc3QgdGFyZ2V0UHJpbWFyeUtleSA9IChfZiA9IHJlbGF0aW9uTWV0YS5rZXlUbyknIG5vZGVfbW9kdWxlcy9AbG9vcGJhY2svcmVwb3NpdG9yeS9kaXN0L3JlbGF0aW9ucy9oYXMtbWFueS9oYXMtbWFueS10aHJvdWdoLmhlbHBlcnMuanMgfCBjdXQgLWQgOiAtZiAxKSIKYWRkSWZDb25kaXRpb25BdD0kKChhZGRJZkNvbmRpdGlvbkF0KzEpKQpzZWQgLWkgIiRhZGRJZkNvbmRpdGlvbkF0IGkgaWYgKHJlbGF0aW9uTWV0YS5jdXN0b21SZWZlcmVuY2VLZXlUbykgeyBcbiB0YXJnZXRQcmltYXJ5S2V5ID0gcmVsYXRpb25NZXRhLmN1c3RvbVJlZmVyZW5jZUtleVRvOyBcbn0iIG5vZGVfbW9kdWxlcy9AbG9vcGJhY2svcmVwb3NpdG9yeS9kaXN0L3JlbGF0aW9ucy9oYXMtbWFueS9oYXMtbWFueS10aHJvdWdoLmhlbHBlcnMuanMKCnNlZCAtaSAicyNjb25zdCB0YXJnZXRQcmltYXJ5S2V5ID0gKF9mID0gcmVsYXRpb25NZXRhLmtleVRvKSNsZXQgdGFyZ2V0UHJpbWFyeUtleSA9IChfZiA9IHJlbGF0aW9uTWV0YS5rZXlUbykjZyIgbm9kZV9tb2R1bGVzL0Bsb29wYmFjay9yZXBvc2l0b3J5L2Rpc3QvcmVsYXRpb25zL2hhcy1tYW55L2hhcy1tYW55LXRocm91Z2guaGVscGVycy5qcwoKc2VkIC1pICJzI2tleUZyb206IHJlbGF0aW9uTWV0YS5rZXlGcm9tLCNrZXlGcm9tOiByZWxhdGlvbk1ldGEuY3VzdG9tUmVmZXJlbmNlS2V5RnJvbSB8fCByZWxhdGlvbk1ldGEua2V5RnJvbSwjZyIgbm9kZV9tb2R1bGVzL0Bsb29wYmFjay9yZXBvc2l0b3J5L2Rpc3QvcmVsYXRpb25zL2hhcy1tYW55L2hhcy1tYW55LXRocm91Z2guaGVscGVycy5qcwoKZWNobyAiLS0tIgo=
    postpatches:
      - name: addAdditionalRelationsToTrainer
        content: IyEvYmluL2Jhc2gKZWNobyAiQ3JlYXRpbmcgZXh0cmEgcmVsYXRpb25zLi4uIgoKIyB1cGRhdGUgdHJhaW5lciBtb2RlbCB0byBhZGQgcmVsYXRpb25zCgpkZWxldGV0ZXh0dW50aWwgKCkgewogICAgSU5GSUxFPSQxCiAgICBGUk9NVEVYVD0kMgogICAgVE9URVhUPSQzCiAgICBERUxFVEVGUk9NPSQoKCQoZ3JlcCAiJHtUT1RFWFR9IiBzcmMvbW9kZWxzL3RyYWluZXIubW9kZWwudHMgLW4gfCBjdXQgLWQgOiAtZiAxKS0kKGdyZXAgLUIxMCAiJHtUT1RFWFR9IiBzcmMvbW9kZWxzL3RyYWluZXIubW9kZWwudHMgfCBncmVwICIke0ZST01URVhUfSIgLUExMCB8IHdjIC1sKSkpCiAgICBERUxFVEVVTlRJTD0kKGdyZXAgIiR7VE9URVhUfSIgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzIC1uIHwgY3V0IC1kIDogLWYgMSkKICAgIGlmIFsgJHtERUxFVEVGUk9NfSAtZ3QgMCBdICYmIFsgJHtERUxFVEVVTlRJTH0gLWd0IDAgXTsgdGhlbgogICAgICAgIHNlZCAtaSAiJHtERUxFVEVGUk9NfSIsIiR7REVMRVRFVU5USUx9Iid7ZDt9JyBzcmMvbW9kZWxzL3RyYWluZXIubW9kZWwudHMKICAgIGVsc2UKICAgICAgICBlY2hvICJub3QgZGVsZXRlZCBhcyBvbmUgb2YgdGhlIHZhcmlhYmxlcyBpcyBlbXB0eS4iCiAgICBmaQp9CgpkZWxldGV0ZXh0dW50aWwgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzICJAcHJvcGVydHkoeyIgInN1bW1lclJhdGVBZnRlcklkPzogbnVtYmVyOyIKZGVsZXRldGV4dHVudGlsIHNyYy9tb2RlbHMvdHJhaW5lci5tb2RlbC50cyAiQHByb3BlcnR5KHsiICJzdW1tZXJSYXRlQmVmb3JlSWQ/OiBudW1iZXI7IgpkZWxldGV0ZXh0dW50aWwgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzICJAcHJvcGVydHkoeyIgIndpbnRlclJhdGVBZnRlcklkPzogbnVtYmVyOyIKZGVsZXRldGV4dHVudGlsIHNyYy9tb2RlbHMvdHJhaW5lci5tb2RlbC50cyAiQHByb3BlcnR5KHsiICJ3aW50ZXJSYXRlQmVmb3JlSWQ/OiBudW1iZXI7IgpkZWxldGV0ZXh0dW50aWwgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzICJAcHJvcGVydHkoeyIgImNsdWJSYXRlSWQ/OiBudW1iZXI7IgoKYWRkQXRNb2RlbD0iJChncmVwIC1uICdTdW1tZXJSYXRlQmVmb3JlSWQ6IG51bWJlcjsnIHNyYy9tb2RlbHMvdHJhaW5lci5tb2RlbC50cyB8IGN1dCAtZCA6IC1mIDEpIgphZGRBdE1vZGVsPSQoKGFkZEF0TW9kZWwrMSkpCgpzZWQgLWkgIiRhZGRBdE1vZGVsIGkgQGJlbG9uZ3NUbygoKSA9PiBQcm9kdWN0LCB7bmFtZTogJ1N1bW1lclJhdGVBZnRlcid9KSBcbiBTdW1tZXJSYXRlQWZ0ZXJJZDogbnVtYmVyOyIgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzCmFkZEF0TW9kZWw9JCgoYWRkQXRNb2RlbCsyKSkKCnNlZCAtaSAiJGFkZEF0TW9kZWwgaSBAYmVsb25nc1RvKCgpID0+IFByb2R1Y3QsIHtuYW1lOiAnV2ludGVyUmF0ZUJlZm9yZSd9KSBcbiBXaW50ZXJSYXRlQmVmb3JlSWQ6IG51bWJlcjsiIHNyYy9tb2RlbHMvdHJhaW5lci5tb2RlbC50cwphZGRBdE1vZGVsPSQoKGFkZEF0TW9kZWwrMikpCgpzZWQgLWkgIiRhZGRBdE1vZGVsIGkgQGJlbG9uZ3NUbygoKSA9PiBQcm9kdWN0LCB7bmFtZTogJ1dpbnRlclJhdGVBZnRlcid9KSBcbiBXaW50ZXJSYXRlQWZ0ZXJJZDogbnVtYmVyOyIgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzCmFkZEF0TW9kZWw9JCgoYWRkQXRNb2RlbCsyKSkKCnNlZCAtaSAiJGFkZEF0TW9kZWwgaSBAYmVsb25nc1RvKCgpID0+IFByb2R1Y3QsIHtuYW1lOiAnQ2x1YlJhdGUnfSkgXG4gQ2x1YlJhdGVJZDogbnVtYmVyOyIgc3JjL21vZGVscy90cmFpbmVyLm1vZGVsLnRzCgojIHVwZGF0ZSB0cmFpbmVyIHJlcG9zaXRvcnkgdG8gYWRkIHJlbGF0aW9ucwoKYWRkQXRSZXBvc2l0b3J5PSIkKGdyZXAgLW4gJ3JlYWRvbmx5IFN1bW1lclJhdGVCZWZvcmUnIHNyYy9yZXBvc2l0b3JpZXMvdHJhaW5lci5yZXBvc2l0b3J5LnRzIHwgY3V0IC1kIDogLWYgMSkiCmFkZEF0UmVwb3NpdG9yeT0kKChhZGRBdFJlcG9zaXRvcnkrMSkpCgpzZWQgLWkgIiRhZGRBdFJlcG9zaXRvcnkgaSBwdWJsaWMgcmVhZG9ubHkgU3VtbWVyUmF0ZUFmdGVyOiBCZWxvbmdzVG9BY2Nlc3NvcjxQcm9kdWN0LCB0eXBlb2YgVHJhaW5lci5wcm90b3R5cGUuaWQ+OyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKYWRkQXRSZXBvc2l0b3J5PSQoKGFkZEF0UmVwb3NpdG9yeSsxKSkKCnNlZCAtaSAiJGFkZEF0UmVwb3NpdG9yeSBpIHB1YmxpYyByZWFkb25seSBXaW50ZXJSYXRlQmVmb3JlOiBCZWxvbmdzVG9BY2Nlc3NvcjxQcm9kdWN0LCB0eXBlb2YgVHJhaW5lci5wcm90b3R5cGUuaWQ+OyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKYWRkQXRSZXBvc2l0b3J5PSQoKGFkZEF0UmVwb3NpdG9yeSsxKSkKCnNlZCAtaSAiJGFkZEF0UmVwb3NpdG9yeSBpIHB1YmxpYyByZWFkb25seSBXaW50ZXJSYXRlQWZ0ZXI6IEJlbG9uZ3NUb0FjY2Vzc29yPFByb2R1Y3QsIHR5cGVvZiBUcmFpbmVyLnByb3RvdHlwZS5pZD47IiBzcmMvcmVwb3NpdG9yaWVzL3RyYWluZXIucmVwb3NpdG9yeS50cwphZGRBdFJlcG9zaXRvcnk9JCgoYWRkQXRSZXBvc2l0b3J5KzEpKQoKc2VkIC1pICIkYWRkQXRSZXBvc2l0b3J5IGkgcHVibGljIHJlYWRvbmx5IENsdWJSYXRlOiBCZWxvbmdzVG9BY2Nlc3NvcjxQcm9kdWN0LCB0eXBlb2YgVHJhaW5lci5wcm90b3R5cGUuaWQ+OyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKCmFkZEF0UmVwb3NpdG9yeT0iJChncmVwIC1uICd0aGlzLnJlZ2lzdGVySW5jbHVzaW9uUmVzb2x2ZXInIHNyYy9yZXBvc2l0b3JpZXMvdHJhaW5lci5yZXBvc2l0b3J5LnRzIHwgY3V0IC1kIDogLWYgMSkiCmFkZEF0UmVwb3NpdG9yeT0kKChhZGRBdFJlcG9zaXRvcnkrMSkpCgpzZWQgLWkgIiRhZGRBdFJlcG9zaXRvcnkgaSB0aGlzLlN1bW1lclJhdGVBZnRlciA9IHRoaXMuY3JlYXRlQmVsb25nc1RvQWNjZXNzb3JGb3IoJ1N1bW1lclJhdGVBZnRlcicsIHByb2R1Y3RSZXBvc2l0b3J5R2V0dGVyLCk7IFxuIHRoaXMucmVnaXN0ZXJJbmNsdXNpb25SZXNvbHZlcignU3VtbWVyUmF0ZUFmdGVyJywgdGhpcy5TdW1tZXJSYXRlQWZ0ZXIuaW5jbHVzaW9uUmVzb2x2ZXIpOyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKCmFkZEF0UmVwb3NpdG9yeT0kKChhZGRBdFJlcG9zaXRvcnkrMSkpCnNlZCAtaSAiJGFkZEF0UmVwb3NpdG9yeSBpIHRoaXMuV2ludGVyUmF0ZUJlZm9yZSA9IHRoaXMuY3JlYXRlQmVsb25nc1RvQWNjZXNzb3JGb3IoJ1dpbnRlclJhdGVCZWZvcmUnLCBwcm9kdWN0UmVwb3NpdG9yeUdldHRlciwpOyBcbiB0aGlzLnJlZ2lzdGVySW5jbHVzaW9uUmVzb2x2ZXIoJ1dpbnRlclJhdGVCZWZvcmUnLCB0aGlzLldpbnRlclJhdGVCZWZvcmUuaW5jbHVzaW9uUmVzb2x2ZXIpOyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKCmFkZEF0UmVwb3NpdG9yeT0kKChhZGRBdFJlcG9zaXRvcnkrMSkpCnNlZCAtaSAiJGFkZEF0UmVwb3NpdG9yeSBpIHRoaXMuV2ludGVyUmF0ZUFmdGVyID0gdGhpcy5jcmVhdGVCZWxvbmdzVG9BY2Nlc3NvckZvcignV2ludGVyUmF0ZUFmdGVyJywgcHJvZHVjdFJlcG9zaXRvcnlHZXR0ZXIsKTsgXG4gdGhpcy5yZWdpc3RlckluY2x1c2lvblJlc29sdmVyKCdXaW50ZXJSYXRlQWZ0ZXInLCB0aGlzLldpbnRlclJhdGVBZnRlci5pbmNsdXNpb25SZXNvbHZlcik7IiBzcmMvcmVwb3NpdG9yaWVzL3RyYWluZXIucmVwb3NpdG9yeS50cwoKYWRkQXRSZXBvc2l0b3J5PSQoKGFkZEF0UmVwb3NpdG9yeSsxKSkKc2VkIC1pICIkYWRkQXRSZXBvc2l0b3J5IGkgdGhpcy5DbHViUmF0ZSA9IHRoaXMuY3JlYXRlQmVsb25nc1RvQWNjZXNzb3JGb3IoJ0NsdWJSYXRlJywgcHJvZHVjdFJlcG9zaXRvcnlHZXR0ZXIsKTsgXG4gdGhpcy5yZWdpc3RlckluY2x1c2lvblJlc29sdmVyKCdDbHViUmF0ZScsIHRoaXMuQ2x1YlJhdGUuaW5jbHVzaW9uUmVzb2x2ZXIpOyIgc3JjL3JlcG9zaXRvcmllcy90cmFpbmVyLnJlcG9zaXRvcnkudHMKCiMgdXBkYXRlIGNvbnRyb2xsZXIgdG8gYWRkIHJlbGF0aW9ucwoKc2VkIC1pICJzI3JldHVybiB0aGlzLnRyYWluZXJSZXBvc2l0b3J5LlN1bW1lclJhdGVCZWZvcmUoaWQpOyNyZXR1cm4gWyBcbiB0aGlzLnRyYWluZXJSZXBvc2l0b3J5LlN1bW1lclJhdGVCZWZvcmUoaWQpLCBcbiB0aGlzLnRyYWluZXJSZXBvc2l0b3J5LlN1bW1lclJhdGVBZnRlcihpZCksIFxuIHRoaXMudHJhaW5lclJlcG9zaXRvcnkuV2ludGVyUmF0ZUJlZm9yZShpZCksIFxuIHRoaXMudHJhaW5lclJlcG9zaXRvcnkuV2ludGVyUmF0ZUFmdGVyKGlkKSwgXG4gdGhpcy50cmFpbmVyUmVwb3NpdG9yeS5DbHViUmF0ZShpZCkgXG5dOyNnIiBzcmMvY29udHJvbGxlcnMvdHJhaW5lci1wcm9kdWN0LmNvbnRyb2xsZXIudHMKc2VkIC1pICJzI1Byb21pc2U8UHJvZHVjdD4jUHJvbWlzZTxQcm9taXNlPFByb2R1Y3Q+W10+I2ciIHNyYy9jb250cm9sbGVycy90cmFpbmVyLXByb2R1Y3QuY29udHJvbGxlci50cwoKZWNobyAiLS0tIgo=
    injections: []
  gruim:
    uiimagetag: "0.2.9"
    autoscaling:
      minReplicas: 3
    ssl: true
    sslissuer: letsencrypt-grapple-demo
    style: '{"colors":{"primary":{"DEFAULT":"#004a99","fg":"#ffffff"},"accent":{"DEFAULT":"#fa7252","fg":"#ffffff"}}}'
    config: '{"global":{"list-size":10,"field-properties":{"id":{"readonly":false}}, "weekStart": 1},"schema":{"Trainer":{"field-order":["id","vorname","name","email","aktiv","SummerRateBefore","SummerRateAfter","WinterRateBefore","WinterRateAfter","ClubRate","notizen","token"]},"Kunde":{"field-order":["id","bexioId","name","vorname","mail","ort","plz","strasse","land"]},"Gruppe":{"field-order":["id","gruppenname","beschreibung","gruppentyp","notizen"]},"Product":{"field-order":["id","bexioId","interncode","internname","interndescription","saleprice","taxid","articlegroupid"]},"Rapport":{"field-order":["id","datum","invoicedIn","trainer","kunde","gruppe","platz","startzeit","trainingsdauer","trainingType","nachholtermin","probetraining","archived","notizen"]}}}'
    additionalpackages: "svelte-fullcalendar@2.0.0-beta.0 @fullcalendar/common@5.10.1 @fullcalendar/core@5.10.1 @fullcalendar/daygrid@5.10.1 @fullcalendar/interaction@5.10.1 @fullcalendar/timegrid@5.10.1 dayjs@1.11.2"
    custommodules:
      - name: singleDay
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IEZ1bGxDYWxlbmRhciwgeyBDYWxlbmRhck9wdGlvbnMsIFZpZXdBcGkgfSBmcm9tICJzdmVsdGUtZnVsbGNhbGVuZGFyIjsKICBpbXBvcnQgdGltZWdyaWRQbHVnaW4gZnJvbSAiQGZ1bGxjYWxlbmRhci90aW1lZ3JpZCI7CiAgaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKICBpbXBvcnQgaW50ZXJhY3Rpb25QbHVnaW4gZnJvbSAiQGZ1bGxjYWxlbmRhci9pbnRlcmFjdGlvbiI7IC8vIGZvciBzZWxlY3RhYmxlCiAgaW1wb3J0IHsgY3JlYXRlRXZlbnREaXNwYXRjaGVyLCBvbk1vdW50IH0gZnJvbSAic3ZlbHRlIjsKCiAgY29uc3QgZGlzcGF0Y2ggPSBjcmVhdGVFdmVudERpc3BhdGNoZXIoKTsKCiAgbGV0IGV2ZW50R3VpZCA9IDA7CiAgbGV0IGlubmVyV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsKCiAgbGV0IHRyYWluZXJzOiBhbnkgPSBbXTsKCiAgb25Nb3VudChhc3luYyBmdW5jdGlvbiAoKSB7CiAgICBsZXQgcmFwcG9ydHMgPSBhd2FpdCBmZXRjaCgKICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvdHJhaW5lcnM/ZmlsdGVyPXsib3JkZXIiOiJpZCIsIndoZXJlIjp7ImFrdGl2Ijp0cnVlfX1gCiAgICApOwogICAgdHJhaW5lcnMgPSBhd2FpdCByYXBwb3J0cy5qc29uKCk7CiAgfSk7CgogIGV4cG9ydCBsZXQgcmFwb3J0czogewogICAgZGF0dW06IGFueTsKICAgIHN0YXJ0emVpdDogYW55OwogICAgdHJhaW5pbmdzZGF1ZXI6IGFueTsKICAgIGt1bmRlOiBhbnk7CiAgICBncnVwcGU6IGFueTsKICAgIHBsYXR6OiBhbnk7CiAgICB0cmFpbmVyOiBhbnk7CiAgICBub3RpemVuPzogc3RyaW5nOwogICAga3VuZGVzPzogYW55OwogIH1bXSA9IFtdOwogIGV4cG9ydCBsZXQgc2VsZWN0ZWREYXRlID0gIiI7CiAgZXhwb3J0IGxldCBzZWxlY3RlZFRyYWluZXI6IGFueTsKCiAgbGV0IGNhbGVuZGFyUmVmOiBhbnk7CiAgZnVuY3Rpb24gc2V0KCkgewogICAgaWYgKGNhbGVuZGFyUmVmKSB7CiAgICAgIGNvbnN0IGNhbGVuZGFyQXBpID0gY2FsZW5kYXJSZWYuZ2V0QVBJKCk7CiAgICAgIGNhbGVuZGFyQXBpLmdvdG9EYXRlKHNlbGVjdGVkRGF0ZSk7CiAgICB9CiAgfQoKICAkOiB7CiAgICBsZXQgc2hvd2VkRGF0ZSA9IHNlbGVjdGVkRGF0ZTsKCiAgICBzZXQoKTsKICAgIGNvbnNvbGUubG9nKHNob3dlZERhdGUpOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlRXZlbnRJZCgpIHsKICAgIHJldHVybiBTdHJpbmcoZXZlbnRHdWlkKyspOwogIH0KICBsZXQgb3B0aW9uczogQ2FsZW5kYXJPcHRpb25zID0gewogICAgaGVhZGVyVG9vbGJhcjogZmFsc2UsCiAgICBpbml0aWFsRGF0ZTogc2VsZWN0ZWREYXRlLAogICAgaW5pdGlhbFZpZXc6ICJ0aW1lR3JpZERheSIsCiAgICBwbHVnaW5zOiBbdGltZWdyaWRQbHVnaW4sIGludGVyYWN0aW9uUGx1Z2luXSwKICAgIHNsb3RNaW5UaW1lOiAiMDY6MDA6MDAiLAogICAgc2xvdE1heFRpbWU6ICIyMjowMDowMCIsCiAgICBzZWxlY3RhYmxlOiB0cnVlLAogICAgaGVpZ2h0OiAiMTAwJSIsCiAgICBoYW5kbGVXaW5kb3dSZXNpemU6IHRydWUsCiAgfTsKCiAgJDogewogICAgaW5uZXJXaWR0aDsKICAgIG9wdGlvbnMgPSB7CiAgICAgIC4uLm9wdGlvbnMsCiAgICB9OwogIH0KCiAgJDogewogICAgb3B0aW9ucyA9IHsKICAgICAgaGVhZGVyVG9vbGJhcjogZmFsc2UsCiAgICAgIGluaXRpYWxEYXRlOiBzZWxlY3RlZERhdGUsCiAgICAgIGluaXRpYWxWaWV3OiAidGltZUdyaWREYXkiLAogICAgICBwbHVnaW5zOiBbdGltZWdyaWRQbHVnaW4sIGludGVyYWN0aW9uUGx1Z2luXSwKICAgICAgc2xvdEV2ZW50T3ZlcmxhcDogZmFsc2UsCgogICAgICBldmVudENvbnRlbnQ6IChhcmdzOiBhbnkpID0+IHsKICAgICAgICBsZXQgZGlmZmVyZW5jZSA9IGRheWpzKGFyZ3MuZXZlbnQuX2luc3RhbmNlLnJhbmdlLmVuZCkuZGlmZigKICAgICAgICAgIGRheWpzKGFyZ3MuZXZlbnQuX2luc3RhbmNlLnJhbmdlLnN0YXJ0KSwKICAgICAgICAgICJtaW51dGUiCiAgICAgICAgKTsKICAgICAgICBsZXQgdGl0bGUgPSBhcmdzLmV2ZW50Ll9kZWYudGl0bGU7CiAgICAgICAgbGV0IHBsYXR6ID0gYXJncy5ldmVudC5fZGVmLmV4dGVuZGVkUHJvcHMucGxhdHo7CiAgICAgICAgbGV0IHRpbWVUZXh0ID0gYXJncy50aW1lVGV4dDsKICAgICAgICBsZXQgbm90aXplbiA9IGFyZ3MuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLm5vdGl6ZW47CgogICAgICAgIGxldCBhdmFpbGFibGVSb3dzID0gZGlmZmVyZW5jZSAvIDMwOwogICAgICAgIGlmIChhdmFpbGFibGVSb3dzID49IDQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7dGltZVRleHR9PC9wPgogICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX08L3A+CiAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3BsYXR6fTwvcD4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7bm90aXplbn08L3A+CiAgICAgICAgICAgPC9kaXY+YCwKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChhdmFpbGFibGVSb3dzID49IDMpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7dGltZVRleHR9PC9wPgogICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX08L3A+CiAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3BsYXR6ID8gYHwgJHtwbGF0en1gIDogIiJ9ICR7CiAgICAgICAgICAgICAgbm90aXplbiA/IGB8ICR7bm90aXplbn1gIDogIiIKICAgICAgICAgICAgfTwvcD4KICAgICAgICAgICA8L2Rpdj5gLAogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKGF2YWlsYWJsZVJvd3MgPj0gMikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaHRtbDogYDxkaXYgY2xhc3M9ImN1cnNvci1wb2ludGVyIiB0aXRsZT0iJHt0aXRsZX0gJHtwbGF0en0gJHtub3RpemVufSIgPgogICAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3RpbWVUZXh0fTwvcD4KICAgICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX0gJHsKICAgICAgICAgICAgICAgIHBsYXR6ID8gYHwgJHtwbGF0en1gIDogIiIKICAgICAgICAgICAgICB9ICR7bm90aXplbiA/IGB8ICR7bm90aXplbn1gIDogIiJ9PC9wPgogICAgICAgICAgICAgPC9kaXY+YCwKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aW1lVGV4dH0gfCAke3RpdGxlfSAkewogICAgICAgICAgICAgICAgcGxhdHogPyBgfCAke3BsYXR6fWAgOiAiIgogICAgICAgICAgICAgIH0gJHtub3RpemVuID8gYHwgJHtub3RpemVufWAgOiAiIn08L3A+CiAgICAgICAgICAgICA8L2Rpdj5gLAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV2ZW50czogcmFwb3J0cy5tYXAoKHIpID0+IHsKICAgICAgICBsZXQgbmFtZSA9ICIiOwoKICAgICAgICBsZXQga3VuZGVzID0KICAgICAgICAgIHIua3VuZGVzLmxlbmd0aCA+IDAKICAgICAgICAgICAgPyBgS3VuZGVzOiAke3Iua3VuZGVzLm1hcCgoazogYW55KSA9PiBgJHtrLm5hbWV9ICR7ay52b3JuYW1lfWApLmpvaW4oIiwgIil9YAogICAgICAgICAgICA6ICIiOwoKICAgICAgICBpZiAoa3VuZGVzKSB7CiAgICAgICAgICBuYW1lID0ga3VuZGVzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuYW1lID0gci5rdW5kZQogICAgICAgICAgICA/IGBLdW5kZTogJHtyLmt1bmRlPy5uYW1lfSwgJHtyLmt1bmRlPy52b3JuYW1lfWAKICAgICAgICAgICAgOiByLmdydXBwZQogICAgICAgICAgICAgID8gYEdydXBwZTogJHtyLmdydXBwZT8uZ3J1cHBlbnR5cH0gLSAke3IuZ3J1cHBlPy5ncnVwcGVubmFtZX1gCiAgICAgICAgICAgICAgOiAiIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpZDogY3JlYXRlRXZlbnRJZCgpLAogICAgICAgICAgdGl0bGU6IGAke25hbWV9ICR7a3VuZGVzID8gYHwgJHtrdW5kZXN9YCA6ICIifWAsCiAgICAgICAgICBwbGF0ejogYCR7ci5wbGF0ej8udGVubmlzY291cnQgfHwgIiJ9YCwKICAgICAgICAgIG5vdGl6ZW46IGAke3Iubm90aXplbiB8fCAiIn1gLAogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBgICR7CiAgICAgICAgICAgIHNlbGVjdGVkVHJhaW5lcj8udmFsdWUKICAgICAgICAgICAgICA/IHIua3VuZGUKICAgICAgICAgICAgICAgID8gIiMxYTVjYTMiCiAgICAgICAgICAgICAgICA6ICIjZmVkNWNiIgogICAgICAgICAgICAgIDogcj8udHJhaW5lcj8uY29sb3IgfHwgIiMxYTVjYTMiCiAgICAgICAgICB9ICBgLAogICAgICAgICAgdGV4dENvbG9yOiBgJHtyPy50cmFpbmVyPy5jb2xvckZvbnQgfHwgIiMwMDAifWAsCiAgICAgICAgICBib3JkZXJDb2xvcjogYCR7ci5rdW5kZSA/ICIjZmZmIiA6ICIjZmE3MjUyIn1gLAogICAgICAgICAgY2xhc3NOYW1lOiBgc2luZ2xlLWRheS1ldmVudC1zdHlsZSAkewogICAgICAgICAgICByLnRyYWluaW5nc2RhdWVyID8gIiIgOiAiZG90dGVkLWRhc2hlZCIKICAgICAgICAgIH0gYCwKICAgICAgICAgIHN0YXJ0OiBuZXcgRGF0ZSgKICAgICAgICAgICAgZGF5anMoci5kYXR1bSkKICAgICAgICAgICAgICAuc2V0KCJob3VyIiwgci5zdGFydHplaXQuc3BsaXQoIjoiKVswXSkKICAgICAgICAgICAgICAuc2V0KCJtaW51dGUiLCByLnN0YXJ0emVpdC5zcGxpdCgiOiIpWzFdKQogICAgICAgICAgICAgIC5mb3JtYXQoKQogICAgICAgICAgKSwKICAgICAgICAgIGVuZDogbmV3IERhdGUoCiAgICAgICAgICAgIGRheWpzKHIuZGF0dW0pCiAgICAgICAgICAgICAgLnNldCgiaG91ciIsIHIuc3RhcnR6ZWl0LnNwbGl0KCI6IilbMF0pCiAgICAgICAgICAgICAgLnNldCgibWludXRlIiwgci5zdGFydHplaXQuc3BsaXQoIjoiKVsxXSkKICAgICAgICAgICAgICAuYWRkKHIudHJhaW5pbmdzZGF1ZXI/LnNwbGl0KCI6IilbMF0gfHwgMSwgImhvdXIiKQogICAgICAgICAgICAgIC5hZGQoci50cmFpbmluZ3NkYXVlcj8uc3BsaXQoIjoiKVsxXSB8fCAwLCAibWludXRlIikKICAgICAgICAgICAgICAuZm9ybWF0KCkKICAgICAgICAgICksCiAgICAgICAgICByYXBwb3J0OiByLAogICAgICAgIH07CiAgICAgIH0pLAogICAgICBldmVudFRpbWVGb3JtYXQ6IHsKICAgICAgICBob3VyOiAiMi1kaWdpdCIsCiAgICAgICAgbWludXRlOiAiMi1kaWdpdCIsCiAgICAgICAgaG91cjEyOiBmYWxzZSwKICAgICAgfSwKICAgICAgc2VsZWN0YWJsZTogdHJ1ZSwKICAgICAgc2VsZWN0OiBmdW5jdGlvbiAoaW5mbzogYW55KSB7CiAgICAgICAgZGlzcGF0Y2goImRhdGVTZWxlY3RlZCIsIGluZm8pOwoKICAgICAgICAvLyBzaG93IGNyZWF0ZSBmb3JtIHdpdGggdGhlIHN0YXJ0IGRhdGUgYW5kIGR1cmF0aW9uKGVuZCBkYXRlIC0gc3RhcnQgZGF0ZSkgcHJlIGZpbGxlZAogICAgICB9LAoKICAgICAgZXZlbnRDbGljazogZnVuY3Rpb24gKGluZm86IGFueSkgewogICAgICAgIGRpc3BhdGNoKCJldmVudENsaWNrZWQiLCBpbmZvKTsKICAgICAgfSwKCiAgICAgIGRhdGVDbGljazogZnVuY3Rpb24gKGluZm86IGFueSkgewogICAgICAgIGRpc3BhdGNoKCJkYXRlU2VsZWN0ZWQiLCBpbmZvKTsKICAgICAgfSwKICAgICAgYnVzaW5lc3NIb3VyczogewogICAgICAgIC8vIGRheXMgb2Ygd2Vlay4gYW4gYXJyYXkgb2YgemVyby1iYXNlZCBkYXkgb2Ygd2VlayBpbnRlZ2VycyAoMD1TdW5kYXkpCiAgICAgICAgZGF5c09mV2VlazogWzEsIDIsIDMsIDQsIDVdLCAvLyBNb25kYXkgLSBUaHVyc2RheQogICAgICAgIHN0YXJ0VGltZTogIjA2OjAwIiwgLy8gYSBzdGFydCB0aW1lICgxMGFtIGluIHRoaXMgZXhhbXBsZSkKICAgICAgICBlbmRUaW1lOiAiMjI6MDAiLCAvLyBhbiBlbmQgdGltZSAoNnBtIGluIHRoaXMgZXhhbXBsZSkKICAgICAgfSwKICAgICAgc2xvdExhYmVsRm9ybWF0OiB7CiAgICAgICAgaG91cjogIm51bWVyaWMiLAogICAgICAgIG1pbnV0ZTogIjItZGlnaXQiLAogICAgICAgIGhvdXIxMjogZmFsc2UsCiAgICAgIH0sCiAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICBoYW5kbGVXaW5kb3dSZXNpemU6IHRydWUsCiAgICAgIHdpbmRvd1Jlc2l6ZTogZnVuY3Rpb24gKGFyZzogeyB2aWV3OiBWaWV3QXBpIH0pIHsKICAgICAgICBhcmcudmlldy5jYWxlbmRhci51cGRhdGVTaXplKCk7CiAgICAgIH0sCiAgICB9OwogIH0KPC9zY3JpcHQ+Cgo8c3ZlbHRlOndpbmRvdyBiaW5kOmlubmVyV2lkdGggLz4KPEZ1bGxDYWxlbmRhcgogIGJpbmQ6dGhpcz17Y2FsZW5kYXJSZWZ9CiAge29wdGlvbnN9CiAgY2xhc3M9InB0LTQgbWF4LXctc2NyZWVuLWxnIG14LWF1dG8gbWluLWgtZnVsbCIKLz4KPGRpdj4KICB7I2lmIHRyYWluZXJzLmxlbmd0aCA+IDB9CiAgICA8ZGl2IGNsYXNzPSJmbGV4IGZsZXgtd3JhcCBtdC00IGdhcC00IGp1c3RpZnktYmV0d2VlbiI+CiAgICAgIHsjZWFjaCB0cmFpbmVycyBhcyB0cmFpbmVyfQogICAgICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGdhcC1bMC4xcmVtXSI+CiAgICAgICAgICA8ZGl2CiAgICAgICAgICAgIGNsYXNzPSJ3LTQgaC00IHJvdW5kZWQtZnVsbCBtci0yIgogICAgICAgICAgICBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjoge3RyYWluZXIuY29sb3J9IgogICAgICAgICAgPjwvZGl2PgogICAgICAgICAgPHA+e3RyYWluZXIubmFtZX08L3A+CiAgICAgICAgPC9kaXY+CiAgICAgIHsvZWFjaH0KICAgIDwvZGl2PgogIHsvaWZ9CjwvZGl2Pgo=
      - name: trainerDropDown
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IHsgb25Nb3VudCB9IGZyb20gInN2ZWx0ZSI7CgogIGltcG9ydCBTZWxlY3QgZnJvbSAic3ZlbHRlLXNlbGVjdC9TZWxlY3Quc3ZlbHRlIjsKICBpbXBvcnQgeyBjcmVhdGVFdmVudERpc3BhdGNoZXIgfSBmcm9tICJzdmVsdGUiOwogIGNvbnN0IGRpc3BhdGNoID0gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCk7CgogIGV4cG9ydCBsZXQgc2VsZWN0ZWRWYWx1ZToKICAgIHwgewogICAgICAgIHZhbHVlOiBudW1iZXI7CiAgICAgICAgbGFiZWw6IHN0cmluZzsKICAgICAgfQogICAgfCB7fSA9IHt9OwoKICBleHBvcnQgbGV0IHBsYWNlaG9sZGVyID0gIlRyYWluZXIiOwoKICBsZXQgaGFuZGxlQ2hhbmdlID0gKCkgPT4gewogICAgZGlzcGF0Y2goInVwZGF0ZVRyYWluZXIiLCB7CiAgICAgIHNlbGVjdGVkVmFsdWUsCiAgICB9KTsKICB9OwoKICBsZXQgbGlzdDogYW55ID0gW107CgogIG9uTW91bnQoYXN5bmMgZnVuY3Rpb24gKCkgewogICAgbGV0IHNhdmVkVHJhaW5lciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0cmFpbmVyIik7CgogICAgaWYgKHNhdmVkVHJhaW5lcikgewogICAgICBzZWxlY3RlZFZhbHVlID0gSlNPTi5wYXJzZShzYXZlZFRyYWluZXIpOwogICAgfQoKICAgIC8vIGdldCB0aGUgbGlzdCBvZiB0cmFpbmVycwogICAgLy8gc2V0IHRoZSBsaXN0IG9mIHRyYWluZXJzIHRvIHRoZSBzZWxlY3QgY29tcG9uZW50CiAgICBsZXQgcmFwcG9ydHMgPSBhd2FpdCBmZXRjaCgKICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvdHJhaW5lcnM/ZmlsdGVyPXsid2hlcmUiOnsiYWt0aXYiOnRydWV9fWAKICAgICk7CiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmFwcG9ydHMuanNvbigpOwoKICAgIGxpc3QgPSBbCiAgICAgIHsKICAgICAgICB2bGF1ZTogMCwKICAgICAgICBsYWJlbDogIkFsbCBUcmFpbmVycyIsCiAgICAgIH0sCiAgICAgIC4uLmRhdGEubWFwKChyOiBhbnkpID0+ICh7CiAgICAgICAgdmFsdWU6IHIuaWQsCiAgICAgICAgbGFiZWw6IHIubmFtZSwKICAgICAgfSkpLAogICAgXTsKICB9KTsKPC9zY3JpcHQ+Cgo8ZGl2IGNsYXNzPSJtYXgtdy1zbSB0aGVtZWQiPgogIDxTZWxlY3QKICAgIGl0ZW1zPXtsaXN0fQogICAgYmluZDp2YWx1ZT17c2VsZWN0ZWRWYWx1ZX0KICAgIGJpbmQ6cGxhY2Vob2xkZXIKICAgIG9uOnNlbGVjdD17aGFuZGxlQ2hhbmdlfQogIC8+CjwvZGl2PgoKPHN0eWxlIGxhbmc9InBvc3Rjc3MiPgogIC50aGVtZWQgewogICAgLS1ib3JkZXJIb3ZlckNvbG9yOiAjMWE1Y2EzOwogICAgLS1ib3JkZXJSYWRpdXM6IDRweDsKICAgIC0taXRlbUhvdmVyQkc6ICNmZmYxZWU7CiAgICAtLWl0ZW1Jc0FjdGl2ZUJHOiAjZmE3MjUyOwogIH0KPC9zdHlsZT4K
      - name: createEvent
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKICBpbXBvcnQgQ3JlYXRlRXZlbnQgZnJvbSAiLi4vLi4vbW9kdWxlcy9SYXBwb3J0L2NyZWF0ZS5zdmVsdGUiOwogIGltcG9ydCB7IG9uTW91bnQgfSBmcm9tICJzdmVsdGUiOwogIGxldCBzYXZlZFRyYWluZXI6IHsKICAgIHZhbHVlOiBudW1iZXI7CiAgICBsYWJlbDogc3RyaW5nOwogIH0gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0cmFpbmVyIikgfHwgInt9Iik7CiAgZXhwb3J0IGxldCBjbG9zZVBvcHVwID0gKCkgPT4ge307CiAgZXhwb3J0IGxldCBzY2hlbWE6IGFueSA9IHt9OwoKICBleHBvcnQgbGV0IHNlbGVjdGVkRGF0ZTogc3RyaW5nID0gZGF5anMoKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICBleHBvcnQgbGV0IHNlbGVjdGVkU3RhcnRUaW1lOiBzdHJpbmcgPSBkYXlqcygpLmZvcm1hdCgiSEg6bW0iKTsKICBleHBvcnQgbGV0IHNlbGVjdGVkRHVyYXRpb246IHN0cmluZyA9ICIwMTowMDowMCI7CgogIGV4cG9ydCBsZXQgZm9ybURhdGE6IGFueSA9IHt9OwoKICBsZXQgbG9hZGluZyA9IGZhbHNlOwoKICBvbk1vdW50KGFzeW5jICgpID0+IHsKICAgIGxvYWRpbmcgPSB0cnVlOwoKICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApKTsKCiAgICBsZXQga3VuZGVJZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbcGxhY2Vob2xkZXI9Imt1bmRlcyJdJyk7CgogICAga3VuZGVJZHM/LmNsaWNrKCk7CgogICAgaWYgKGt1bmRlSWRzKSB7CiAgICAgIC8vIENyZWF0ZSBhIE11dGF0aW9uT2JzZXJ2ZXIgaW5zdGFuY2UKICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zTGlzdCkgPT4gewogICAgICAgIG11dGF0aW9uc0xpc3QuZm9yRWFjaCgobXV0YXRpb24pID0+IHsKICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAiY2hpbGRMaXN0IikgewogICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2goKG5vZGUpID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ2hpbGQgYWRkZWQ6Iiwgbm9kZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBtdXRhdGlvbi5yZW1vdmVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDaGlsZCByZW1vdmVkOiIsIG5vZGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAiY2hpbGRMaXN0IikgewogICAgICAgICAgICAvLyBjaGVjayBmb3JtZGF0YS5rdW5kZUlkcy5sZW5ndGggYW5kIGlmIG1vcmUgdGhhbiAxLCBzZXQgdHJhaW5pbmdUeXBlIHRvIGdydXBwZSBhbmQgaWYgaXQgaXMgMSBhbmQgdGhlIHByZXZpb3VzIHZhbHVlIHdhcyBncnVwcGUsIHNldCBpdCB0byBwcml2YXRlCiAgICAgICAgICAgIGlmIChmb3JtRGF0YS5rdW5kZUlkcy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgZm9ybURhdGEudHJhaW5pbmdUeXBlID0gImdydXBwZSI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgICAgICAgZm9ybURhdGEua3VuZGVJZHMubGVuZ3RoID09PSAxICYmCiAgICAgICAgICAgICAgZm9ybURhdGEudHJhaW5pbmdUeXBlID09PSAiZ3J1cHBlIgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBmb3JtRGF0YS50cmFpbmluZ1R5cGUgPSAicHJpdmF0ZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICAvLyBTZXQgdGhlIG9ic2VydmVyIG9wdGlvbnMKICAgICAgY29uc3Qgb2JzZXJ2ZXJDb25maWcgPSB7CiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLCAvLyBMaXN0ZW4gZm9yIGNoaWxkIG5vZGVzIGFkZGVkIG9yIHJlbW92ZWQKICAgICAgICBzdWJ0cmVlOiB0cnVlLCAvLyBPYnNlcnZlIGFsbCBkZXNjZW5kYW50cyBvZiB0aGUgdGFyZ2V0CiAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwgLy8gTGlzdGVuIGZvciB0ZXh0IGNvbnRlbnQgY2hhbmdlcyBpbiB0ZXh0IG5vZGVzCiAgICAgIH07CgogICAgICAvLyBTdGFydCBvYnNlcnZpbmcKICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShrdW5kZUlkcywgb2JzZXJ2ZXJDb25maWcpOwogICAgfQoKICAgIGxvYWRpbmcgPSBmYWxzZTsKICB9KTsKCiAgY29uc3QgaXNVc2VyVHJhaW5lciA9ICgpID0+IHsKICAgIC8vIFRPRE86IHNlbmQgYSByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kIHRvIHZlcmlmeSBpZiB0aGUgdG9rZW4gaXMgdmFsaWQKICAgIHJldHVybiAoCiAgICAgIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpIHx8IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guaW5jbHVkZXMoInRva2VuIikKICAgICk7CiAgfTsKCiAgJDogc2NoZW1hID0gewogICAgLi4uc2NoZW1hLAogICAgImZpZWxkLXByb3BlcnRpZXMiOiB7CiAgICAgIC4uLnNjaGVtYVsiZmllbGQtcHJvcGVydGllcyJdLAogICAgICAiaGlkZGVuLWZpZWxkcyI6IFsiaW52b2ljZWRJbiIsICJpbnZvaWNlSnNvbiIsICJhcmNoaXZlZCJdLAogICAgICAiZmllbGQtb3JkZXIiOiBbCiAgICAgICAgImRhdHVtIiwKICAgICAgICAic3RhcnR6ZWl0IiwKICAgICAgICAidHJhaW5pbmdzZGF1ZXIiLAogICAgICAgICJ0cmFpbmVyIiwKICAgICAgICAicGxhdHoiLAogICAgICAgICJ0cmFpbmluZ1R5cGUiLAogICAgICAgICJrdW5kZSIsCiAgICAgICAgImt1bmRlSWRzIiwKICAgICAgICAiZ3J1cHBlIiwKICAgICAgICAibm90aXplbiIsCiAgICAgICAgIm5hY2hob2x0ZXJtaW4iLAogICAgICAgICJwcm9iZXRyYWluaW5nIiwKICAgICAgICAiYXJjaGl2ZWQiLAogICAgICAgICJpbnZvaWNlZEluIiwKICAgICAgICAiaW52b2ljZUpzb24iLAogICAgICBdLAogICAgICAiYm9vbGVhbi1maWVsZHMiOiBbInByb2JldHJhaW5pbmciLCAibmFjaGhvbHRlcm1pbiIsICJhcmNoaXZlZCJdLAoKICAgICAgImRlZmF1bHQtdmFsdWVzIjogWwogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJpbnZvaWNlZEluIiwKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogInRyYWluZXJJZCIsCiAgICAgICAgICB2YWx1ZTogc2F2ZWRUcmFpbmVyLnZhbHVlLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogImRhdHVtIiwKICAgICAgICAgIHZhbHVlOiBkYXlqcyhzZWxlY3RlZERhdGUpLmZvcm1hdCgiWVlZWS1NTS1ERCIpLnN1YnN0cigwLCAxMCksCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAic3RhcnR6ZWl0IiwKICAgICAgICAgIHZhbHVlOiBkYXlqcyhzZWxlY3RlZFN0YXJ0VGltZSkuaXNWYWxpZCgpCiAgICAgICAgICAgID8gZGF5anMoc2VsZWN0ZWRTdGFydFRpbWUpLmZvcm1hdCgiSEg6bW0iKQogICAgICAgICAgICA6IGRheWpzKCkuZm9ybWF0KCJISCIpICsgIjowMCIsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAidHJhaW5pbmdzZGF1ZXIiLAogICAgICAgICAgdmFsdWU6IHNlbGVjdGVkRHVyYXRpb24sCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAidHJhaW5pbmdUeXBlIiwKICAgICAgICAgIHZhbHVlOiAicHJpdmF0ZSIsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicGxhdHpJZCIsCiAgICAgICAgICB2YWx1ZTogMSwgLy9wcmVzZWxlY3QgcGxhdHogZmllbGQgd2l0aCBvbmUgb2YgdGhlIHZhbHVlcwogICAgICAgIH0sCiAgICAgIF0sCiAgICAgICJyZWxhdGlvbmFsLWZpZWxkcyI6IFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAia3VuZGVJZHMiLAogICAgICAgICAgdHlwZTogIkZBVk9SSVRFIiwKICAgICAgICAgIGVkaXRhYmxlOiB0cnVlLAogICAgICAgICAgdXNlRnV6enlTZWFyY2g6IHRydWUsCiAgICAgICAgICBjb2x1bW5zOiBbCiAgICAgICAgICAgICJpZCIsCiAgICAgICAgICAgICJiZXhpb0lkIiwKICAgICAgICAgICAgIm5hbWUiLAogICAgICAgICAgICAidm9ybmFtZSIsCiAgICAgICAgICAgICJvcnQiLAogICAgICAgICAgICAiZ2VidXJ0c3RhZyIsCiAgICAgICAgICAgICJwaG9uZSIsCiAgICAgICAgICAgICJwaG9uZU1vYmlsZSIsCiAgICAgICAgICAgICJub3RpemVuIiwKICAgICAgICAgIF0sCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAidHJhaW5lciIsCiAgICAgICAgICBlZGl0YWJsZTogIWlzVXNlclRyYWluZXIoKSwKICAgICAgICAgIGNvbHVtbnM6IFsiaWQiLCAibmFtZSIsICJ2b3JuYW1lIiwgImVtYWlsIl0sCiAgICAgICAgICBkcm9wRG93bkZpbHRlcjogewogICAgICAgICAgICBha3RpdjogdHJ1ZSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgLy9yZWFkb25seSBhbmQgY3VzdG9tLXZhbGlkYXRpb24gYXBwbHkgaWYgdGhlIHVzZXIgaXMgYSB0cmFpbmVyCiAgICAgICJyZWFkb25seS1maWVsZHMiOiBpc1VzZXJUcmFpbmVyKCkgPyBbInRyYWluZXIiXSA6IFtdLAogICAgICAiY3VzdG9tLXZhbGlkYXRpb25zIjogaXNVc2VyVHJhaW5lcigpCiAgICAgICAgPyBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmaWVsZDogInRyYWluaW5nc2RhdWVyIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVHJhaW5pbmdzZGF1ZXIgY2FuJ3QgYmUgZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIuKlxcUy4qIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZmllbGQ6ICJ0cmFpbmVyIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVHJhaW5lciBjYW4ndCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgICByZWdleDogIi4qXFxTLioiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZmllbGQ6ICJrdW5kZUlkcyIsCiAgICAgICAgICAgICAgdmFsaWRhdGlvbjogewogICAgICAgICAgICAgICAgbWVzc2FnZTogIkt1bmRlcyBjYW4ndCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgICByZWdleDogIi4qXFxTLioiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdCiAgICAgICAgOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmaWVsZDogInRyYWluZXIiLAogICAgICAgICAgICAgIHZhbGlkYXRpb246IHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJUcmFpbmVyIGNhbid0IGJlIGVtcHR5IiwKICAgICAgICAgICAgICAgIHJlZ2V4OiAiLipcXFMuKiIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGZpZWxkOiAia3VuZGVJZHMiLAogICAgICAgICAgICAgIHZhbGlkYXRpb246IHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJLdW5kZXMgY2FuJ3QgYmUgZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIuKlxcUy4qIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgXSwKICAgICAgImRyb3Bkb3duLWZpZWxkcyI6IFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAidHJhaW5pbmdUeXBlIiwKICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgbGFiZWw6ICJwcml2YXRlIiwKICAgICAgICAgICAgdmFsdWU6ICJwcml2YXRlIiwKICAgICAgICAgIH0sCiAgICAgICAgICBvcHRpb25zOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogInByaXZhdGUiLAogICAgICAgICAgICAgIHZhbHVlOiAicHJpdmF0ZSIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogImdydXBwZSAoc3BvbnRhbikiLAogICAgICAgICAgICAgIHZhbHVlOiAiZ3J1cHBlIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGxhYmVsOiAiTWFubnNjaGFmdHN0cmFpbmluZyAob2huZSBQbGF0em1pZXRlKSIsCiAgICAgICAgICAgICAgdmFsdWU6ICJtYW5uc2NoYWZ0IiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGxhYmVsOiAiTWFubnNjaGFmdHN0cmFpbmluZyAoaW5rbC4gUGxhdHptaWV0ZSkiLAogICAgICAgICAgICAgIHZhbHVlOiAibWFubnNjaGFmdF9wbGF0eiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIkF1ZnNjaGxhZ3RyYWluaW5nIiwKICAgICAgICAgICAgICB2YWx1ZTogImF1ZnNjaGxhZyIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIkZpdG5lc3MgVGVubmlzIiwKICAgICAgICAgICAgICB2YWx1ZTogImZpdG5lc3NfdGVubmlzIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGxhYmVsOiAiTW9ybmluZyBUcmVmZiIsCiAgICAgICAgICAgICAgdmFsdWU6ICJtb3JuaW5nX3RyZWZmIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGxhYmVsOiAiQWZ0ZXIgV29yayIsCiAgICAgICAgICAgICAgdmFsdWU6ICJhZnRlcl93b3JrIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGxhYmVsOiAiTWl0dGFncyBUcmVmZiIsCiAgICAgICAgICAgICAgdmFsdWU6ICJtaXR0YWdzX3RyZWZmIiwKICAgICAgICAgICAgfSwKICAgICAgICAgIF0sCiAgICAgICAgfSwKICAgICAgXSwKICAgIH0sCiAgfTsKPC9zY3JpcHQ+Cgp7I2lmIGxvYWRpbmd9CiAgPGRpdgogICAgY2xhc3M9ImZpeGVkIHotMTAgaW5zZXQtMCBvdmVyZmxvdy15LWF1dG8gYmctYmxhY2sgYmctb3BhY2l0eS01MCIKICAgIGFyaWEtbGFiZWxsZWRieT0ibW9kYWwtdGl0bGUiCiAgICByb2xlPSJkaWFsb2ciCiAgICBhcmlhLW1vZGFsPSJ0cnVlIgogID4KICAgIDxkaXYgY2xhc3M9ImZsZXgganVzdGlmeS1jZW50ZXIgaXRlbXMtY2VudGVyIGgtWzcwdmhdIj4KICAgICAgPGRpdgogICAgICAgIGNsYXNzPSJhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtMzIgdy0zMiBib3JkZXItdC0yIGJvcmRlci1iLTIgYm9yZGVyLWdyYXktOTAwIgogICAgICA+PC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4Key9pZn0KCjxkaXYgY2xhc3M9ImJnLXdoaXRlIHAtNCB3LVs5NSVdIHJvdW5kZWQtc20iPgogIDxkaXYgY2xhc3M9InRleHQtcmlnaHQgcGItNCI+CiAgICA8YnV0dG9uCiAgICAgIGNsYXNzPSJ0ZXh0LWNlbnRlciBweS0zIHB4LTYgc2hhZG93LXNtIGJvcmRlciBib3JkZXItZ3JheS0yMDAgaG92ZXI6c2hhZG93LW1kIHRyYW5zaXRpb24tYWxsIGZvbnQtc2VtaWJvbGQgcm91bmRlZC1mdWxsIGgtOCB3LTggIXAtMCB0ZXh0LWxnIgogICAgICBvbjpjbGljaz17Y2xvc2VQb3B1cH0KICAgID4KICAgICAgPHN2ZwogICAgICAgIHdpZHRoPSIyNCIKICAgICAgICBoZWlnaHQ9IjI0IgogICAgICAgIHZpZXdCb3g9IjAgMCAyNCAyNCIKICAgICAgICBmaWxsPSJub25lIgogICAgICAgIHN0cm9rZT0iY3VycmVudENvbG9yIgogICAgICAgIHN0cm9rZS13aWR0aD0iMiIKICAgICAgICBzdHJva2UtbGluZWNhcD0icm91bmQiCiAgICAgICAgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIKICAgICAgICBjbGFzcz0iaC01IHctNSBpbmxpbmUtYmxvY2siCiAgICAgICAgPjxsaW5lIHgxPSIxOCIgeTE9IjYiIHgyPSI2IiB5Mj0iMTgiIC8+PGxpbmUKICAgICAgICAgIHgxPSI2IgogICAgICAgICAgeTE9IjYiCiAgICAgICAgICB4Mj0iMTgiCiAgICAgICAgICB5Mj0iMTgiCiAgICAgICAgLz48L3N2ZwogICAgICA+CiAgICA8L2J1dHRvbj4KICA8L2Rpdj4KCiAgPGRpdiBjbGFzcz0ib3ZlcmZsb3ctYXV0byBtYXgtaC1bNzAlXSI+CiAgICA8Q3JlYXRlRXZlbnQge3NjaGVtYX0gb25TdWNjZXNzPXtjbG9zZVBvcHVwfSBiaW5kOmZvcm1EYXRhIC8+CiAgPC9kaXY+CjwvZGl2Pgo=
      - name: singleDay2
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IEZ1bGxDYWxlbmRhciwgeyBDYWxlbmRhck9wdGlvbnMsIFZpZXdBcGkgfSBmcm9tICJzdmVsdGUtZnVsbGNhbGVuZGFyIjsKICBpbXBvcnQgdGltZWdyaWRQbHVnaW4gZnJvbSAiQGZ1bGxjYWxlbmRhci90aW1lZ3JpZCI7CiAgaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKICBpbXBvcnQgaW50ZXJhY3Rpb25QbHVnaW4gZnJvbSAiQGZ1bGxjYWxlbmRhci9pbnRlcmFjdGlvbiI7IC8vIGZvciBzZWxlY3RhYmxlCiAgaW1wb3J0IHsgY3JlYXRlRXZlbnREaXNwYXRjaGVyLCBvbk1vdW50IH0gZnJvbSAic3ZlbHRlIjsKCiAgY29uc3QgZGlzcGF0Y2ggPSBjcmVhdGVFdmVudERpc3BhdGNoZXIoKTsKCiAgbGV0IGV2ZW50R3VpZCA9IDA7CiAgbGV0IGlubmVyV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsKCiAgbGV0IHRyYWluZXJzOiBhbnkgPSBbXTsKCiAgb25Nb3VudChhc3luYyBmdW5jdGlvbiAoKSB7CiAgICBsZXQgcmFwcG9ydHMgPSBhd2FpdCBmZXRjaCgKICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvdHJhaW5lcnM/ZmlsdGVyPXsib3JkZXIiOiJpZCIsIndoZXJlIjp7ImFrdGl2Ijp0cnVlfX1gCiAgICApOwogICAgdHJhaW5lcnMgPSBhd2FpdCByYXBwb3J0cy5qc29uKCk7CiAgfSk7CgogIGV4cG9ydCBsZXQgcmFwb3J0czogewogICAgZGF0dW06IGFueTsKICAgIHN0YXJ0emVpdDogYW55OwogICAgdHJhaW5pbmdzZGF1ZXI6IGFueTsKICAgIGt1bmRlOiBhbnk7CiAgICBncnVwcGU6IGFueTsKICAgIHBsYXR6OiBhbnk7CiAgICB0cmFpbmVyOiBhbnk7CiAgICBub3RpemVuPzogc3RyaW5nOwogICAga3VuZGVzPzogYW55OwogIH1bXSA9IFtdOwogIGV4cG9ydCBsZXQgc2VsZWN0ZWREYXRlID0gIiI7CiAgZXhwb3J0IGxldCBzZWxlY3RlZFRyYWluZXI6IGFueTsKCiAgbGV0IGNhbGVuZGFyUmVmOiBhbnk7CiAgZnVuY3Rpb24gc2V0KCkgewogICAgaWYgKGNhbGVuZGFyUmVmKSB7CiAgICAgIGNvbnN0IGNhbGVuZGFyQXBpID0gY2FsZW5kYXJSZWYuZ2V0QVBJKCk7CiAgICAgIGNhbGVuZGFyQXBpLmdvdG9EYXRlKHNlbGVjdGVkRGF0ZSk7CiAgICB9CiAgfQoKICAkOiB7CiAgICBsZXQgc2hvd2VkRGF0ZSA9IHNlbGVjdGVkRGF0ZTsKCiAgICBzZXQoKTsKICAgIGNvbnNvbGUubG9nKHNob3dlZERhdGUpOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlRXZlbnRJZCgpIHsKICAgIHJldHVybiBTdHJpbmcoZXZlbnRHdWlkKyspOwogIH0KICBsZXQgb3B0aW9uczogQ2FsZW5kYXJPcHRpb25zID0gewogICAgaGVhZGVyVG9vbGJhcjogZmFsc2UsCiAgICBpbml0aWFsRGF0ZTogc2VsZWN0ZWREYXRlLAogICAgaW5pdGlhbFZpZXc6ICJ0aW1lR3JpZERheSIsCiAgICBwbHVnaW5zOiBbdGltZWdyaWRQbHVnaW4sIGludGVyYWN0aW9uUGx1Z2luXSwKICAgIHNsb3RNaW5UaW1lOiAiMDY6MDA6MDAiLAogICAgc2xvdE1heFRpbWU6ICIyMjowMDowMCIsCiAgICBzZWxlY3RhYmxlOiB0cnVlLAogICAgaGVpZ2h0OiAiMTAwJSIsCiAgICBoYW5kbGVXaW5kb3dSZXNpemU6IHRydWUsCiAgfTsKCiAgJDogewogICAgaW5uZXJXaWR0aDsKICAgIG9wdGlvbnMgPSB7CiAgICAgIC4uLm9wdGlvbnMsCiAgICB9OwogIH0KCiAgJDogewogICAgb3B0aW9ucyA9IHsKICAgICAgaGVhZGVyVG9vbGJhcjogZmFsc2UsCiAgICAgIGluaXRpYWxEYXRlOiBzZWxlY3RlZERhdGUsCiAgICAgIGluaXRpYWxWaWV3OiAidGltZUdyaWREYXkiLAogICAgICBwbHVnaW5zOiBbdGltZWdyaWRQbHVnaW4sIGludGVyYWN0aW9uUGx1Z2luXSwKICAgICAgc2xvdEV2ZW50T3ZlcmxhcDogZmFsc2UsCgogICAgICBldmVudENvbnRlbnQ6IChhcmdzOiBhbnkpID0+IHsKICAgICAgICBsZXQgZGlmZmVyZW5jZSA9IGRheWpzKGFyZ3MuZXZlbnQuX2luc3RhbmNlLnJhbmdlLmVuZCkuZGlmZigKICAgICAgICAgIGRheWpzKGFyZ3MuZXZlbnQuX2luc3RhbmNlLnJhbmdlLnN0YXJ0KSwKICAgICAgICAgICJtaW51dGUiCiAgICAgICAgKTsKICAgICAgICBsZXQgdGl0bGUgPSBhcmdzLmV2ZW50Ll9kZWYudGl0bGU7CiAgICAgICAgbGV0IHBsYXR6ID0gYXJncy5ldmVudC5fZGVmLmV4dGVuZGVkUHJvcHMucGxhdHo7CiAgICAgICAgbGV0IHRpbWVUZXh0ID0gYXJncy50aW1lVGV4dDsKICAgICAgICBsZXQgbm90aXplbiA9IGFyZ3MuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLm5vdGl6ZW47CgogICAgICAgIGxldCBhdmFpbGFibGVSb3dzID0gZGlmZmVyZW5jZSAvIDMwOwogICAgICAgIGlmIChhdmFpbGFibGVSb3dzID49IDQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7dGltZVRleHR9PC9wPgogICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX08L3A+CiAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3BsYXR6fTwvcD4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7bm90aXplbn08L3A+CiAgICAgICAgICAgPC9kaXY+YCwKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChhdmFpbGFibGVSb3dzID49IDMpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgPHAgY2xhc3M9InRydW5jYXRlIHRleHQtc20iPiR7dGltZVRleHR9PC9wPgogICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX08L3A+CiAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3BsYXR6ID8gYHwgJHtwbGF0en1gIDogIiJ9ICR7CiAgICAgICAgICAgICAgbm90aXplbiA/IGB8ICR7bm90aXplbn1gIDogIiIKICAgICAgICAgICAgfTwvcD4KICAgICAgICAgICA8L2Rpdj5gLAogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKGF2YWlsYWJsZVJvd3MgPj0gMikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaHRtbDogYDxkaXYgY2xhc3M9ImN1cnNvci1wb2ludGVyIiB0aXRsZT0iJHt0aXRsZX0gJHtwbGF0en0gJHtub3RpemVufSIgPgogICAgICAgICAgICAgIDxwIGNsYXNzPSJ0cnVuY2F0ZSB0ZXh0LXNtIj4ke3RpbWVUZXh0fTwvcD4KICAgICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aXRsZX0gJHsKICAgICAgICAgICAgICAgIHBsYXR6ID8gYHwgJHtwbGF0en1gIDogIiIKICAgICAgICAgICAgICB9ICR7bm90aXplbiA/IGB8ICR7bm90aXplbn1gIDogIiJ9PC9wPgogICAgICAgICAgICAgPC9kaXY+YCwKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGh0bWw6IGA8ZGl2IGNsYXNzPSJjdXJzb3ItcG9pbnRlciIgdGl0bGU9IiR7dGl0bGV9ICR7cGxhdHp9ICR7bm90aXplbn0iID4KICAgICAgICAgICAgICA8cCBjbGFzcz0idHJ1bmNhdGUgdGV4dC1zbSI+JHt0aW1lVGV4dH0gfCAke3RpdGxlfSAkewogICAgICAgICAgICAgICAgcGxhdHogPyBgfCAke3BsYXR6fWAgOiAiIgogICAgICAgICAgICAgIH0gJHtub3RpemVuID8gYHwgJHtub3RpemVufWAgOiAiIn08L3A+CiAgICAgICAgICAgICA8L2Rpdj5gLAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV2ZW50czogcmFwb3J0cy5tYXAoKHIpID0+IHsKICAgICAgICBsZXQgbmFtZSA9ICIiOwoKICAgICAgICBsZXQga3VuZGVzID0KICAgICAgICAgIHIua3VuZGVzLmxlbmd0aCA+IDAKICAgICAgICAgICAgPyBgS3VuZGVzOiAke3Iua3VuZGVzLm1hcCgoazogYW55KSA9PiBgJHtrLm5hbWV9ICR7ay52b3JuYW1lfWApLmpvaW4oIiwgIil9YAogICAgICAgICAgICA6ICIiOwoKICAgICAgICBpZiAoa3VuZGVzKSB7CiAgICAgICAgICBuYW1lID0ga3VuZGVzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuYW1lID0gci5rdW5kZQogICAgICAgICAgICA/IGBLdW5kZTogJHtyLmt1bmRlPy5uYW1lfSwgJHtyLmt1bmRlPy52b3JuYW1lfWAKICAgICAgICAgICAgOiByLmdydXBwZQogICAgICAgICAgICAgID8gYEdydXBwZTogJHtyLmdydXBwZT8uZ3J1cHBlbnR5cH0gLSAke3IuZ3J1cHBlPy5ncnVwcGVubmFtZX1gCiAgICAgICAgICAgICAgOiAiIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpZDogY3JlYXRlRXZlbnRJZCgpLAogICAgICAgICAgdGl0bGU6IGAke25hbWV9ICR7a3VuZGVzID8gYHwgJHtrdW5kZXN9YCA6ICIifWAsCiAgICAgICAgICBwbGF0ejogYCR7ci5wbGF0ej8udGVubmlzY291cnQgfHwgIiJ9YCwKICAgICAgICAgIG5vdGl6ZW46IGAke3Iubm90aXplbiB8fCAiIn1gLAogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBgICR7CiAgICAgICAgICAgIHNlbGVjdGVkVHJhaW5lcj8udmFsdWUKICAgICAgICAgICAgICA/IHIua3VuZGUKICAgICAgICAgICAgICAgID8gIiMxYTVjYTMiCiAgICAgICAgICAgICAgICA6ICIjZmVkNWNiIgogICAgICAgICAgICAgIDogcj8udHJhaW5lcj8uY29sb3IgfHwgIiMxYTVjYTMiCiAgICAgICAgICB9ICBgLAogICAgICAgICAgdGV4dENvbG9yOiBgJHtyPy50cmFpbmVyPy5jb2xvckZvbnQgfHwgIiMwMDAifWAsCiAgICAgICAgICBib3JkZXJDb2xvcjogYCR7ci5rdW5kZSA/ICIjZmZmIiA6ICIjZmE3MjUyIn1gLAogICAgICAgICAgY2xhc3NOYW1lOiBgc2luZ2xlLWRheS1ldmVudC1zdHlsZSAkewogICAgICAgICAgICByLnRyYWluaW5nc2RhdWVyID8gIiIgOiAiZG90dGVkLWRhc2hlZCIKICAgICAgICAgIH0gYCwKICAgICAgICAgIHN0YXJ0OiBuZXcgRGF0ZSgKICAgICAgICAgICAgZGF5anMoci5kYXR1bSkKICAgICAgICAgICAgICAuc2V0KCJob3VyIiwgci5zdGFydHplaXQuc3BsaXQoIjoiKVswXSkKICAgICAgICAgICAgICAuc2V0KCJtaW51dGUiLCByLnN0YXJ0emVpdC5zcGxpdCgiOiIpWzFdKQogICAgICAgICAgICAgIC5mb3JtYXQoKQogICAgICAgICAgKSwKICAgICAgICAgIGVuZDogbmV3IERhdGUoCiAgICAgICAgICAgIGRheWpzKHIuZGF0dW0pCiAgICAgICAgICAgICAgLnNldCgiaG91ciIsIHIuc3RhcnR6ZWl0LnNwbGl0KCI6IilbMF0pCiAgICAgICAgICAgICAgLnNldCgibWludXRlIiwgci5zdGFydHplaXQuc3BsaXQoIjoiKVsxXSkKICAgICAgICAgICAgICAuYWRkKHIudHJhaW5pbmdzZGF1ZXI/LnNwbGl0KCI6IilbMF0gfHwgMSwgImhvdXIiKQogICAgICAgICAgICAgIC5hZGQoci50cmFpbmluZ3NkYXVlcj8uc3BsaXQoIjoiKVsxXSB8fCAwLCAibWludXRlIikKICAgICAgICAgICAgICAuZm9ybWF0KCkKICAgICAgICAgICksCiAgICAgICAgICByYXBwb3J0OiByLAogICAgICAgIH07CiAgICAgIH0pLAogICAgICBldmVudFRpbWVGb3JtYXQ6IHsKICAgICAgICBob3VyOiAiMi1kaWdpdCIsCiAgICAgICAgbWludXRlOiAiMi1kaWdpdCIsCiAgICAgICAgaG91cjEyOiBmYWxzZSwKICAgICAgfSwKICAgICAgc2VsZWN0YWJsZTogdHJ1ZSwKICAgICAgc2VsZWN0OiBmdW5jdGlvbiAoaW5mbzogYW55KSB7CiAgICAgICAgZGlzcGF0Y2goImRhdGVTZWxlY3RlZCIsIGluZm8pOwoKICAgICAgICAvLyBzaG93IGNyZWF0ZSBmb3JtIHdpdGggdGhlIHN0YXJ0IGRhdGUgYW5kIGR1cmF0aW9uKGVuZCBkYXRlIC0gc3RhcnQgZGF0ZSkgcHJlIGZpbGxlZAogICAgICB9LAoKICAgICAgZXZlbnRDbGljazogZnVuY3Rpb24gKGluZm86IGFueSkgewogICAgICAgIGRpc3BhdGNoKCJldmVudENsaWNrZWQiLCBpbmZvKTsKICAgICAgfSwKCiAgICAgIGRhdGVDbGljazogZnVuY3Rpb24gKGluZm86IGFueSkgewogICAgICAgIGRpc3BhdGNoKCJkYXRlU2VsZWN0ZWQiLCBpbmZvKTsKICAgICAgfSwKICAgICAgYnVzaW5lc3NIb3VyczogewogICAgICAgIC8vIGRheXMgb2Ygd2Vlay4gYW4gYXJyYXkgb2YgemVyby1iYXNlZCBkYXkgb2Ygd2VlayBpbnRlZ2VycyAoMD1TdW5kYXkpCiAgICAgICAgZGF5c09mV2VlazogWzEsIDIsIDMsIDQsIDVdLCAvLyBNb25kYXkgLSBUaHVyc2RheQogICAgICAgIHN0YXJ0VGltZTogIjA2OjAwIiwgLy8gYSBzdGFydCB0aW1lICgxMGFtIGluIHRoaXMgZXhhbXBsZSkKICAgICAgICBlbmRUaW1lOiAiMjI6MDAiLCAvLyBhbiBlbmQgdGltZSAoNnBtIGluIHRoaXMgZXhhbXBsZSkKICAgICAgfSwKICAgICAgc2xvdExhYmVsRm9ybWF0OiB7CiAgICAgICAgaG91cjogIm51bWVyaWMiLAogICAgICAgIG1pbnV0ZTogIjItZGlnaXQiLAogICAgICAgIGhvdXIxMjogZmFsc2UsCiAgICAgIH0sCiAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICBoYW5kbGVXaW5kb3dSZXNpemU6IHRydWUsCiAgICAgIHdpbmRvd1Jlc2l6ZTogZnVuY3Rpb24gKGFyZzogeyB2aWV3OiBWaWV3QXBpIH0pIHsKICAgICAgICBhcmcudmlldy5jYWxlbmRhci51cGRhdGVTaXplKCk7CiAgICAgIH0sCiAgICB9OwogIH0KPC9zY3JpcHQ+Cgo8c3ZlbHRlOndpbmRvdyBiaW5kOmlubmVyV2lkdGggLz4KPEZ1bGxDYWxlbmRhcgogIGJpbmQ6dGhpcz17Y2FsZW5kYXJSZWZ9CiAge29wdGlvbnN9CiAgY2xhc3M9InB0LTQgbWF4LXctc2NyZWVuLWxnIG14LWF1dG8gbWluLWgtZnVsbCIKLz4KPGRpdj4KICB7I2lmIHRyYWluZXJzLmxlbmd0aCA+IDB9CiAgICA8ZGl2IGNsYXNzPSJmbGV4IGZsZXgtd3JhcCBtdC00IGdhcC00IGp1c3RpZnktYmV0d2VlbiI+CiAgICAgIHsjZWFjaCB0cmFpbmVycyBhcyB0cmFpbmVyfQogICAgICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGdhcC1bMC4xcmVtXSI+CiAgICAgICAgICA8ZGl2CiAgICAgICAgICAgIGNsYXNzPSJ3LTQgaC00IHJvdW5kZWQtZnVsbCBtci0yIgogICAgICAgICAgICBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjoge3RyYWluZXIuY29sb3J9IgogICAgICAgICAgPjwvZGl2PgogICAgICAgICAgPHA+e3RyYWluZXIubmFtZX08L3A+CiAgICAgICAgPC9kaXY+CiAgICAgIHsvZWFjaH0KICAgIDwvZGl2PgogIHsvaWZ9CjwvZGl2Pgo=
      - name: calendar
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IEZ1bGxDYWxlbmRhciwgewogICAgQ2FsZW5kYXJPcHRpb25zLAogICAgRGF5Q2VsbENvbnRlbnRBcmcsCiAgICBWaWV3QXBpLAogIH0gZnJvbSAic3ZlbHRlLWZ1bGxjYWxlbmRhciI7CgogIGltcG9ydCBkYXlncmlkUGx1Z2luIGZyb20gIkBmdWxsY2FsZW5kYXIvZGF5Z3JpZCI7CiAgaW1wb3J0IGludGVyYWN0aW9uUGx1Z2luIGZyb20gIkBmdWxsY2FsZW5kYXIvaW50ZXJhY3Rpb24iOyAvLyBmb3Igc2VsZWN0YWJsZQogIGltcG9ydCBHbG9iYWwgZnJvbSAiLi4vY29tcG9uZW50cy9nbG9iYWwuc3ZlbHRlIjsKICBHbG9iYWw7CiAgaW1wb3J0IHsgb25Nb3VudCwgdGljayB9IGZyb20gInN2ZWx0ZSI7CiAgaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKICBpbXBvcnQgU2luZ2xlRGF5IGZyb20gIi4vc2luZ2xlRGF5LnN2ZWx0ZSI7CiAgaW1wb3J0IFRyYWluZXJEcm9wRG93biBmcm9tICIuL3RyYWluZXJEcm9wRG93bi5zdmVsdGUiOwogIGltcG9ydCBDcmVhdGVFdmVudCBmcm9tICIuL2NyZWF0ZUV2ZW50LnN2ZWx0ZSI7CiAgaW1wb3J0IFVwZGF0ZUV2ZW50IGZyb20gIi4vdXBkYXRlRXZlbnQuc3ZlbHRlIjsKICBpbXBvcnQgeyBhZGRNZXNzYWdlcywgaW5pdCB9IGZyb20gInN2ZWx0ZS1pMThuIjsKICBpbXBvcnQgZW4gZnJvbSAiLi4vLi4vaTE4bi90cmFuc2xhdGlvbi5qc29uIjsKCiAgaW1wb3J0IFRvYXN0c0NvbXBvbmVudCBmcm9tICIuLi9jb21wb25lbnRzL3RvYXN0cy1jb21wb25lbnQuc3ZlbHRlIjsKICBpbXBvcnQgeyBjbGVhckFsbFRvYXN0cyB9IGZyb20gIi4uL3N0b3Jlcy90b2FzdHMiOwoKICBpbXBvcnQgU2ltcGxlRGlzbWlzc01vZGFsIGZyb20gIi4uL2NvbXBvbmVudHMvX3NoYXJlZC9tb2RhbC9zaW1wbGUtZGlzbWlzcy1tb2RhbC5zdmVsdGUiOwoKICBjbGVhckFsbFRvYXN0cygpOwoKICBhZGRNZXNzYWdlcygiZW4iLCBlbik7CgogIGluaXQoewogICAgZmFsbGJhY2tMb2NhbGU6ICJlbiIsCiAgICBpbml0aWFsTG9jYWxlOiAiZW4iLAogIH0pOwoKICBsZXQgaW5uZXJXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogIGxldCBldmVudHM6IHsgc3RhcnQ6IHN0cmluZyB9W10gPSBbXTsKICBsZXQgc2VsZWN0ZWRSYXBwb3J0czogYW55ID0gW107CiAgbGV0IHNlbGVjdGVkRGF0ZTogc3RyaW5nID0gZGF5anMoKS5mb3JtYXQoKTsKICBsZXQgc2VsZWN0ZWRTdGFydFRpbWU6IHN0cmluZyA9ICIiOwogIGxldCByYXBwb3J0VG9VcGRhdGVJZDogc3RyaW5nID0gIiI7CgogIGxldCBvcHRpb25zOiBDYWxlbmRhck9wdGlvbnMgPSB7CiAgICBpbml0aWFsVmlldzogImRheUdyaWRNb250aCIsCiAgICBwbHVnaW5zOiBbZGF5Z3JpZFBsdWdpbiwgaW50ZXJhY3Rpb25QbHVnaW5dLAogICAgZmlyc3REYXk6IDEsCiAgICBoZWlnaHQ6ICIxMDAlIiwKICB9OwoKICBleHBvcnQgbGV0IHNjaGVtYTogYW55ID0ge307CgogIC8vIGNoYW5nZSBzaG93Q2FsIHZhbHVlIGJhc2VkIG9uIHdpbmRvdyBzaXplIGFuZCByZXJlbmRlciBjYWxlbmRhcgogICQ6IGlmIChpbm5lcldpZHRoID4gNzY4KSB7CiAgICBzaG93Q2FsID0gdHJ1ZTsKICB9CiAgJDogaWYgKGlubmVyV2lkdGggPCA3NjgpIHsKICAgIHNob3dDYWwgPSBmYWxzZTsKICB9CgogIC8vIG9uIGlubmVyV2lkdGggY2hhbmdlLCBjaGFuZ2Ugb3B0aW9ucyBhbmQgcmVyZW5kZXIgY2FsZW5kYXIKICAkOiB7CiAgICBpbm5lcldpZHRoOwogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgIH07CiAgfQogICQ6IHsKICAgIHNob3dDYWw7CiAgICBvcHRpb25zID0gewogICAgICAuLi5vcHRpb25zLAogICAgfTsKICB9CgogIGxldCBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogIGxldCBzaG93RWRpdEZvcm0gPSBmYWxzZTsKICBsZXQgc2hvd0NhbCA9IGZhbHNlOwogIGxldCBzZWxlY3RlZER1cmF0aW9uOiBzdHJpbmcgPSAiIjsKICBsZXQgc2hvd1ZpZXdGcm9tID0gZmFsc2U7CgogIGxldCBzZWxlY3RlZFRyYWluZXI6IGFueSA9ICIiOwoKICBsZXQgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwoKICBsZXQgdXBkYXRlUmFwcG9ydHMgPSBhc3luYyAoKSA9PiB7CiAgICAvLyBnZXQgdGhlIGxpc3Qgb2YgcmFwcG9ydHMgZm9yIHRoZSBzZWxlY3RlZCB0cmFpbmVyCiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidHJhaW5lciIsIEpTT04uc3RyaW5naWZ5KHNlbGVjdGVkVHJhaW5lcikpOwoKICAgIGlmIChzZWxlY3RlZFRyYWluZXI/LnZhbHVlKSB7CiAgICAgIFVSTCA9IGAke3Byb2Nlc3MuZW52LlNWRUxURV9BUFBfUkVNT1RFX1VSTH0vYXBpL3JhcHBvcnRzP2ZpbHRlcj17ImluY2x1ZGUiOlsidHJhaW5lciIsInBsYXR6Iiwia3VuZGVzIiwiZ3J1cHBlIl0sIndoZXJlIjp7InRyYWluZXJJZCI6JHtzZWxlY3RlZFRyYWluZXIudmFsdWV9fX1gOwogICAgfSBlbHNlIHsKICAgICAgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwogICAgfQoKICAgIGxldCByYXBwb3J0cyA9IGF3YWl0IGZldGNoKFVSTCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJhcHBvcnRzLmpzb24oKTsKCiAgICBldmVudHMgPSBkYXRhLm1hcCgocjogYW55KSA9PiAoewogICAgICBzdGFydDogZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIiksCiAgICAgIGRpc3BsYXk6ICJiYWNrZ3JvdW5kIiwKICAgICAgYmFja2dyb3VuZENvbG9yOiAiI2ZhNzI1MiIsCiAgICB9KSk7CgogICAgLy8gdXBkYXRlIGNhbGVuZGFyIG9wdGlvbnMgdG8gcmVuZGVyIHRoZSB1cGRhdGVkIGV2ZW50cwogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgICAgZXZlbnRzOiBldmVudHMsCiAgICB9OwoKICAgIGlmIChzZWxlY3RlZERhdGUpIHsKICAgICAgc2VsZWN0ZWRSYXBwb3J0cyA9IGRhdGEuZmlsdGVyKChyOiBhbnkpID0+IHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIikgPT0KICAgICAgICAgIGRheWpzKHNlbGVjdGVkRGF0ZSkuZm9ybWF0KCJZWVlZLU1NLUREIikKICAgICAgICApOwogICAgICB9KTsKICAgICAgc2VsZWN0ZWRSYXBwb3J0cyA9IHNlbGVjdGVkUmFwcG9ydHM7CiAgICB9CiAgfTsKCiAgbGV0IGZldGNoUmFwcG9ydCA9IGFzeW5jICgpID0+IHsKICAgIC8vIHJlcXVlc3QgZm9yIHRoZSBsaXN0IG9mIHJhcG9ydHMgZm9yIHRoYXQgbW9udGggcG9wdWxhdGUgaXQgaW4gdGhlIGNhbGVuZGFyCiAgICBsZXQgc2F2ZWRUcmFpbmVyOiB7CiAgICAgIHZhbHVlOiBudW1iZXI7CiAgICAgIGxhYmVsOiBzdHJpbmc7CiAgICB9ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidHJhaW5lciIpIHx8ICJ7fSIpOwoKICAgIGlmIChzYXZlZFRyYWluZXI/LnZhbHVlKSB7CiAgICAgIFVSTCA9IGAke3Byb2Nlc3MuZW52LlNWRUxURV9BUFBfUkVNT1RFX1VSTH0vYXBpL3JhcHBvcnRzP2ZpbHRlcj17ImluY2x1ZGUiOlsidHJhaW5lciIsInBsYXR6Iiwia3VuZGVzIiwiZ3J1cHBlIl0sIndoZXJlIjp7InRyYWluZXJJZCI6JHtzYXZlZFRyYWluZXIudmFsdWV9fX1gOwogICAgfSBlbHNlIHsKICAgICAgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwogICAgfQoKICAgIGxldCByYXBwb3J0cyA9IGF3YWl0IGZldGNoKFVSTCk7CiAgICBhd2FpdCB0aWNrKCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJhcHBvcnRzLmpzb24oKTsKCiAgICBldmVudHMgPSBkYXRhLm1hcCgocjogYW55KSA9PiAoewogICAgICBzdGFydDogZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIiksCiAgICAgIGRpc3BsYXk6ICJiYWNrZ3JvdW5kIiwKICAgICAgYmFja2dyb3VuZENvbG9yOiAiI2ZhNzI1MiIsIC8vYWNjZW50IGNvbG9yIGZvciB0aGUgY2FsZW5kYXIKICAgIH0pKTsKCiAgICBzZWxlY3RlZFJhcHBvcnRzID0gZGF0YS5maWx0ZXIoKHI6IGFueSkgPT4gewogICAgICByZXR1cm4gKAogICAgICAgIGRheWpzKHIuZGF0dW0pLmZvcm1hdCgiWVlZWS1NTS1ERCIpID09CiAgICAgICAgZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKQogICAgICApOwogICAgfSk7CgogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgICAgZXZlbnRzOiBldmVudHMsCiAgICAgIGV2ZW50Q2xpY2s6IGFzeW5jIGZ1bmN0aW9uIChpbmZvOiBhbnkpIHsKICAgICAgICBzZWxlY3RlZERhdGUgPSBkYXlqcyhpbmZvLmV2ZW50LnN0YXJ0KS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICBhd2FpdCB1cGRhdGVSYXBwb3J0cygpOwogICAgICAgIC8vIGhpZGUgdGhlIGNhbGVuZGFyCiAgICAgICAgc2hvd0NhbCA9IGZhbHNlOwogICAgICB9LAogICAgICBkYXRlQ2xpY2s6IGZ1bmN0aW9uIChpbmZvOiBhbnkpIHsKICAgICAgICBzZWxlY3RlZERhdGUgPSBkYXlqcyhpbmZvLmRhdGVTdHIpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgIHNob3dDYWwgPSBmYWxzZTsKICAgICAgfSwKICAgICAgZGF5Q2VsbENsYXNzTmFtZXM6IChhcmc6IERheUNlbGxDb250ZW50QXJnKSA9PiB7CiAgICAgICAgaWYgKAogICAgICAgICAgZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKSA9PT0KICAgICAgICAgIGRheWpzKGFyZy5kYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKQogICAgICAgICkgewogICAgICAgICAgcmV0dXJuIFsic2VsZWN0ZWQtZGF5LWNlbGwiXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9LAogICAgICBmaXJzdERheTogMSwKCiAgICAgIHdpbmRvd1Jlc2l6ZTogKGluZm86IHsgdmlldzogVmlld0FwaSB9KSA9PiB7CiAgICAgICAgaW5mby52aWV3LmNhbGVuZGFyLnVwZGF0ZVNpemUoKTsKICAgICAgfSwKICAgICAgaGFuZGxlV2luZG93UmVzaXplOiB0cnVlLAogICAgfTsKICB9OwogICQ6IHsKICAgIHNlbGVjdGVkRGF0ZTsKICAgIGZldGNoUmFwcG9ydCgpOwogIH0KICBvbk1vdW50KCgpID0+IHsKICAgIGZldGNoUmFwcG9ydCgpOwogICAgZmV0Y2hUcmFpbmVyRnJvbVRva2VuKCk7CiAgfSk7CgogIC8vIHJlLWV4ZWN1dGUgdGhlIGZldGNoUmFwcG9ydCBmdW5jdGlvbiBldmVyeSB0aW1lIHNob3dDcmVhdGVGb3JtIGFuZCBzaG93RWRpdEZvcm0gaXMgZmFsc2UKICAkOiB7CiAgICBpZiAoCiAgICAgIHNob3dDcmVhdGVGb3JtID09PSBmYWxzZSAmJgogICAgICBzaG93RWRpdEZvcm0gPT09IGZhbHNlICYmCiAgICAgIHNob3dDcmVhdGVGb3JtID09PSBmYWxzZQogICAgKSB7CiAgICAgIGZldGNoUmFwcG9ydCgpOwogICAgfQogIH0KCiAgbGV0IGNsb3NlQ29uZmlybWF0aW9uID0gZmFsc2U7CgogIGxldCB1bnNhdmVkQ2hhbmdlcyA9IGZhbHNlOwoKICBsZXQgZXNjRnVuY3Rpb24gPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHsKICAgIGlmIChldmVudC5rZXkgPT09ICJFc2NhcGUiKSB7CiAgICAgIGlmICh1bnNhdmVkQ2hhbmdlcykgewogICAgICAgIGNsb3NlQ29uZmlybWF0aW9uID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogICAgICAgIHNob3dFZGl0Rm9ybSA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfTsKCiAgLy8gbGlzdGVuIGZvciBhbnkgaW5wdXQgY2hhbmdlcyBhbmQgc2V0IHRoZSB1bnNhdmVkQ2hhbmdlcyB0byB0cnVlIGlmIHRoZXJlIGFyZSBhbnkgY2hhbmdlcwogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsICgpID0+IHsKICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICB9KTsKCiAgLy8gbGlzdGVuIGZvciBhbnkgc2VsZWN0IG9wdGlvbnMgY2hhbmdlIGFuZCBzZXQgdGhlIHVuc2F2ZWRDaGFuZ2VzIHRvIHRydWUgaWYgdGhlcmUgYXJlIGFueSBjaGFuZ2VzCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsICgpID0+IHsKICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICB9KTsKCiAgJDogewogICAgY29uc3Qgc2VsZWN0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzZWxlY3QiKTsKCiAgICBmb3IgKGxldCBzZWxlY3Qgb2Ygc2VsZWN0cykgewogICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKCkgPT4gewogICAgICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICAgICAgfSk7CiAgICB9CiAgfQoKICAvLyBsaXN0ZW4gZm9yIGFueSBzdWJtaXQgY2hhbmdlcyBhbmQgc2V0IHRoZSB1bnNhdmVkQ2hhbmdlcyB0byBmYWxzZQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzdWJtaXQiLCAoKSA9PiB7CiAgICB1bnNhdmVkQ2hhbmdlcyA9IGZhbHNlOwogIH0pOwoKICAvLyBsaXN0ZW4gZm9yIGVzYyBrZXkgcHJlc3MgYW5kIGNsb3NlIHRoZSBjb25maXJtYXRpb24gbW9kYWwKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGVzY0Z1bmN0aW9uLCBmYWxzZSk7CgogIC8qKgogICAqIHNlbGVjdGVkIHRyYWluZXIgY29udGFpbnMgdmFsdWUgYW5kIGxhYmVsIG9mIHRoZSBzZWxlY3RlZCB0cmFpbmVyCiAgICogKiovCgogIC8vIGNoZWNrIGlmIHRoZSBjdXJyZW50IHVybCBpcyBpbiB0aGUgL2FkbWluIHBhdGggYW5kIGlmIGl0IGlzIHRoZW4gc2hvdyB0aGUgYWRtaW4gbWVudQogIC8vIFRPRE86IGFkZCBhIHByb3BlciBjaGVjayBmb3IgdGhlIGFkbWluIHVzZXIKICBsZXQgaXNBZG1pbiA9IGZhbHNlOwogICQ6IHsKICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoIi9hZG1pbiIpKSB7CiAgICAgIGlzQWRtaW4gPSB0cnVlOwogICAgfQogIH0KCiAgLy8gIGdldCB0aGUgY3VycmVudCB1cmwgc2VhcmNoIHF1ZXJ5IGFuZCBjaGVjayBmb3IgdHJhaW5lciBhbmQgdHJhaW5lck5hbWUgcXVlcnkgc3RyaW5ncwoKICBsZXQgdHJhaW5lcklkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7CiAgbGV0IHRyYWluZXJOYW1lOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7CiAgLy8gZ2V0IHRva2VuIGZyb20gbG9jYWwgc3RvcmFnZQogIC8vIGxldCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogIC8vIHRoZW4gZmV0Y2ggdHJhaW5lciBkYXRhIHdoZXJlIHRva2VuIGlzIGVxdWFsIHRvIHRoZSB0b2tlbiBpbiB0aGUgbG9jYWwgc3RvcmFnZQogIGNvbnN0IGZldGNoVHJhaW5lckZyb21Ub2tlbiA9IGFzeW5jICgpID0+IHsKICAgIGxldCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgbGV0IHRyYWluZXIgPSBhd2FpdCBmZXRjaCgKICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvdHJhaW5lcnM/ZmlsdGVyPXsid2hlcmUiOnsidG9rZW4iOiIke3Rva2VufSJ9fWAKICAgICk7CiAgICBhd2FpdCB0aWNrKCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHRyYWluZXIuanNvbigpOwoKICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHsKICAgICAgdHJhaW5lcklkID0gZGF0YVswXS5pZDsKICAgICAgdHJhaW5lck5hbWUgPSBkYXRhWzBdLm5hbWU7CiAgICB9CiAgfTsKCiAgJDogewogICAgaWYgKHRyYWluZXJJZCAmJiB0cmFpbmVyTmFtZSkgewogICAgICBzZWxlY3RlZFRyYWluZXIgPSB7CiAgICAgICAgdmFsdWU6IHRyYWluZXJJZCwKICAgICAgICBsYWJlbDogdHJhaW5lck5hbWUsCiAgICAgIH07CiAgICAgIHVwZGF0ZVJhcHBvcnRzKCk7CiAgICB9CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGNoZWNrSWZUcmFpbmluZ0VkaXRhYmxlKAogICAgdHJhaW5pbmdEYXRlOiBEYXRlLAogICAgaXNBZG1pbjogYm9vbGVhbiwKICAgIGlzQXJjaGl2ZWQ/OiBib29sZWFuLAogICAgaW52b2ljZWRJbj86IGJvb2xlYW4KICApOiBQcm9taXNlPGJvb2xlYW4+IHsKICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKICAgIGNvbnN0IGRlYWRsaW5lID0gbmV3IERhdGUodHJhaW5pbmdEYXRlKTsKICAgIGRlYWRsaW5lLnNldERhdGUodHJhaW5pbmdEYXRlLmdldERhdGUoKSArIDEpOwogICAgZGVhZGxpbmUuc2V0SG91cnMoMTQsIDAsIDAsIDApOwoKICAgIGlmIChpc0FkbWluKSB7CiAgICAgIGlmIChpc0FyY2hpdmVkIHx8IGludm9pY2VkSW4pIHsKICAgICAgICAvKioKICAgICAgICAgKiBmZXRjaCB0aGUgZGF0YSBmcm9tIC9hcGkvaW52b2ljZS1nZW5lcmF0aW9uLWNvbmZpZ3MvMwogICAgICAgICAqIGNoZWNrIGlmIGRhdGEuY29uZmlnVmFsdWUgaXMgdHJ1ZSBvciBmYWxzZSBhbmQgcmV0dXJuIHRoZSB2YWx1ZQogICAgICAgICAqIHRoaXMgaXMgdG8gY2hlY2sgaWYgaGlzdG9yeSBpcyBlZGl0YWJsZSBmb3IgdGhlIGFkbWluCiAgICAgICAgICogbmV3IGhpc3Rvcnkgc2hvdWxkIG5vdCBiZSBlZGl0YWJsZQogICAgICAgICAqKi8KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKAogICAgICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvaW52b2ljZS1nZW5lcmF0aW9uLWNvbmZpZ3MvM2AKICAgICAgICApOwogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CgogICAgICAgIHJldHVybiBkYXRhLmNvbmZpZ1ZhbHVlID09PSAidHJ1ZSIgPyBmYWxzZSA6IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBjdXJyZW50RGF0ZSA8IGRlYWRsaW5lOwogICAgfQogIH0KPC9zY3JpcHQ+Cgo8c3ZlbHRlOndpbmRvdyBiaW5kOmlubmVyV2lkdGggLz4KCnsjaWYgY2xvc2VDb25maXJtYXRpb24gJiYgKHNob3dDcmVhdGVGb3JtIHx8IHNob3dFZGl0Rm9ybSB8fCBzaG93Vmlld0Zyb20pfQogIDxTaW1wbGVEaXNtaXNzTW9kYWwKICAgIG9uOmNsb3NlPXsoKSA9PiAoY2xvc2VDb25maXJtYXRpb24gPSBmYWxzZSl9CiAgICBvbjpzZWNvbmRhcnk9eygpID0+IChjbG9zZUNvbmZpcm1hdGlvbiA9IGZhbHNlKX0KICAgIG9uOmFjdGl2ZT17KCkgPT4gewogICAgICBjbG9zZUNvbmZpcm1hdGlvbiA9IGZhbHNlOwogICAgICBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogICAgICBzaG93RWRpdEZvcm0gPSBmYWxzZTsKICAgICAgc2hvd1ZpZXdGcm9tID0gZmFsc2U7CiAgICAgIHVuc2F2ZWRDaGFuZ2VzID0gZmFsc2U7CiAgICB9fQogIC8+CnsvaWZ9Cgp7I2lmIHNob3dDcmVhdGVGb3JtfQogIDxkaXYKICAgIGNsYXNzPSJmaXhlZCB3LWZ1bGwgaC1zY3JlZW4gei0xMCBmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBpbnNldC0wIGJnLWdyYXktNTAwIGJnLW9wYWNpdHktNzUgdHJhbnNpdGlvbi1vcGFjaXR5IgogID4KICAgIDxDcmVhdGVFdmVudAogICAgICB7c2NoZW1hfQogICAgICB7c2VsZWN0ZWREYXRlfQogICAgICB7c2VsZWN0ZWRTdGFydFRpbWV9CiAgICAgIHtzZWxlY3RlZER1cmF0aW9ufQogICAgICBjbG9zZVBvcHVwPXsoKSA9PiB7CiAgICAgICAgLy8gaWYgdW5zYXZlZCBjaGFuZ2VzLCBzaG93IGNvbmZpcm1hdGlvbiBtb2RhbAogICAgICAgIGlmICh1bnNhdmVkQ2hhbmdlcykgewogICAgICAgICAgY2xvc2VDb25maXJtYXRpb24gPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfX0KICAgIC8+CiAgPC9kaXY+CnsvaWZ9Cgp7I2lmIHNob3dFZGl0Rm9ybSB8fCBzaG93Vmlld0Zyb219CiAgPGRpdgogICAgY2xhc3M9ImZpeGVkIHctZnVsbCBoLXNjcmVlbiB6LTEwIGZsZXgganVzdGlmeS1jZW50ZXIgaXRlbXMtY2VudGVyIGluc2V0LTAgYmctZ3JheS01MDAgYmctb3BhY2l0eS03NSB0cmFuc2l0aW9uLW9wYWNpdHkiCiAgPgogICAgPFVwZGF0ZUV2ZW50CiAgICAgIHtzY2hlbWF9CiAgICAgIGlkPXtyYXBwb3J0VG9VcGRhdGVJZH0KICAgICAgb246ZGVsZXRlZD17KCkgPT4gewogICAgICAgIHNob3dFZGl0Rm9ybSA9IGZhbHNlOwogICAgICB9fQogICAgICBjbG9zZVBvcHVwPXsoKSA9PiB7CiAgICAgICAgaWYgKHVuc2F2ZWRDaGFuZ2VzKSB7CiAgICAgICAgICBjbG9zZUNvbmZpcm1hdGlvbiA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNob3dFZGl0Rm9ybSA9IGZhbHNlOwogICAgICAgICAgc2hvd1ZpZXdGcm9tID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9fQogICAgICBpc1ZpZXdPbmx5PXtzaG93Vmlld0Zyb219CiAgICAvPgogIDwvZGl2Pgp7L2lmfQoKPGRpdiBjbGFzcz0iZ3JpZCBncmlkLWNvbHMtMiBwLTQgYmctcHJpbWFyeS01MCI+CiAgPGRpdj4KICAgIDwhLS0gb24gbW9iaWxlIHZpZXcgaWYgdXNlciBpcyBub3QgYWRtaW4gYW5kIHRyYWluZXIgYW5kIHRyYWluZXJOYW1lIGFyZSBzZXQgaGlkZSB0aGUgdmlkZSAtLT4KICAgIHsjaWYgaXNBZG1pbn0KICAgICAgPFRyYWluZXJEcm9wRG93bgogICAgICAgIGJpbmQ6c2VsZWN0ZWRWYWx1ZT17c2VsZWN0ZWRUcmFpbmVyfQogICAgICAgIG9uOnVwZGF0ZVRyYWluZXI9e3VwZGF0ZVJhcHBvcnRzfQogICAgICAvPgogICAgey9pZn0KICA8L2Rpdj4KCiAgPGRpdiBjbGFzcz0iIGZsZXgganVzdGlmeS1lbmQiPgogICAgPGJ1dHRvbgogICAgICBjbGFzcz0icm91bmRlZC1mdWxsICFiZy1wcmltYXJ5LTUwMCBob3ZlcjohYmctcHJpbWFyeS02MDAgdy04IGgtOCBmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciIKICAgICAgb246Y2xpY2s9eygpID0+IHsKICAgICAgICBzaG93Q3JlYXRlRm9ybSA9ICFzaG93Q3JlYXRlRm9ybTsKICAgICAgfX0KICAgID4KICAgICAgPHN2ZwogICAgICAgIHdpZHRoPSIyNCIKICAgICAgICBoZWlnaHQ9IjI0IgogICAgICAgIHZpZXdCb3g9IjAgMCAyNCAyNCIKICAgICAgICBmaWxsPSJub25lIgogICAgICAgIHN0cm9rZT0id2hpdGUiCiAgICAgICAgc3Ryb2tlLXdpZHRoPSIyIgogICAgICAgIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIKICAgICAgICBzdHJva2UtbGluZWpvaW49InJvdW5kIgogICAgICAgID48bGluZSB4MT0iMTIiIHkxPSI1IiB4Mj0iMTIiIHkyPSIxOSIgLz48bGluZQogICAgICAgICAgeDE9IjUiCiAgICAgICAgICB5MT0iMTIiCiAgICAgICAgICB4Mj0iMTkiCiAgICAgICAgICB5Mj0iMTIiCiAgICAgICAgLz48L3N2ZwogICAgICA+CiAgICA8L2J1dHRvbj4KICA8L2Rpdj4KPC9kaXY+Cgo8ZGl2IGNsYXNzPSJtYXgtdy03eGwgbXgtYXV0byByZWxhdGl2ZSI+CiAgPGRpdiBjbGFzcz0iZ3JpZCBtZDpncmlkLWNvbHMtMiByZWxhdGl2ZSI+CiAgICB7I2lmICFzaG93Q2FsfQogICAgICA8ZGl2CiAgICAgICAgY2xhc3M9Im1kOmhpZGRlbiBweC00IG14LWF1dG8gbXQtNCB3LWZ1bGwgZmxleC1jb2wgZmxleCBmbGV4LXdyYXAgc3BhY2UteS00IgogICAgICA+CiAgICAgICAgPGJ1dHRvbgogICAgICAgICAgY2xhc3M9ImZjLXRvZGF5LWJ1dHRvbiB0ZXh0LXdoaXRlIHB4LTQgc2VsZi1jZW50ZXIgcHktMiByb3VuZGVkIgogICAgICAgICAgb246Y2xpY2s9eygpID0+IHsKICAgICAgICAgICAgLy8gc2V0IHNlbGVjdGVkRGF0ZSB0byB0b2RheQogICAgICAgICAgICBzZWxlY3RlZERhdGUgPSBkYXlqcygpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgICAgfX0+VG9kYXk8L2J1dHRvbgogICAgICAgID4KICAgICAgICA8ZGl2CiAgICAgICAgICBjbGFzcz0iZmxleC0xIGZsZXggZmxleC13cmFwIGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBzcGFjZS14LTIiCiAgICAgICAgPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5zdWJ0cmFjdCgyLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0iLTIgZGF5cyAiCiAgICAgICAgICA+CiAgICAgICAgICAgIDxzdmcKICAgICAgICAgICAgICB3aWR0aD0iMjAiCiAgICAgICAgICAgICAgaGVpZ2h0PSIyMCIKICAgICAgICAgICAgICBmaWxsPSJjdXJyZW50Q29sb3IiCiAgICAgICAgICAgICAgY2xhc3M9ImJpIGJpLWNoZXZyb24tZG91YmxlLWxlZnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik04LjM1NCAxLjY0NmEuNS41IDAgMCAxIDAgLjcwOEwyLjcwNyA4bDUuNjQ3IDUuNjQ2YS41LjUgMCAwIDEtLjcwOC43MDhsLTYtNmEuNS41IDAgMCAxIDAtLjcwOGw2LTZhLjUuNSAwIDAgMSAuNzA4IDB6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0xMi4zNTQgMS42NDZhLjUuNSAwIDAgMSAwIC43MDhMNi43MDcgOGw1LjY0NyA1LjY0NmEuNS41IDAgMCAxLS43MDguNzA4bC02LTZhLjUuNSAwIDAgMSAwLS43MDhsNi02YS41LjUgMCAwIDEgLjcwOCAweiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5zdWJ0cmFjdCgxLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0icHJldmlvdXMgZGF5IgogICAgICAgICAgPgogICAgICAgICAgICA8c3ZnCiAgICAgICAgICAgICAgd2lkdGg9IjIwIgogICAgICAgICAgICAgIGhlaWdodD0iMjAiCiAgICAgICAgICAgICAgZmlsbD0iY3VycmVudENvbG9yIgogICAgICAgICAgICAgIGNsYXNzPSJiaSBiaS1jaGV2cm9uLWxlZnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0xMS4zNTQgMS42NDZhLjUuNSAwIDAgMSAwIC43MDhMNS43MDcgOGw1LjY0NyA1LjY0NmEuNS41IDAgMCAxLS43MDguNzA4bC02LTZhLjUuNSAwIDAgMSAwLS43MDhsNi02YS41LjUgMCAwIDEgLjcwOCAweiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNob3dDYWwgPSAhc2hvd0NhbDsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQgcC00IGJvcmRlci0yIgogICAgICAgICAgPgogICAgICAgICAgICB7ZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIkRELk1NLllZWVkiKX0KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5hZGQoMSwgImRheSIpCiAgICAgICAgICAgICAgICAuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgICAgIH19CiAgICAgICAgICAgIGNsYXNzPSJyb3VuZGVkLWZ1bGwgYmctcHJpbWFyeS01MCBwLTMgdGV4dC1wcmltYXJ5LTUwMCIKICAgICAgICAgICAgdGl0bGU9Im5leHQgZGF5IgogICAgICAgICAgPgogICAgICAgICAgICA8c3ZnCiAgICAgICAgICAgICAgd2lkdGg9IjIwIgogICAgICAgICAgICAgIGhlaWdodD0iMjAiCiAgICAgICAgICAgICAgZmlsbD0iY3VycmVudENvbG9yIgogICAgICAgICAgICAgIGNsYXNzPSJiaSBiaS1jaGV2cm9uLXJpZ2h0IgogICAgICAgICAgICAgIHZpZXdCb3g9IjAgMCAxNiAxNiIKICAgICAgICAgICAgPgogICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgICAgICAgICAgICBkPSJNNC42NDYgMS42NDZhLjUuNSAwIDAgMSAuNzA4IDBsNiA2YS41LjUgMCAwIDEgMCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4LS43MDhMMTAuMjkzIDggNC42NDYgMi4zNTRhLjUuNSAwIDAgMSAwLS43MDh6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uCiAgICAgICAgICAgIG9uOmNsaWNrPXsoKSA9PiB7CiAgICAgICAgICAgICAgc2VsZWN0ZWREYXRlID0gZGF5anMoc2VsZWN0ZWREYXRlKQogICAgICAgICAgICAgICAgLmFkZCgyLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0iKzIgZGF5cyIKICAgICAgICAgID4KICAgICAgICAgICAgPHN2ZwogICAgICAgICAgICAgIHdpZHRoPSIyMCIKICAgICAgICAgICAgICBoZWlnaHQ9IjIwIgogICAgICAgICAgICAgIGZpbGw9ImJnLXByaW1hcnktNTAwIgogICAgICAgICAgICAgIGNsYXNzPSJmaWxsLWN1cnJlbnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0zLjY0NiAxLjY0NmEuNS41IDAgMCAxIC43MDggMGw2IDZhLjUuNSAwIDAgMSAwIC43MDhsLTYgNmEuNS41IDAgMCAxLS43MDgtLjcwOEw5LjI5MyA4IDMuNjQ2IDIuMzU0YS41LjUgMCAwIDEgMC0uNzA4eiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgICAgICAgICAgICBkPSJNNy42NDYgMS42NDZhLjUuNSAwIDAgMSAuNzA4IDBsNiA2YS41LjUgMCAwIDEgMCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4LS43MDhMMTMuMjkzIDggNy42NDYgMi4zNTRhLjUuNSAwIDAgMSAwLS43MDh6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgey9pZn0KCiAgICA8ZGl2IGNsYXNzPSIge3Nob3dDYWwgPyAnYmxvY2snIDogJ2hpZGRlbid9IG1kOmJsb2NrIGgtW2NhbGMoMTAwdmgtNzRweCldIj4KICAgICAgPGRpdgogICAgICAgIGNsYXNzPSJhYnNvbHV0ZSB0b3AtMCByaWdodC0wIGxlZnQtMCBib3R0b20tMCBzbTp2aXNpYmxlIHNtOm10LTAgbWQ6cmVsYXRpdmUiCiAgICAgID4KICAgICAgICA8RnVsbENhbGVuZGFyCiAgICAgICAgICB7b3B0aW9uc30KICAgICAgICAgIGNsYXNzPSJwLTQgbWF4LXctc2NyZWVuLWxnIG1kOm14LWF1dG8gbWluLWgtZnVsbCIKICAgICAgICAvPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYKICAgICAgY2xhc3M9IntzZWxlY3RlZERhdGUgJiYgIXNob3dDYWwKICAgICAgICA/ICdibG9jaycKICAgICAgICA6ICdoaWRkZW4nfSBtZDpibG9jayBtZDpoLVtjYWxjKDEwMHZoLTIwMHB4KV0gaC1bY2FsYygxMDB2aC0xNTBweCldIgogICAgPgogICAgICA8U2luZ2xlRGF5CiAgICAgICAgYmluZDpyYXBvcnRzPXtzZWxlY3RlZFJhcHBvcnRzfQogICAgICAgIGJpbmQ6c2VsZWN0ZWREYXRlCiAgICAgICAgYmluZDpzZWxlY3RlZFRyYWluZXIKICAgICAgICBvbjpldmVudENsaWNrZWQ9e2FzeW5jIChpbmZvKSA9PiB7CiAgICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9CiAgICAgICAgICAgIGluZm8uZGV0YWlsLmV2ZW50Ll9kZWYuZXh0ZW5kZWRQcm9wcy5yYXBwb3J0LmRhdHVtOwogICAgICAgICAgY29uc3QgdHJhaW5pbmdEYXRlID0gbmV3IERhdGUoY3VycmVudERhdGUpOwogICAgICAgICAgY29uc3QgaXNFZGl0YWJsZSA9IGF3YWl0IGNoZWNrSWZUcmFpbmluZ0VkaXRhYmxlKAogICAgICAgICAgICB0cmFpbmluZ0RhdGUsCiAgICAgICAgICAgIGlzQWRtaW4sCiAgICAgICAgICAgICEhaW5mby5kZXRhaWwuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLnJhcHBvcnQuYXJjaGl2ZWQsCiAgICAgICAgICAgICEhaW5mby5kZXRhaWwuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLnJhcHBvcnQuaW52b2ljZWRJbgogICAgICAgICAgKTsKICAgICAgICAgIGlmIChpc0VkaXRhYmxlKSB7CiAgICAgICAgICAgIHNob3dFZGl0Rm9ybSA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzaG93Vmlld0Zyb20gPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIHJhcHBvcnRUb1VwZGF0ZUlkID0gaW5mby5kZXRhaWwuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLnJhcHBvcnQuaWQ7CiAgICAgICAgfX0KICAgICAgICBvbjpkYXRlU2VsZWN0ZWQ9eyhpbmZvKSA9PiB7CiAgICAgICAgICBsZXQgdGltZURpZmYgPSBkYXlqcyhpbmZvLmRldGFpbC5lbmQpLmRpZmYoCiAgICAgICAgICAgIGRheWpzKGluZm8uZGV0YWlsLnN0YXJ0KSwKICAgICAgICAgICAgIm1pbnV0ZSIKICAgICAgICAgICk7CgogICAgICAgICAgLy8gc2VsZWN0ZWREdXJhdGlvbiBzaG91bGQgb25seSBiZSAzMCwgNjAsIDkwLCAxMjAgb25seSBhcHByb3hpbWF0ZSBpdAogICAgICAgICAgaWYgKHRpbWVEaWZmIDwgNzUpIHsKICAgICAgICAgICAgdGltZURpZmYgPSA2MDsKICAgICAgICAgIH0gZWxzZSBpZiAodGltZURpZmYgPCAxMDUpIHsKICAgICAgICAgICAgdGltZURpZmYgPSA5MDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRpbWVEaWZmID0gMTIwOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIGZvcm1hdCB0aW1lRGlmZiB0byBmb3JtYXQgJ2hoOm1tOnNzJwogICAgICAgICAgc2VsZWN0ZWREdXJhdGlvbiA9IGRheWpzKCkKICAgICAgICAgICAgLmhvdXIoMCkKICAgICAgICAgICAgLm1pbnV0ZSh0aW1lRGlmZikKICAgICAgICAgICAgLnNlY29uZCgwKQogICAgICAgICAgICAuZm9ybWF0KCJISDptbTpzcyIpOwogICAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgICAgc2VsZWN0ZWRTdGFydFRpbWUgPSBpbmZvLmRldGFpbC5zdGFydFN0cjsKICAgICAgICAgIHNob3dDcmVhdGVGb3JtID0gdHJ1ZTsKICAgICAgICAgIC8vIHRvZG8gYXV0byBmaWxsIHRoZSBzdGFydCBkYXRlIGFuZCBkdXJhdGlvbiBieSBjYWxjdWxhdGluZyB0aGUgZHVyYXRpb24gd2l0aCBzdGFydCBhbmQgZW5kIGRhdGUKICAgICAgICB9fQogICAgICAvPgogICAgPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPFRvYXN0c0NvbXBvbmVudCAvPgoKPHN0eWxlPgogIC8qIGRldGFpbHMgPiBzdW1tYXJ5IHsKICAgIGxpc3Qtc3R5bGU6IG5vbmU7CiAgfQogIGRldGFpbHMgPiBzdW1tYXJ5Ojotd2Via2l0LWRldGFpbHMtbWFya2VyIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgfQoKICBkZXRhaWxzW29wZW5dIHN1bW1hcnkgfiAqIHsKICAgIGFuaW1hdGlvbjogc3dlZXAgMC4yNXMgZWFzZS1pbi1vdXQ7CiAgfQoKICBAa2V5ZnJhbWVzIHN3ZWVwIHsKICAgIDAlIHsKICAgICAgb3BhY2l0eTogMDsKICAgICAgbWFyZ2luLXRvcDogLTEwcHg7CiAgICB9CiAgICAxMDAlIHsKICAgICAgb3BhY2l0eTogMTsKICAgICAgbWFyZ2luLXRvcDogMHB4OwogICAgfQogIH0gKi8KPC9zdHlsZT4K
      - name: updateEvent
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IFVwZGF0ZUV2ZW50IGZyb20gIi4uL3NlY3Rpb25zL1VwZGF0ZS1PbmUtVmlldy5zdmVsdGUiOwogIGltcG9ydCBTaW5nbGVWaWV3IGZyb20gIi4uL3NlY3Rpb25zL1NpbmdsZS1WaWV3LnN2ZWx0ZSI7CiAgaW1wb3J0IHsgb25Nb3VudCB9IGZyb20gInN2ZWx0ZSI7CgogIGV4cG9ydCBsZXQgY2xvc2VQb3B1cCA9ICgpID0+IHt9OwogIGV4cG9ydCBsZXQgc2NoZW1hOiBhbnkgPSB7fTsKICBleHBvcnQgbGV0IGlkOiBhbnkgPSAiIjsKCiAgZXhwb3J0IGxldCBmb3JtRGF0YTogYW55ID0ge307CgogICQ6IGNvbnNvbGUubG9nKHsgZm9ybURhdGEgfSk7CgogIC8vIGNoZWNrIGlmIHRoZSBzY2hlbWEgaXMgdmlldyBvbmx5IG9yIGVkaXRhYmxlCiAgLy8gdGhpcyBpcyBiYXNlZCBvbiB0aGUgY2hlY2tJZlRyYWluaW5nRWRpdGFibGUgZnVuY3Rpb24gaW4gdGhlIHNyYy9jb21wb25lbnRzL3NoYXJlZC9jYWxlbmRhci5zdmVsdGUgZmlsZQogIC8vIHdoaWNoIGNoZWNrcyBpZiB0aGUgdHJhaW5pbmcgcmFwcG9ydCBpcyBlZGl0YWJsZSBiYXNlZCBvbiB0aGUgaGlzdG9yeSBhbmQgdGhlIGRhdGUgb2YgdGhlIHRyYWluaW5nIGZvciB0aGUgdHJhaW5lcgogIGV4cG9ydCBsZXQgaXNWaWV3T25seSA9IGZhbHNlOwoKICBsZXQgbG9hZGluZyA9IGZhbHNlOwoKICBvbk1vdW50KGFzeW5jICgpID0+IHsKICAgIGxvYWRpbmcgPSB0cnVlOwoKICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApKTsKCiAgICBsZXQga3VuZGVJZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbcGxhY2Vob2xkZXI9Imt1bmRlcyJdJyk7CiAgICAvLyBrdW5kZUlkcz8uY2xpY2soKTsKCiAgICBpZiAoa3VuZGVJZHMpIHsKICAgICAgLy8gQ3JlYXRlIGEgTXV0YXRpb25PYnNlcnZlciBpbnN0YW5jZQogICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnNMaXN0KSA9PiB7CiAgICAgICAgbXV0YXRpb25zTGlzdC5mb3JFYWNoKChtdXRhdGlvbikgPT4gewogICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICJjaGlsZExpc3QiKSB7CiAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDaGlsZCBhZGRlZDoiLCBub2RlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG11dGF0aW9uLnJlbW92ZWROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkNoaWxkIHJlbW92ZWQ6Iiwgbm9kZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICJjaGlsZExpc3QiKSB7CiAgICAgICAgICAgIC8vIGNoZWNrIGZvcm1kYXRhLmt1bmRlSWRzLmxlbmd0aCBhbmQgaWYgbW9yZSB0aGFuIDEsIHNldCB0cmFpbmluZ1R5cGUgdG8gZ3J1cHBlIGFuZCBpZiBpdCBpcyAxIGFuZCB0aGUgcHJldmlvdXMgdmFsdWUgd2FzIGdydXBwZSwgc2V0IGl0IHRvIHByaXZhdGUKICAgICAgICAgICAgaWYgKGZvcm1EYXRhLmt1bmRlSWRzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICBmb3JtRGF0YS50cmFpbmluZ1R5cGUgPSAiZ3J1cHBlIjsKICAgICAgICAgICAgfSBlbHNlIGlmICgKICAgICAgICAgICAgICBmb3JtRGF0YS5rdW5kZUlkcy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICBmb3JtRGF0YS50cmFpbmluZ1R5cGUgPT09ICJncnVwcGUiCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIGZvcm1EYXRhLnRyYWluaW5nVHlwZSA9ICJwcml2YXRlIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKCiAgICAgIC8vIFNldCB0aGUgb2JzZXJ2ZXIgb3B0aW9ucwogICAgICBjb25zdCBvYnNlcnZlckNvbmZpZyA9IHsKICAgICAgICBjaGlsZExpc3Q6IHRydWUsIC8vIExpc3RlbiBmb3IgY2hpbGQgbm9kZXMgYWRkZWQgb3IgcmVtb3ZlZAogICAgICAgIHN1YnRyZWU6IHRydWUsIC8vIE9ic2VydmUgYWxsIGRlc2NlbmRhbnRzIG9mIHRoZSB0YXJnZXQKICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLCAvLyBMaXN0ZW4gZm9yIHRleHQgY29udGVudCBjaGFuZ2VzIGluIHRleHQgbm9kZXMKICAgICAgfTsKCiAgICAgIC8vIFN0YXJ0IG9ic2VydmluZwogICAgICBvYnNlcnZlci5vYnNlcnZlKGt1bmRlSWRzLCBvYnNlcnZlckNvbmZpZyk7CiAgICB9CgogICAgbG9hZGluZyA9IGZhbHNlOwogIH0pOwoKICAvLyBjaGVjayBpZiB1c2VyIGlzIGEgdHJhaW5lcgogIGNvbnN0IGlzVXNlclRyYWluZXIgPSAoKSA9PiB7CiAgICAvLyBUT0RPOiBzZW5kIGEgcmVxdWVzdCB0byB0aGUgYmFja2VuZCB0byB2ZXJpZnkgaWYgdGhlIHRva2VuIGlzIHZhbGlkCiAgICByZXR1cm4gKAogICAgICBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKSB8fCB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluY2x1ZGVzKCJ0b2tlbiIpCiAgICApOwogIH07CgogIHNjaGVtYSA9IHsKICAgIC4uLnNjaGVtYSwKICAgICJmaWVsZC1wcm9wZXJ0aWVzIjogewogICAgICAuLi5zY2hlbWFbImZpZWxkLXByb3BlcnRpZXMiXSwKICAgICAgImhpZGRlbi1maWVsZHMiOiBbImludm9pY2VkSW4iLCAiaW52b2ljZUpzb24iLCAiYXJjaGl2ZWQiXSwKICAgICAgInJlYWRvbmx5LWZpZWxkcyI6IGlzVXNlclRyYWluZXIoKSA/IFsidHJhaW5lciIsICJpZCJdIDogWyJpZCJdLAogICAgICAiZmllbGQtb3JkZXIiOiBbCiAgICAgICAgImRhdHVtIiwKICAgICAgICAic3RhcnR6ZWl0IiwKICAgICAgICAidHJhaW5pbmdzZGF1ZXIiLAogICAgICAgICJ0cmFpbmVyIiwKICAgICAgICAicGxhdHoiLAogICAgICAgICJ0cmFpbmluZ1R5cGUiLAogICAgICAgICJrdW5kZSIsCiAgICAgICAgImt1bmRlSWRzIiwKICAgICAgICAiZ3J1cHBlIiwKICAgICAgICAibm90aXplbiIsCiAgICAgICAgIm5hY2hob2x0ZXJtaW4iLAogICAgICAgICJwcm9iZXRyYWluaW5nIiwKICAgICAgICAiYXJjaGl2ZWQiLAogICAgICAgICJpbnZvaWNlZEluIiwKICAgICAgICAiaW52b2ljZUpzb24iLAogICAgICBdLAogICAgICAiYm9vbGVhbi1maWVsZHMiOiBbInByb2JldHJhaW5pbmciLCAibmFjaGhvbHRlcm1pbiIsICJhcmNoaXZlZCJdLAogICAgICAicmVsYXRpb25hbC1maWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogImt1bmRlSWRzIiwKICAgICAgICAgIHR5cGU6ICJGQVZPUklURSIsCiAgICAgICAgICBlZGl0YWJsZTogdHJ1ZSwKICAgICAgICAgIGNvbHVtbnM6IFsKICAgICAgICAgICAgImlkIiwKICAgICAgICAgICAgImJleGlvSWQiLAogICAgICAgICAgICAibmFtZSIsCiAgICAgICAgICAgICJ2b3JuYW1lIiwKICAgICAgICAgICAgIm9ydCIsCiAgICAgICAgICAgICJnZWJ1cnRzdGFnIiwKICAgICAgICAgICAgInBob25lIiwKICAgICAgICAgICAgInBob25lTW9iaWxlIiwKICAgICAgICAgICAgIm5vdGl6ZW4iLAogICAgICAgICAgXSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJ0cmFpbmVyIiwKICAgICAgICAgIGVkaXRhYmxlOiAhaXNVc2VyVHJhaW5lcigpLAogICAgICAgICAgLy8gY29sdW1uczogWyJpZCIsICJuYW1lIiwgInZvcm5hbWUiLCAiZW1haWwiLCAibm90aXplbiJdLAogICAgICAgICAgY29sdW1uczogWyJpZCIsICJuYW1lIiwgInZvcm5hbWUiLCAiZW1haWwiXSwKICAgICAgICB9LAogICAgICBdLAogICAgICAiY3VzdG9tLXZhbGlkYXRpb25zIjogaXNVc2VyVHJhaW5lcigpCiAgICAgICAgPyBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmaWVsZDogInRyYWluaW5nc2RhdWVyIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVHJhaW5pbmdzZGF1ZXIgY2FuJ3QgYmUgZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIuKlxcUy4qIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZmllbGQ6ICJ0cmFpbmVyIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVHJhaW5lciBjYW4ndCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgICByZWdleDogIi4qXFxTLioiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmaWVsZDogImt1bmRlSWRzIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiS3VuZGUgY2FuJ3QgYmUgZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIuKlxcUy4qIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgXQogICAgICAgIDogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZmllbGQ6ICJ0cmFpbmVyIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVHJhaW5lciBjYW4ndCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgICByZWdleDogIi4qXFxTLioiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmaWVsZDogImt1bmRlSWRzIiwKICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiS3VuZGUgY2FuJ3QgYmUgZW1wdHkiLAogICAgICAgICAgICAgICAgcmVnZXg6ICIuKlxcUy4qIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgXSwKCiAgICAgICJkcm9wZG93bi1maWVsZHMiOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInRyYWluaW5nVHlwZSIsCiAgICAgICAgICBkZWZhdWx0OiB7CiAgICAgICAgICAgIGxhYmVsOiAicHJpdmF0ZSIsCiAgICAgICAgICAgIHZhbHVlOiAicHJpdmF0ZSIsCiAgICAgICAgICB9LAogICAgICAgICAgb3B0aW9uczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICJwcml2YXRlIiwKICAgICAgICAgICAgICB2YWx1ZTogInByaXZhdGUiLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICJncnVwcGUgKHNwb250YW4pIiwKICAgICAgICAgICAgICB2YWx1ZTogImdydXBwZSIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIk1hbm5zY2hhZnRzdHJhaW5pbmcgKG9obmUgUGxhdHptaWV0ZSkiLAogICAgICAgICAgICAgIHZhbHVlOiAibWFubnNjaGFmdCIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIk1hbm5zY2hhZnRzdHJhaW5pbmcgKGlua2wuIFBsYXR6bWlldGUpIiwKICAgICAgICAgICAgICB2YWx1ZTogIm1hbm5zY2hhZnRfcGxhdHoiLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICJBdWZzY2hsYWd0cmFpbmluZyIsCiAgICAgICAgICAgICAgdmFsdWU6ICJhdWZzY2hsYWciLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICJGaXRuZXNzIFRlbm5pcyIsCiAgICAgICAgICAgICAgdmFsdWU6ICJmaXRuZXNzX3Rlbm5pcyIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIk1vcm5pbmcgVHJlZmYiLAogICAgICAgICAgICAgIHZhbHVlOiAibW9ybmluZ190cmVmZiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIkFmdGVyIFdvcmsiLAogICAgICAgICAgICAgIHZhbHVlOiAiYWZ0ZXJfd29yayIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsYWJlbDogIk1pdHRhZ3MgVHJlZmYiLAogICAgICAgICAgICAgIHZhbHVlOiAibWl0dGFnc190cmVmZiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdLAogICAgICAgIH0sCiAgICAgIF0sCiAgICB9LAogIH07Cjwvc2NyaXB0PgoKeyNpZiBsb2FkaW5nfQogIDxkaXYKICAgIGNsYXNzPSJmaXhlZCB6LTEwIGluc2V0LTAgb3ZlcmZsb3cteS1hdXRvIGJnLWJsYWNrIGJnLW9wYWNpdHktNTAiCiAgICBhcmlhLWxhYmVsbGVkYnk9Im1vZGFsLXRpdGxlIgogICAgcm9sZT0iZGlhbG9nIgogICAgYXJpYS1tb2RhbD0idHJ1ZSIKICA+CiAgICA8ZGl2IGNsYXNzPSJmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBoLVs3MHZoXSI+CiAgICAgIDxkaXYKICAgICAgICBjbGFzcz0iYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTMyIHctMzIgYm9yZGVyLXQtMiBib3JkZXItYi0yIGJvcmRlci1ncmF5LTkwMCIKICAgICAgPjwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CnsvaWZ9Cgo8ZGl2IGNsYXNzPSJiZy13aGl0ZSBwLTQgdy1bOTUlXSByb3VuZGVkLXNtIj4KICA8ZGl2IGNsYXNzPSJ0ZXh0LXJpZ2h0IHBiLTQiPgogICAgPGJ1dHRvbgogICAgICBjbGFzcz0idGV4dC1jZW50ZXIgcHktMyBweC02IHNoYWRvdy1zbSBib3JkZXIgYm9yZGVyLWdyYXktMjAwIGhvdmVyOnNoYWRvdy1tZCB0cmFuc2l0aW9uLWFsbCBmb250LXNlbWlib2xkIHJvdW5kZWQtZnVsbCBoLTggdy04ICFwLTAgdGV4dC1sZyIKICAgICAgb246Y2xpY2s9e2Nsb3NlUG9wdXB9CiAgICA+CiAgICAgIDxzdmcKICAgICAgICB3aWR0aD0iMjQiCiAgICAgICAgaGVpZ2h0PSIyNCIKICAgICAgICB2aWV3Qm94PSIwIDAgMjQgMjQiCiAgICAgICAgZmlsbD0ibm9uZSIKICAgICAgICBzdHJva2U9ImN1cnJlbnRDb2xvciIKICAgICAgICBzdHJva2Utd2lkdGg9IjIiCiAgICAgICAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogICAgICAgIHN0cm9rZS1saW5lam9pbj0icm91bmQiCiAgICAgICAgY2xhc3M9ImgtNSB3LTUgaW5saW5lLWJsb2NrIgogICAgICAgID48bGluZSB4MT0iMTgiIHkxPSI2IiB4Mj0iNiIgeTI9IjE4IiAvPjxsaW5lCiAgICAgICAgICB4MT0iNiIKICAgICAgICAgIHkxPSI2IgogICAgICAgICAgeDI9IjE4IgogICAgICAgICAgeTI9IjE4IgogICAgICAgIC8+PC9zdmcKICAgICAgPgogICAgPC9idXR0b24+CiAgPC9kaXY+CiAgPGRpdiBjbGFzcz0ib3ZlcmZsb3ctYXV0byBtYXgtaC1bNzAlXSI+CiAgICB7I2lmICFpc1ZpZXdPbmx5fQogICAgICA8VXBkYXRlRXZlbnQKICAgICAgICBvbjp1cGRhdGU9e2Nsb3NlUG9wdXB9CiAgICAgICAgb246ZGVsZXRlZD17Y2xvc2VQb3B1cH0KICAgICAgICBvcGVyYXRpb25JZD0iUmFwcG9ydENvbnRyb2xsZXIudXBkYXRlQnlJZCIKICAgICAgICB7aWR9CiAgICAgICAge3NjaGVtYX0KICAgICAgICBiaW5kOmZvcm1EYXRhCiAgICAgIC8+CiAgICB7OmVsc2V9CiAgICAgIDxTaW5nbGVWaWV3IG9wZXJhdGlvbklkPSJSYXBwb3J0Q29udHJvbGxlci5maW5kQnlJZCIge2lkfSB7c2NoZW1hfSAvPgogICAgey9pZn0KICA8L2Rpdj4KPC9kaXY+Cg==
      - name: archivedTrainings
        content: PHNjcmlwdCBsYW5nPSJ0cyI+CiAgaW1wb3J0IEZ1bGxDYWxlbmRhciwgewogICAgQ2FsZW5kYXJPcHRpb25zLAogICAgRGF5Q2VsbENvbnRlbnRBcmcsCiAgICBWaWV3QXBpLAogIH0gZnJvbSAic3ZlbHRlLWZ1bGxjYWxlbmRhciI7CgogIGltcG9ydCBkYXlncmlkUGx1Z2luIGZyb20gIkBmdWxsY2FsZW5kYXIvZGF5Z3JpZCI7CiAgaW1wb3J0IGludGVyYWN0aW9uUGx1Z2luIGZyb20gIkBmdWxsY2FsZW5kYXIvaW50ZXJhY3Rpb24iOyAvLyBmb3Igc2VsZWN0YWJsZQogIGltcG9ydCBHbG9iYWwgZnJvbSAiLi4vY29tcG9uZW50cy9nbG9iYWwuc3ZlbHRlIjsKICBHbG9iYWw7CiAgaW1wb3J0IHsgb25Nb3VudCwgdGljayB9IGZyb20gInN2ZWx0ZSI7CiAgaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKICBpbXBvcnQgU2luZ2xlRGF5IGZyb20gIi4vc2luZ2xlRGF5LnN2ZWx0ZSI7CiAgaW1wb3J0IFRyYWluZXJEcm9wRG93biBmcm9tICIuL3RyYWluZXJEcm9wRG93bi5zdmVsdGUiOwogIGltcG9ydCBDcmVhdGVFdmVudCBmcm9tICIuL2NyZWF0ZUV2ZW50LnN2ZWx0ZSI7CiAgaW1wb3J0IFVwZGF0ZUV2ZW50IGZyb20gIi4vdXBkYXRlRXZlbnQuc3ZlbHRlIjsKICBpbXBvcnQgeyBhZGRNZXNzYWdlcywgaW5pdCB9IGZyb20gInN2ZWx0ZS1pMThuIjsKICBpbXBvcnQgZW4gZnJvbSAiLi4vLi4vaTE4bi90cmFuc2xhdGlvbi5qc29uIjsKCiAgaW1wb3J0IFRvYXN0c0NvbXBvbmVudCBmcm9tICIuLi9jb21wb25lbnRzL3RvYXN0cy1jb21wb25lbnQuc3ZlbHRlIjsKICBpbXBvcnQgeyBjbGVhckFsbFRvYXN0cyB9IGZyb20gIi4uL3N0b3Jlcy90b2FzdHMiOwoKICBpbXBvcnQgU2ltcGxlRGlzbWlzc01vZGFsIGZyb20gIi4uL2NvbXBvbmVudHMvX3NoYXJlZC9tb2RhbC9zaW1wbGUtZGlzbWlzcy1tb2RhbC5zdmVsdGUiOwoKICBjbGVhckFsbFRvYXN0cygpOwoKICBhZGRNZXNzYWdlcygiZW4iLCBlbik7CgogIGluaXQoewogICAgZmFsbGJhY2tMb2NhbGU6ICJlbiIsCiAgICBpbml0aWFsTG9jYWxlOiAiZW4iLAogIH0pOwoKICBsZXQgaW5uZXJXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogIGxldCBldmVudHM6IHsgc3RhcnQ6IHN0cmluZyB9W10gPSBbXTsKICBsZXQgc2VsZWN0ZWRSYXBwb3J0czogYW55ID0gW107CiAgbGV0IHNlbGVjdGVkRGF0ZTogc3RyaW5nID0gZGF5anMoKS5mb3JtYXQoKTsKICBsZXQgcmFwcG9ydFRvVXBkYXRlSWQ6IHN0cmluZyA9ICIiOwoKICBsZXQgb3B0aW9uczogQ2FsZW5kYXJPcHRpb25zID0gewogICAgaW5pdGlhbFZpZXc6ICJkYXlHcmlkTW9udGgiLAogICAgcGx1Z2luczogW2RheWdyaWRQbHVnaW4sIGludGVyYWN0aW9uUGx1Z2luXSwKICAgIGZpcnN0RGF5OiAxLAogICAgaGVpZ2h0OiAiMTAwJSIsCiAgfTsKCiAgLy8gICBleHBvcnQgbGV0IHNjaGVtYTogYW55ID0ge307CgogIC8vIGNoYW5nZSBzaG93Q2FsIHZhbHVlIGJhc2VkIG9uIHdpbmRvdyBzaXplIGFuZCByZXJlbmRlciBjYWxlbmRhcgogICQ6IGlmIChpbm5lcldpZHRoID4gNzY4KSB7CiAgICBzaG93Q2FsID0gdHJ1ZTsKICB9CiAgJDogaWYgKGlubmVyV2lkdGggPCA3NjgpIHsKICAgIHNob3dDYWwgPSBmYWxzZTsKICB9CgogIC8vIG9uIGlubmVyV2lkdGggY2hhbmdlLCBjaGFuZ2Ugb3B0aW9ucyBhbmQgcmVyZW5kZXIgY2FsZW5kYXIKICAkOiB7CiAgICBpbm5lcldpZHRoOwogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgIH07CiAgfQogICQ6IHsKICAgIHNob3dDYWw7CiAgICBvcHRpb25zID0gewogICAgICAuLi5vcHRpb25zLAogICAgfTsKICB9CgogIGxldCBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogIGxldCBzaG93RWRpdEZvcm0gPSBmYWxzZTsKICBsZXQgc2hvd0NhbCA9IGZhbHNlOwogIGxldCBzZWxlY3RlZER1cmF0aW9uOiBzdHJpbmcgPSAiIjsKICBsZXQgc2hvd1ZpZXdGcm9tID0gZmFsc2U7CgogIGxldCBzZWxlY3RlZFRyYWluZXI6IGFueSA9ICIiOwoKICBsZXQgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvYXJjaGl2ZWQtcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwoKICBsZXQgdXBkYXRlUmFwcG9ydHMgPSBhc3luYyAoKSA9PiB7CiAgICAvLyBnZXQgdGhlIGxpc3Qgb2YgcmFwcG9ydHMgZm9yIHRoZSBzZWxlY3RlZCB0cmFpbmVyCiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidHJhaW5lciIsIEpTT04uc3RyaW5naWZ5KHNlbGVjdGVkVHJhaW5lcikpOwoKICAgIGlmIChzZWxlY3RlZFRyYWluZXI/LnZhbHVlKSB7CiAgICAgIFVSTCA9IGAke3Byb2Nlc3MuZW52LlNWRUxURV9BUFBfUkVNT1RFX1VSTH0vYXBpL2FyY2hpdmVkLXJhcHBvcnRzP2ZpbHRlcj17ImluY2x1ZGUiOlsidHJhaW5lciIsInBsYXR6Iiwia3VuZGVzIiwiZ3J1cHBlIl0sIndoZXJlIjp7InRyYWluZXJJZCI6JHtzZWxlY3RlZFRyYWluZXIudmFsdWV9fX1gOwogICAgfSBlbHNlIHsKICAgICAgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvYXJjaGl2ZWQtcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwogICAgfQoKICAgIGxldCByYXBwb3J0cyA9IGF3YWl0IGZldGNoKFVSTCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJhcHBvcnRzLmpzb24oKTsKCiAgICBldmVudHMgPSBkYXRhLm1hcCgocjogYW55KSA9PiAoewogICAgICBzdGFydDogZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIiksCiAgICAgIGRpc3BsYXk6ICJiYWNrZ3JvdW5kIiwKICAgICAgYmFja2dyb3VuZENvbG9yOiAiI2ZhNzI1MiIsCiAgICB9KSk7CgogICAgLy8gdXBkYXRlIGNhbGVuZGFyIG9wdGlvbnMgdG8gcmVuZGVyIHRoZSB1cGRhdGVkIGV2ZW50cwogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgICAgZXZlbnRzOiBldmVudHMsCiAgICB9OwoKICAgIGlmIChzZWxlY3RlZERhdGUpIHsKICAgICAgc2VsZWN0ZWRSYXBwb3J0cyA9IGRhdGEuZmlsdGVyKChyOiBhbnkpID0+IHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIikgPT0KICAgICAgICAgIGRheWpzKHNlbGVjdGVkRGF0ZSkuZm9ybWF0KCJZWVlZLU1NLUREIikKICAgICAgICApOwogICAgICB9KTsKICAgICAgc2VsZWN0ZWRSYXBwb3J0cyA9IHNlbGVjdGVkUmFwcG9ydHM7CiAgICB9CiAgfTsKCiAgbGV0IGZldGNoUmFwcG9ydCA9IGFzeW5jICgpID0+IHsKICAgIC8vIHJlcXVlc3QgZm9yIHRoZSBsaXN0IG9mIHJhcG9ydHMgZm9yIHRoYXQgbW9udGggcG9wdWxhdGUgaXQgaW4gdGhlIGNhbGVuZGFyCiAgICBsZXQgc2F2ZWRUcmFpbmVyOiB7CiAgICAgIHZhbHVlOiBudW1iZXI7CiAgICAgIGxhYmVsOiBzdHJpbmc7CiAgICB9ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidHJhaW5lciIpIHx8ICJ7fSIpOwoKICAgIGlmIChzYXZlZFRyYWluZXI/LnZhbHVlKSB7CiAgICAgIFVSTCA9IGAke3Byb2Nlc3MuZW52LlNWRUxURV9BUFBfUkVNT1RFX1VSTH0vYXBpL2FyY2hpdmVkLXJhcHBvcnRzP2ZpbHRlcj17ImluY2x1ZGUiOlsidHJhaW5lciIsInBsYXR6Iiwia3VuZGVzIiwiZ3J1cHBlIl0sIndoZXJlIjp7InRyYWluZXJJZCI6JHtzYXZlZFRyYWluZXIudmFsdWV9fX1gOwogICAgfSBlbHNlIHsKICAgICAgVVJMID0gYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvYXJjaGl2ZWQtcmFwcG9ydHM/ZmlsdGVyPXsiaW5jbHVkZSI6WyJ0cmFpbmVyIiwicGxhdHoiLCJrdW5kZXMiLCJncnVwcGUiXX1gOwogICAgfQoKICAgIGxldCByYXBwb3J0cyA9IGF3YWl0IGZldGNoKFVSTCk7CiAgICBhd2FpdCB0aWNrKCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJhcHBvcnRzLmpzb24oKTsKCiAgICBldmVudHMgPSBkYXRhLm1hcCgocjogYW55KSA9PiAoewogICAgICBzdGFydDogZGF5anMoci5kYXR1bSkuZm9ybWF0KCJZWVlZLU1NLUREIiksCiAgICAgIGRpc3BsYXk6ICJiYWNrZ3JvdW5kIiwKICAgICAgYmFja2dyb3VuZENvbG9yOiAiI2ZhNzI1MiIsIC8vYWNjZW50IGNvbG9yIGZvciB0aGUgY2FsZW5kYXIKICAgIH0pKTsKCiAgICBzZWxlY3RlZFJhcHBvcnRzID0gZGF0YS5maWx0ZXIoKHI6IGFueSkgPT4gewogICAgICByZXR1cm4gKAogICAgICAgIGRheWpzKHIuZGF0dW0pLmZvcm1hdCgiWVlZWS1NTS1ERCIpID09CiAgICAgICAgZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKQogICAgICApOwogICAgfSk7CgogICAgb3B0aW9ucyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgICAgZXZlbnRzOiBldmVudHMsCiAgICAgIC8vICAgZXZlbnRDbGljazogYXN5bmMgZnVuY3Rpb24gKGluZm86IGFueSkgewogICAgICAvLyAgICAgc2VsZWN0ZWREYXRlID0gZGF5anMoaW5mby5ldmVudC5zdGFydCkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgIC8vICAgICBhd2FpdCB1cGRhdGVSYXBwb3J0cygpOwogICAgICAvLyAgICAgLy8gaGlkZSB0aGUgY2FsZW5kYXIKICAgICAgLy8gICAgIHNob3dDYWwgPSBmYWxzZTsKICAgICAgLy8gICB9LAogICAgICBkYXRlQ2xpY2s6IGZ1bmN0aW9uIChpbmZvOiBhbnkpIHsKICAgICAgICBzZWxlY3RlZERhdGUgPSBkYXlqcyhpbmZvLmRhdGVTdHIpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgIHNob3dDYWwgPSBmYWxzZTsKICAgICAgfSwKICAgICAgZGF5Q2VsbENsYXNzTmFtZXM6IChhcmc6IERheUNlbGxDb250ZW50QXJnKSA9PiB7CiAgICAgICAgaWYgKAogICAgICAgICAgZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKSA9PT0KICAgICAgICAgIGRheWpzKGFyZy5kYXRlKS5mb3JtYXQoIllZWVktTU0tREQiKQogICAgICAgICkgewogICAgICAgICAgcmV0dXJuIFsic2VsZWN0ZWQtZGF5LWNlbGwiXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9LAogICAgICBmaXJzdERheTogMSwKCiAgICAgIHdpbmRvd1Jlc2l6ZTogKGluZm86IHsgdmlldzogVmlld0FwaSB9KSA9PiB7CiAgICAgICAgaW5mby52aWV3LmNhbGVuZGFyLnVwZGF0ZVNpemUoKTsKICAgICAgfSwKICAgICAgaGFuZGxlV2luZG93UmVzaXplOiB0cnVlLAogICAgfTsKICB9OwogICQ6IHsKICAgIHNlbGVjdGVkRGF0ZTsKICAgIGZldGNoUmFwcG9ydCgpOwogIH0KICBvbk1vdW50KCgpID0+IHsKICAgIGZldGNoUmFwcG9ydCgpOwogICAgZmV0Y2hUcmFpbmVyRnJvbVRva2VuKCk7CiAgfSk7CgogIC8vIHJlLWV4ZWN1dGUgdGhlIGZldGNoUmFwcG9ydCBmdW5jdGlvbiBldmVyeSB0aW1lIHNob3dDcmVhdGVGb3JtIGFuZCBzaG93RWRpdEZvcm0gaXMgZmFsc2UKICAkOiB7CiAgICBpZiAoCiAgICAgIHNob3dDcmVhdGVGb3JtID09PSBmYWxzZSAmJgogICAgICBzaG93RWRpdEZvcm0gPT09IGZhbHNlICYmCiAgICAgIHNob3dDcmVhdGVGb3JtID09PSBmYWxzZQogICAgKSB7CiAgICAgIGZldGNoUmFwcG9ydCgpOwogICAgfQogIH0KCiAgbGV0IGNsb3NlQ29uZmlybWF0aW9uID0gZmFsc2U7CgogIGxldCB1bnNhdmVkQ2hhbmdlcyA9IGZhbHNlOwoKICBsZXQgZXNjRnVuY3Rpb24gPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHsKICAgIGlmIChldmVudC5rZXkgPT09ICJFc2NhcGUiKSB7CiAgICAgIGlmICh1bnNhdmVkQ2hhbmdlcykgewogICAgICAgIGNsb3NlQ29uZmlybWF0aW9uID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzaG93Q3JlYXRlRm9ybSA9IGZhbHNlOwogICAgICAgIHNob3dFZGl0Rm9ybSA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfTsKCiAgLy8gbGlzdGVuIGZvciBhbnkgaW5wdXQgY2hhbmdlcyBhbmQgc2V0IHRoZSB1bnNhdmVkQ2hhbmdlcyB0byB0cnVlIGlmIHRoZXJlIGFyZSBhbnkgY2hhbmdlcwogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsICgpID0+IHsKICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICB9KTsKCiAgLy8gbGlzdGVuIGZvciBhbnkgc2VsZWN0IG9wdGlvbnMgY2hhbmdlIGFuZCBzZXQgdGhlIHVuc2F2ZWRDaGFuZ2VzIHRvIHRydWUgaWYgdGhlcmUgYXJlIGFueSBjaGFuZ2VzCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsICgpID0+IHsKICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICB9KTsKCiAgJDogewogICAgY29uc3Qgc2VsZWN0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzZWxlY3QiKTsKCiAgICBmb3IgKGxldCBzZWxlY3Qgb2Ygc2VsZWN0cykgewogICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKCkgPT4gewogICAgICAgIHVuc2F2ZWRDaGFuZ2VzID0gdHJ1ZTsKICAgICAgfSk7CiAgICB9CiAgfQoKICAvLyBsaXN0ZW4gZm9yIGFueSBzdWJtaXQgY2hhbmdlcyBhbmQgc2V0IHRoZSB1bnNhdmVkQ2hhbmdlcyB0byBmYWxzZQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzdWJtaXQiLCAoKSA9PiB7CiAgICB1bnNhdmVkQ2hhbmdlcyA9IGZhbHNlOwogIH0pOwoKICAvLyBsaXN0ZW4gZm9yIGVzYyBrZXkgcHJlc3MgYW5kIGNsb3NlIHRoZSBjb25maXJtYXRpb24gbW9kYWwKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGVzY0Z1bmN0aW9uLCBmYWxzZSk7CgogIC8qKgogICAqIHNlbGVjdGVkIHRyYWluZXIgY29udGFpbnMgdmFsdWUgYW5kIGxhYmVsIG9mIHRoZSBzZWxlY3RlZCB0cmFpbmVyCiAgICogKiovCgogIC8vIGNoZWNrIGlmIHRoZSBjdXJyZW50IHVybCBpcyBpbiB0aGUgL2FkbWluIHBhdGggYW5kIGlmIGl0IGlzIHRoZW4gc2hvdyB0aGUgYWRtaW4gbWVudQogIC8vIFRPRE86IGFkZCBhIHByb3BlciBjaGVjayBmb3IgdGhlIGFkbWluIHVzZXIKICBsZXQgaXNBZG1pbiA9IGZhbHNlOwogICQ6IHsKICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoIi9hZG1pbiIpKSB7CiAgICAgIGlzQWRtaW4gPSB0cnVlOwogICAgfQogIH0KCiAgLy8gIGdldCB0aGUgY3VycmVudCB1cmwgc2VhcmNoIHF1ZXJ5IGFuZCBjaGVjayBmb3IgdHJhaW5lciBhbmQgdHJhaW5lck5hbWUgcXVlcnkgc3RyaW5ncwoKICBsZXQgdHJhaW5lcklkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7CiAgbGV0IHRyYWluZXJOYW1lOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7CiAgLy8gZ2V0IHRva2VuIGZyb20gbG9jYWwgc3RvcmFnZQogIC8vIGxldCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogIC8vIHRoZW4gZmV0Y2ggdHJhaW5lciBkYXRhIHdoZXJlIHRva2VuIGlzIGVxdWFsIHRvIHRoZSB0b2tlbiBpbiB0aGUgbG9jYWwgc3RvcmFnZQogIGNvbnN0IGZldGNoVHJhaW5lckZyb21Ub2tlbiA9IGFzeW5jICgpID0+IHsKICAgIGxldCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgbGV0IHRyYWluZXIgPSBhd2FpdCBmZXRjaCgKICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvdHJhaW5lcnM/ZmlsdGVyPXsid2hlcmUiOnsidG9rZW4iOiIke3Rva2VufSJ9fWAKICAgICk7CiAgICBhd2FpdCB0aWNrKCk7CgogICAgY29uc3QgZGF0YSA9IGF3YWl0IHRyYWluZXIuanNvbigpOwoKICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHsKICAgICAgdHJhaW5lcklkID0gZGF0YVswXS5pZDsKICAgICAgdHJhaW5lck5hbWUgPSBkYXRhWzBdLm5hbWU7CiAgICB9CiAgfTsKCiAgJDogewogICAgaWYgKHRyYWluZXJJZCAmJiB0cmFpbmVyTmFtZSkgewogICAgICBzZWxlY3RlZFRyYWluZXIgPSB7CiAgICAgICAgdmFsdWU6IHRyYWluZXJJZCwKICAgICAgICBsYWJlbDogdHJhaW5lck5hbWUsCiAgICAgIH07CiAgICAgIHVwZGF0ZVJhcHBvcnRzKCk7CiAgICB9CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGNoZWNrSWZUcmFpbmluZ0VkaXRhYmxlKAogICAgdHJhaW5pbmdEYXRlOiBEYXRlLAogICAgaXNBZG1pbjogYm9vbGVhbiwKICAgIGlzQXJjaGl2ZWQ/OiBib29sZWFuLAogICAgaW52b2ljZWRJbj86IGJvb2xlYW4KICApOiBQcm9taXNlPGJvb2xlYW4+IHsKICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKICAgIGNvbnN0IGRlYWRsaW5lID0gbmV3IERhdGUodHJhaW5pbmdEYXRlKTsKICAgIGRlYWRsaW5lLnNldERhdGUodHJhaW5pbmdEYXRlLmdldERhdGUoKSArIDEpOwogICAgZGVhZGxpbmUuc2V0SG91cnMoMTQsIDAsIDAsIDApOwoKICAgIGlmIChpc0FkbWluKSB7CiAgICAgIGlmIChpc0FyY2hpdmVkIHx8IGludm9pY2VkSW4pIHsKICAgICAgICAvKioKICAgICAgICAgKiBmZXRjaCB0aGUgZGF0YSBmcm9tIC9hcGkvaW52b2ljZS1nZW5lcmF0aW9uLWNvbmZpZ3MvMwogICAgICAgICAqIGNoZWNrIGlmIGRhdGEuY29uZmlnVmFsdWUgaXMgdHJ1ZSBvciBmYWxzZSBhbmQgcmV0dXJuIHRoZSB2YWx1ZQogICAgICAgICAqIHRoaXMgaXMgdG8gY2hlY2sgaWYgaGlzdG9yeSBpcyBlZGl0YWJsZSBmb3IgdGhlIGFkbWluCiAgICAgICAgICogbmV3IGhpc3Rvcnkgc2hvdWxkIG5vdCBiZSBlZGl0YWJsZQogICAgICAgICAqKi8KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKAogICAgICAgICAgYCR7cHJvY2Vzcy5lbnYuU1ZFTFRFX0FQUF9SRU1PVEVfVVJMfS9hcGkvaW52b2ljZS1nZW5lcmF0aW9uLWNvbmZpZ3MvM2AKICAgICAgICApOwogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CgogICAgICAgIHJldHVybiBkYXRhLmNvbmZpZ1ZhbHVlID09PSAidHJ1ZSIgPyBmYWxzZSA6IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBjdXJyZW50RGF0ZSA8IGRlYWRsaW5lOwogICAgfQogIH0KPC9zY3JpcHQ+Cgo8c3ZlbHRlOndpbmRvdyBiaW5kOmlubmVyV2lkdGggLz4KCjwhLS0geyNpZiBjbG9zZUNvbmZpcm1hdGlvbiAmJiAoc2hvd0NyZWF0ZUZvcm0gfHwgc2hvd0VkaXRGb3JtIHx8IHNob3dWaWV3RnJvbSl9CiAgPFNpbXBsZURpc21pc3NNb2RhbAogICAgb246Y2xvc2U9eygpID0+IChjbG9zZUNvbmZpcm1hdGlvbiA9IGZhbHNlKX0KICAgIG9uOnNlY29uZGFyeT17KCkgPT4gKGNsb3NlQ29uZmlybWF0aW9uID0gZmFsc2UpfQogICAgb246YWN0aXZlPXsoKSA9PiB7CiAgICAgIGNsb3NlQ29uZmlybWF0aW9uID0gZmFsc2U7CiAgICAgIHNob3dDcmVhdGVGb3JtID0gZmFsc2U7CiAgICAgIHNob3dFZGl0Rm9ybSA9IGZhbHNlOwogICAgICBzaG93Vmlld0Zyb20gPSBmYWxzZTsKICAgICAgdW5zYXZlZENoYW5nZXMgPSBmYWxzZTsKICAgIH19CiAgLz4Key9pZn0gLS0+CjwhLS0gCnsjaWYgc2hvd0VkaXRGb3JtIHx8IHNob3dWaWV3RnJvbX0KICA8ZGl2CiAgICBjbGFzcz0iZml4ZWQgdy1mdWxsIGgtc2NyZWVuIHotMTAgZmxleCBqdXN0aWZ5LWNlbnRlciBpdGVtcy1jZW50ZXIgaW5zZXQtMCBiZy1ncmF5LTUwMCBiZy1vcGFjaXR5LTc1IHRyYW5zaXRpb24tb3BhY2l0eSIKICA+CiAgICA8VXBkYXRlRXZlbnQKICAgICAge3NjaGVtYX0KICAgICAgaWQ9e3JhcHBvcnRUb1VwZGF0ZUlkfQogICAgICBvbjpkZWxldGVkPXsoKSA9PiB7CiAgICAgICAgc2hvd0VkaXRGb3JtID0gZmFsc2U7CiAgICAgIH19CiAgICAgIGNsb3NlUG9wdXA9eygpID0+IHsKICAgICAgICBpZiAodW5zYXZlZENoYW5nZXMpIHsKICAgICAgICAgIGNsb3NlQ29uZmlybWF0aW9uID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2hvd0VkaXRGb3JtID0gZmFsc2U7CiAgICAgICAgICBzaG93Vmlld0Zyb20gPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH19CiAgICAgIGlzVmlld09ubHk9e3Nob3dWaWV3RnJvbX0KICAgIC8+CiAgPC9kaXY+CnsvaWZ9IC0tPgoKPGRpdiBjbGFzcz0iZ3JpZCBncmlkLWNvbHMtMiBwLTQgYmctcHJpbWFyeS01MCI+CiAgPGRpdj4KICAgIDwhLS0gb24gbW9iaWxlIHZpZXcgaWYgdXNlciBpcyBub3QgYWRtaW4gYW5kIHRyYWluZXIgYW5kIHRyYWluZXJOYW1lIGFyZSBzZXQgaGlkZSB0aGUgdmlkZSAtLT4KICAgIHsjaWYgaXNBZG1pbn0KICAgICAgPFRyYWluZXJEcm9wRG93bgogICAgICAgIGJpbmQ6c2VsZWN0ZWRWYWx1ZT17c2VsZWN0ZWRUcmFpbmVyfQogICAgICAgIG9uOnVwZGF0ZVRyYWluZXI9e3VwZGF0ZVJhcHBvcnRzfQogICAgICAvPgogICAgey9pZn0KICA8L2Rpdj4KPC9kaXY+Cgo8ZGl2IGNsYXNzPSJtYXgtdy03eGwgbXgtYXV0byByZWxhdGl2ZSI+CiAgPGRpdiBjbGFzcz0iZ3JpZCBtZDpncmlkLWNvbHMtMiByZWxhdGl2ZSI+CiAgICB7I2lmICFzaG93Q2FsfQogICAgICA8ZGl2CiAgICAgICAgY2xhc3M9Im1kOmhpZGRlbiBweC00IG14LWF1dG8gbXQtNCB3LWZ1bGwgZmxleC1jb2wgZmxleCBmbGV4LXdyYXAgc3BhY2UteS00IgogICAgICA+CiAgICAgICAgPGJ1dHRvbgogICAgICAgICAgY2xhc3M9ImZjLXRvZGF5LWJ1dHRvbiB0ZXh0LXdoaXRlIHB4LTQgc2VsZi1jZW50ZXIgcHktMiByb3VuZGVkIgogICAgICAgICAgb246Y2xpY2s9eygpID0+IHsKICAgICAgICAgICAgLy8gc2V0IHNlbGVjdGVkRGF0ZSB0byB0b2RheQogICAgICAgICAgICBzZWxlY3RlZERhdGUgPSBkYXlqcygpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgICAgfX0+VG9kYXk8L2J1dHRvbgogICAgICAgID4KICAgICAgICA8ZGl2CiAgICAgICAgICBjbGFzcz0iZmxleC0xIGZsZXggZmxleC13cmFwIGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBzcGFjZS14LTIiCiAgICAgICAgPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5zdWJ0cmFjdCgyLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0iLTIgZGF5cyAiCiAgICAgICAgICA+CiAgICAgICAgICAgIDxzdmcKICAgICAgICAgICAgICB3aWR0aD0iMjAiCiAgICAgICAgICAgICAgaGVpZ2h0PSIyMCIKICAgICAgICAgICAgICBmaWxsPSJjdXJyZW50Q29sb3IiCiAgICAgICAgICAgICAgY2xhc3M9ImJpIGJpLWNoZXZyb24tZG91YmxlLWxlZnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik04LjM1NCAxLjY0NmEuNS41IDAgMCAxIDAgLjcwOEwyLjcwNyA4bDUuNjQ3IDUuNjQ2YS41LjUgMCAwIDEtLjcwOC43MDhsLTYtNmEuNS41IDAgMCAxIDAtLjcwOGw2LTZhLjUuNSAwIDAgMSAuNzA4IDB6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0xMi4zNTQgMS42NDZhLjUuNSAwIDAgMSAwIC43MDhMNi43MDcgOGw1LjY0NyA1LjY0NmEuNS41IDAgMCAxLS43MDguNzA4bC02LTZhLjUuNSAwIDAgMSAwLS43MDhsNi02YS41LjUgMCAwIDEgLjcwOCAweiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5zdWJ0cmFjdCgxLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0icHJldmlvdXMgZGF5IgogICAgICAgICAgPgogICAgICAgICAgICA8c3ZnCiAgICAgICAgICAgICAgd2lkdGg9IjIwIgogICAgICAgICAgICAgIGhlaWdodD0iMjAiCiAgICAgICAgICAgICAgZmlsbD0iY3VycmVudENvbG9yIgogICAgICAgICAgICAgIGNsYXNzPSJiaSBiaS1jaGV2cm9uLWxlZnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0xMS4zNTQgMS42NDZhLjUuNSAwIDAgMSAwIC43MDhMNS43MDcgOGw1LjY0NyA1LjY0NmEuNS41IDAgMCAxLS43MDguNzA4bC02LTZhLjUuNSAwIDAgMSAwLS43MDhsNi02YS41LjUgMCAwIDEgLjcwOCAweiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNob3dDYWwgPSAhc2hvd0NhbDsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQgcC00IGJvcmRlci0yIgogICAgICAgICAgPgogICAgICAgICAgICB7ZGF5anMoc2VsZWN0ZWREYXRlKS5mb3JtYXQoIkRELk1NLllZWVkiKX0KICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICBvbjpjbGljaz17KCkgPT4gewogICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IGRheWpzKHNlbGVjdGVkRGF0ZSkKICAgICAgICAgICAgICAgIC5hZGQoMSwgImRheSIpCiAgICAgICAgICAgICAgICAuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgICAgIH19CiAgICAgICAgICAgIGNsYXNzPSJyb3VuZGVkLWZ1bGwgYmctcHJpbWFyeS01MCBwLTMgdGV4dC1wcmltYXJ5LTUwMCIKICAgICAgICAgICAgdGl0bGU9Im5leHQgZGF5IgogICAgICAgICAgPgogICAgICAgICAgICA8c3ZnCiAgICAgICAgICAgICAgd2lkdGg9IjIwIgogICAgICAgICAgICAgIGhlaWdodD0iMjAiCiAgICAgICAgICAgICAgZmlsbD0iY3VycmVudENvbG9yIgogICAgICAgICAgICAgIGNsYXNzPSJiaSBiaS1jaGV2cm9uLXJpZ2h0IgogICAgICAgICAgICAgIHZpZXdCb3g9IjAgMCAxNiAxNiIKICAgICAgICAgICAgPgogICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgICAgICAgICAgICBkPSJNNC42NDYgMS42NDZhLjUuNSAwIDAgMSAuNzA4IDBsNiA2YS41LjUgMCAwIDEgMCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4LS43MDhMMTAuMjkzIDggNC42NDYgMi4zNTRhLjUuNSAwIDAgMSAwLS43MDh6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uCiAgICAgICAgICAgIG9uOmNsaWNrPXsoKSA9PiB7CiAgICAgICAgICAgICAgc2VsZWN0ZWREYXRlID0gZGF5anMoc2VsZWN0ZWREYXRlKQogICAgICAgICAgICAgICAgLmFkZCgyLCAiZGF5IikKICAgICAgICAgICAgICAgIC5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgY2xhc3M9InJvdW5kZWQtZnVsbCBiZy1wcmltYXJ5LTUwIHAtMyB0ZXh0LXByaW1hcnktNTAwIgogICAgICAgICAgICB0aXRsZT0iKzIgZGF5cyIKICAgICAgICAgID4KICAgICAgICAgICAgPHN2ZwogICAgICAgICAgICAgIHdpZHRoPSIyMCIKICAgICAgICAgICAgICBoZWlnaHQ9IjIwIgogICAgICAgICAgICAgIGZpbGw9ImJnLXByaW1hcnktNTAwIgogICAgICAgICAgICAgIGNsYXNzPSJmaWxsLWN1cnJlbnQiCiAgICAgICAgICAgICAgdmlld0JveD0iMCAwIDE2IDE2IgogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPHBhdGgKICAgICAgICAgICAgICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICAgICAgICAgICAgIGQ9Ik0zLjY0NiAxLjY0NmEuNS41IDAgMCAxIC43MDggMGw2IDZhLjUuNSAwIDAgMSAwIC43MDhsLTYgNmEuNS41IDAgMCAxLS43MDgtLjcwOEw5LjI5MyA4IDMuNjQ2IDIuMzU0YS41LjUgMCAwIDEgMC0uNzA4eiIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgICAgICAgICAgICBkPSJNNy42NDYgMS42NDZhLjUuNSAwIDAgMSAuNzA4IDBsNiA2YS41LjUgMCAwIDEgMCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4LS43MDhMMTMuMjkzIDggNy42NDYgMi4zNTRhLjUuNSAwIDAgMSAwLS43MDh6IgogICAgICAgICAgICAgIC8+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgey9pZn0KCiAgICA8ZGl2IGNsYXNzPSIge3Nob3dDYWwgPyAnYmxvY2snIDogJ2hpZGRlbid9IG1kOmJsb2NrIGgtW2NhbGMoMTAwdmgtNzRweCldIj4KICAgICAgPGRpdgogICAgICAgIGNsYXNzPSJhYnNvbHV0ZSB0b3AtMCByaWdodC0wIGxlZnQtMCBib3R0b20tMCBzbTp2aXNpYmxlIHNtOm10LTAgbWQ6cmVsYXRpdmUiCiAgICAgID4KICAgICAgICA8RnVsbENhbGVuZGFyCiAgICAgICAgICB7b3B0aW9uc30KICAgICAgICAgIGNsYXNzPSJwLTQgbWF4LXctc2NyZWVuLWxnIG1kOm14LWF1dG8gbWluLWgtZnVsbCIKICAgICAgICAvPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYKICAgICAgY2xhc3M9IntzZWxlY3RlZERhdGUgJiYgIXNob3dDYWwKICAgICAgICA/ICdibG9jaycKICAgICAgICA6ICdoaWRkZW4nfSBtZDpibG9jayBtZDpoLVtjYWxjKDEwMHZoLTIwMHB4KV0gaC1bY2FsYygxMDB2aC0xNTBweCldIgogICAgPgogICAgICA8U2luZ2xlRGF5CiAgICAgICAgYmluZDpyYXBvcnRzPXtzZWxlY3RlZFJhcHBvcnRzfQogICAgICAgIGJpbmQ6c2VsZWN0ZWREYXRlCiAgICAgICAgYmluZDpzZWxlY3RlZFRyYWluZXIKICAgICAgICBvbjpldmVudENsaWNrZWQ9e2FzeW5jIChpbmZvKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhpbmZvKTsKICAgICAgICAgIC8vICAgY29uc3QgY3VycmVudERhdGUgPQogICAgICAgICAgLy8gICAgIGluZm8uZGV0YWlsLmV2ZW50Ll9kZWYuZXh0ZW5kZWRQcm9wcy5yYXBwb3J0LmRhdHVtOwogICAgICAgICAgLy8gICBjb25zdCB0cmFpbmluZ0RhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZSk7CiAgICAgICAgICAvLyAgIGNvbnN0IGlzRWRpdGFibGUgPSBhd2FpdCBjaGVja0lmVHJhaW5pbmdFZGl0YWJsZSgKICAgICAgICAgIC8vICAgICB0cmFpbmluZ0RhdGUsCiAgICAgICAgICAvLyAgICAgaXNBZG1pbiwKICAgICAgICAgIC8vICAgICAhIWluZm8uZGV0YWlsLmV2ZW50Ll9kZWYuZXh0ZW5kZWRQcm9wcy5yYXBwb3J0LmFyY2hpdmVkLAogICAgICAgICAgLy8gICAgICEhaW5mby5kZXRhaWwuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLnJhcHBvcnQuaW52b2ljZWRJbgogICAgICAgICAgLy8gICApOwogICAgICAgICAgLy8gICBpZiAoaXNFZGl0YWJsZSkgewogICAgICAgICAgLy8gICAgIHNob3dFZGl0Rm9ybSA9IHRydWU7CiAgICAgICAgICAvLyAgIH0gZWxzZSB7CiAgICAgICAgICAvLyAgICAgc2hvd1ZpZXdGcm9tID0gdHJ1ZTsKICAgICAgICAgIC8vICAgfQogICAgICAgICAgLy8gICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAvLyAgIHJhcHBvcnRUb1VwZGF0ZUlkID0gaW5mby5kZXRhaWwuZXZlbnQuX2RlZi5leHRlbmRlZFByb3BzLnJhcHBvcnQuaWQ7CiAgICAgICAgfX0KICAgICAgICBvbjpkYXRlU2VsZWN0ZWQ9eyhpbmZvKSA9PiB7CiAgICAgICAgICBsZXQgdGltZURpZmYgPSBkYXlqcyhpbmZvLmRldGFpbC5lbmQpLmRpZmYoCiAgICAgICAgICAgIGRheWpzKGluZm8uZGV0YWlsLnN0YXJ0KSwKICAgICAgICAgICAgIm1pbnV0ZSIKICAgICAgICAgICk7CgogICAgICAgICAgLy8gc2VsZWN0ZWREdXJhdGlvbiBzaG91bGQgb25seSBiZSAzMCwgNjAsIDkwLCAxMjAgb25seSBhcHByb3hpbWF0ZSBpdAogICAgICAgICAgaWYgKHRpbWVEaWZmIDwgNzUpIHsKICAgICAgICAgICAgdGltZURpZmYgPSA2MDsKICAgICAgICAgIH0gZWxzZSBpZiAodGltZURpZmYgPCAxMDUpIHsKICAgICAgICAgICAgdGltZURpZmYgPSA5MDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRpbWVEaWZmID0gMTIwOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIGZvcm1hdCB0aW1lRGlmZiB0byBmb3JtYXQgJ2hoOm1tOnNzJwogICAgICAgICAgc2VsZWN0ZWREdXJhdGlvbiA9IGRheWpzKCkKICAgICAgICAgICAgLmhvdXIoMCkKICAgICAgICAgICAgLm1pbnV0ZSh0aW1lRGlmZikKICAgICAgICAgICAgLnNlY29uZCgwKQogICAgICAgICAgICAuZm9ybWF0KCJISDptbTpzcyIpOwogICAgICAgICAgLy8gQHRzLWlnbm9yZQoKICAgICAgICAgIHNob3dDcmVhdGVGb3JtID0gdHJ1ZTsKICAgICAgICAgIC8vIHRvZG8gYXV0byBmaWxsIHRoZSBzdGFydCBkYXRlIGFuZCBkdXJhdGlvbiBieSBjYWxjdWxhdGluZyB0aGUgZHVyYXRpb24gd2l0aCBzdGFydCBhbmQgZW5kIGRhdGUKICAgICAgICB9fQogICAgICAvPgogICAgPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPFRvYXN0c0NvbXBvbmVudCAvPgoKPHN0eWxlPgogIC8qIGRldGFpbHMgPiBzdW1tYXJ5IHsKICAgIGxpc3Qtc3R5bGU6IG5vbmU7CiAgfQogIGRldGFpbHMgPiBzdW1tYXJ5Ojotd2Via2l0LWRldGFpbHMtbWFya2VyIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgfQoKICBkZXRhaWxzW29wZW5dIHN1bW1hcnkgfiAqIHsKICAgIGFuaW1hdGlvbjogc3dlZXAgMC4yNXMgZWFzZS1pbi1vdXQ7CiAgfQoKICBAa2V5ZnJhbWVzIHN3ZWVwIHsKICAgIDAlIHsKICAgICAgb3BhY2l0eTogMDsKICAgICAgbWFyZ2luLXRvcDogLTEwcHg7CiAgICB9CiAgICAxMDAlIHsKICAgICAgb3BhY2l0eTogMTsKICAgICAgbWFyZ2luLXRvcDogMHB4OwogICAgfQogIH0gKi8KPC9zdHlsZT4K
replicaCount: 3
image:
  repository: grpl/jcscherrer-pr
  pullPolicy: Always
  # Overrides the image tag whose default is the chart appVersion.
  tag: "0.1.0.pr-9999-f0e8f7c"
imagetest:
  repository: apptest
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""
imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""
podAnnotations: {}
podSecurityContext: {}
# fsGroup: 2000

securityContext: {}
# capabilities:
#   drop:
#   - ALL
# readOnlyRootFilesystem: true
# runAsNonRoot: true
# runAsUser: 1000

service:
  type: ClusterIP
  port: 80
ingress:
  enabled: true
  ssl: true
  className: ""
  annotations: {}
  # kubernetes.io/ingress.class: nginx
  # kubernetes.io/tls-acme: "true"
  # hosts:
  #   - host: chart-example.local
  #     paths:
  #       - path: /
  #         pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local
resources: {}
# We usually recommend not to specify default resources and to leave this as a conscious
# choice for the user. This also increases chances charts run on environments with little
# resources, such as Minikube. If you do want to specify resources, uncomment the following
# lines, adjust them as necessary, and remove the curly braces after 'resources:'.
# limits:
#   cpu: 100m
#   memory: 128Mi
# requests:
#   cpu: 100m
#   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80
nodeSelector: {}
tolerations: []
affinity: {}
